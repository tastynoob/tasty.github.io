{"meta":{"title":"tastynoob's blog","subtitle":"","description":"","author":"tastynoob","url":"https://tastynoob.github.io","root":"/"},"pages":[{"title":"PY","date":"2023-04-28T16:56:59.772Z","updated":"2023-04-28T16:56:51.118Z","comments":true,"path":"PY.html","permalink":"https://tastynoob.github.io/PY.html","excerpt":"","text":"è¿™é‡Œå°±æ²¡å•¥å¥½ä»‹ç»çš„äº†å°±æ¥æ¨èä¸€ä¸‹æˆ‘ä¸€ç›´ä»¥æ¥çš„è‡ªå­¦ç½‘ç«™å§ğŸ˜˜ èœé¸Ÿæ•™ç¨‹"},{"title":"å…³äºåšå®¢","date":"2023-04-28T16:56:59.766Z","updated":"2023-04-28T16:56:51.176Z","comments":true,"path":"about.html","permalink":"https://tastynoob.github.io/about.html","excerpt":"","text":"æ²¡å•¥å¥½ä»‹ç»çš„ä¸€æ™®é€šå¤§å­¦ç”Ÿé—²æ¥æ— äº‹æå¾—ç©çš„ åšå®¢ä½¿ç”¨github+hexoæ–¹å¼æ­å»º ä¸»é¢˜é‡‡ç”¨nexmoe"},{"title":"æ–‡ç« å½’æ¡£","date":"2023-04-28T16:56:59.767Z","updated":"2023-04-28T16:56:51.177Z","comments":true,"path":"archive.html","permalink":"https://tastynoob.github.io/archive.html","excerpt":"","text":""},{"title":"æ–‡ç« å½’æ¡£","date":"2023-04-28T16:56:59.768Z","updated":"2023-04-28T16:56:51.177Z","comments":true,"path":"archives.html","permalink":"https://tastynoob.github.io/archives.html","excerpt":"","text":""},{"title":"","date":"2023-04-28T16:56:59.771Z","updated":"2023-04-28T16:56:51.215Z","comments":true,"path":"myself.html","permalink":"https://tastynoob.github.io/myself.html","excerpt":"","text":"ä¸‰å³¡å¤§å­¦æŸèœé¸¡ä¸€ä½ è¯¥åšå®¢ä¸»è¦è®°å½•FPGAçš„å­¦ä¹ å’Œä¸€äº›æ‚ä¸ƒæ‚å…«çš„ä¸œè¥¿ ä¸å®šæœŸæ›´æ–°"}],"posts":[{"title":"å¯æ˜æ˜Ÿæ™ºèƒ½ç»„æš‘æœŸåŸ¹è®­-toysoc-riscvå¤„ç†å™¨å®ç°","slug":"RISCV/toysoc","date":"2022-08-13T16:00:00.000Z","updated":"2023-04-29T02:52:11.258Z","comments":true,"path":"2022/08/14/RISCV/toysoc/","link":"","permalink":"https://tastynoob.github.io/2022/08/14/RISCV/toysoc/","excerpt":"ä¸€ä¸ªç®€å•çš„æ•™å­¦ç”¨riscvå¤„ç†å™¨","text":"ä¸€ä¸ªç®€å•çš„æ•™å­¦ç”¨riscvå¤„ç†å™¨ ä»“åº“åœ°å€click mecoremarkè·‘åˆ†ä»¿çœŸå·¥ä½œé¢‘ç‡1Mhz,å¹³å‡0.258Coremark&#x2F;Mhz","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"ä½¿ç”¨FPGAè®¾è®¡çš„å…¥é—¨çº§åŸºäºriscvæŒ‡ä»¤é›†çš„soc","slug":"RISCV/ritter-soc","date":"2022-03-07T16:00:00.000Z","updated":"2023-04-29T02:53:10.221Z","comments":true,"path":"2022/03/08/RISCV/ritter-soc/","link":"","permalink":"https://tastynoob.github.io/2022/03/08/RISCV/ritter-soc/","excerpt":"ritter-socæ˜¯æˆ‘å¤§äºŒæ—¶æœŸåœ¨å®‰è·¯EG4så¹³å°ä¸Šè®¾è®¡çš„ä¸€æ¬¾åŸºäºrv32imæŒ‡ä»¤é›†çš„socå¯è¿è¡ŒåŸºæœ¬çš„ç¨‹åºï¼Œå’Œcoremarkè·‘åˆ†","text":"ritter-socæ˜¯æˆ‘å¤§äºŒæ—¶æœŸåœ¨å®‰è·¯EG4så¹³å°ä¸Šè®¾è®¡çš„ä¸€æ¬¾åŸºäºrv32imæŒ‡ä»¤é›†çš„socå¯è¿è¡ŒåŸºæœ¬çš„ç¨‹åºï¼Œå’Œcoremarkè·‘åˆ† ritter-socè¯´æ˜ä»‹ç»ritter-socä¿¡æ¯ritter-socæ˜¯æˆ‘ä»å¤§ä¸€æ—¶æœŸåˆ°å¤§äºŒæ—¶æœŸèŠ±äº†åŠå¹´æ—¶é—´è‡ªç ”å‡ºæ¥çš„åŸºäºriscvæŒ‡ä»¤é›†çš„å¤„ç†å™¨é‡Œé¢åŒ…æ‹¬ritter-coreä»¥åŠæ€»çº¿å’Œå¤–è®¾æ‰€æœ‰è®¾è®¡å‡é‡‡ç”¨verilogè®¾è®¡è¯¥é¡¹ç›®ä½¿ç”¨sipeedå…¬å¸çš„tang premier FPGAå¼€å‘æ¿ä¸Šå¼€å‘ç›®å‰ritter-socæ”¯æŒå®Œæ•´çš„riscv32IMæŒ‡ä»¤é›†å¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ äº†ç®€æ˜“çš„æµ®ç‚¹åŠ é€Ÿå•å…ƒ(FPU)èƒ½å¤Ÿè¿è¡Œå®Œæ•´å¤æ‚çš„ç¨‹åº ritter-socæ¶æ„å›¾ (ä»…ä½œå‚è€ƒ) ritter-socå·¥ä½œçŠ¶æ€å·¥ä½œé¢‘ç‡:84MHZå¤–è®¾:ä¸€ä¸ªä¸²å£,ä¸€ä¸ªè®¡æ•°å™¨ (ä»¥åä¼šæ…¢æ…¢æ›´æ–°)coremarkè·‘åˆ†: ä½¿ç”¨è¯´æ˜ä½¿ç”¨å®‰è·¯(anlogic)å…¬å¸æä¾›çš„FPGAå¼€å‘è½¯ä»¶(TDï¼Œå¯åœ¨sipeedå…¬å¸wikiä¸­å¯»æ‰¾)æ‰“å¼€projectæ–‡ä»¶å¤¹ä¸‹çš„work-ritter_soc1.0.alæ–‡ä»¶(TDå·¥ç¨‹æ–‡ä»¶)å³å¯æ‰“å¼€ritter-socçš„å·¥ç¨‹é¡¹ç›® çƒ§å½•ç¨‹åºè¯¦ç»†è¯·è§isaç›®å½•ä¸‹çš„è¯´æ˜ æ³¨æ„äº‹é¡¹ç¼–è¯‘é¡¹ç›®ä¹‹å‰è®°å¾—æ›´æ”¹å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶1.project&#x2F;al_ip&#x2F;bram_itcm.v:æ›´æ”¹bramå¡«å……æ–‡ä»¶åœ°å€â€INIT_FILEâ€2.æŸ¥çœ‹defines.vå’Œconfig.vï¼Œæ ¹æ®éœ€è¦ä¿®æ”¹å®å®šä¹‰3.åœ¨è¿›è¡Œä»¿çœŸæ—¶,æ³¨æ„éœ€è¦å¯¼å…¥å®‰è·¯çš„ç¡¬ä»¶ä»¿çœŸåº“(ä½äºTDè½¯ä»¶å®‰è£…ç›®å½•ä¸‹çš„sim_release) æ›´æ–°æ—¥å¿—22&#x2F;5&#x2F;31:å·¥ä½œæ—¶é’Ÿé¢‘ç‡è°ƒæ•´ä¸º80Mhz,æ·»åŠ é¢å¤–çš„ä¸²å£å’Œgpioå¤–è®¾,è¿˜æœ‰PWMè¾“å‡º,æ·»åŠ bootloaderå›ºä»¶ï¼Œå¯å®ç°ä¸²å£çƒ§å½•ç¨‹åº,è¯¦ç»†è§isa&#x2F;æ–‡ä»¶å¤¹ä¸‹22&#x2F;3&#x2F;3: ä¼˜åŒ–äº†æŒ‡ä»¤æ‰§è¡Œæ—¶åº,ç‰ˆæœ¬æ”¹ä¸ºv1.322&#x2F;2&#x2F;25:ritter-soc 1.0å‘å¸ƒ21&#x2F;7&#x2F;24:ritter-core 0.1å‘å¸ƒ(ä¸æ¨èä½¿ç”¨)","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"ç®€å•è®²è§£åå‘ä¼ æ’­ç®—æ³•","slug":"ç®—æ³•/ç®€å•è®²è§£åå‘ä¼ æ’­ç®—æ³•","date":"2020-04-27T04:52:00.000Z","updated":"2023-04-28T16:56:51.174Z","comments":true,"path":"2020/04/27/ç®—æ³•/ç®€å•è®²è§£åå‘ä¼ æ’­ç®—æ³•/","link":"","permalink":"https://tastynoob.github.io/2020/04/27/%E7%AE%97%E6%B3%95/%E7%AE%80%E5%8D%95%E8%AE%B2%E8%A7%A3%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/","excerpt":"ç®€å•è®²è§£åå‘ä¼ æ’­ç®—æ³•","text":"ç®€å•è®²è§£åå‘ä¼ æ’­ç®—æ³• åå‘ä¼ æ’­ç®—æ³•åœ¨ç¥ç»ç½‘ç»œä¸­ç«™å¾ˆå¤§çš„åœ°ä½,å¤§å¤šæ•°ç¥ç»ç½‘ç»œéƒ½èƒ½ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œè®­ç»ƒ, ä½†ä¸å°‘åˆå­¦è€…ä¸å®¹æ˜“å¼„æ‡‚å…¶ä¸­çš„å…·ä½“å…¬å¼(æ¯”å¦‚è¯´æˆ‘),æ‰€ä»¥è®²è§£å…¬å¼å¾ˆæœ‰å¿…è¦ (è¿™é‡Œä¸è®²å‰å‘ä¼ æ’­,å¯è‡ªè¡Œå¯»æ‰¾ç›¸å…³ä¿¡æ¯) é¦–å…ˆå…ˆè§„å®šä¸€äº›å®: 12345678910111213LS:ç¥ç»ç½‘ç»œçš„å±‚æ•°NF(n):ç¥ç»ç½‘ç»œç¬¬nå±‚çš„ç¥ç»å…ƒä¸ªæ•°BF(n,a):ç¥ç»ç½‘ç»œç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„åç½®(è¾“å…¥å±‚æ²¡æœ‰åç½®)WF(n,a,p):ç¥ç»ç½‘ç»œç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„ç¬¬pä¸ªæƒé‡(è¾“å…¥å±‚æ²¡æœ‰æƒé‡)NETF(n,a):ç¥ç»ç½‘ç»œç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„åŠ æƒå’Œ(wx+b)OF(n,a):ç¥ç»ç½‘ç»œçš„ç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„è¾“å‡º(ä¸åŒ…æ‹¬è¾“å…¥å±‚,OFå¯æœ‰å¯æ— ,æœ‰ç‚¹è¯ä½¿ç”¨æŸäº›æ¿€æ´»å‡½æ•°å¯æ–¹ä¾¿è®¡ç®—)SF(n,a):ç¥ç»ç½‘ç»œçš„ç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„è¯¯å·®INF(n):ç¥ç»ç½‘ç»œçš„ç¬¬nä¸ªè¾“å…¥OUTF(n):ç¥ç»ç½‘ç»œçš„ç¬¬nä¸ªå®é™…è¾“å‡º(å³è¾“å‡ºå±‚ç¬¬nä¸ªè¾“å‡º)TAF(n):ç¥ç»ç½‘ç»œçš„ç¬¬nä¸ªç†æƒ³è¾“å‡º(å³æ ·æœ¬è¾“å‡º)LN:å­¦ä¹ ç‡F(x):æ¿€æ´»å‡½æ•°å‡½æ•°F_(x):æ¿€æ´»å‡½æ•°çš„å¯¼å‡½æ•° æ³¨æ„: åœ¨è¿›è¡Œåå‘ä¼ æ’­ä¹‹å‰,é¦–å…ˆéœ€è¦å…ˆå‰å‘ä¼ æ’­ä¸€æ¬¡,è®¡ç®—å¥½å„ä¸ªå±‚çš„(åŠ æƒå’Œ)å’Œè¾“å‡º é¦–å…ˆæ˜¯è®¡ç®—è¾“å…¥å±‚çš„è¯¯å·®(ä¸ºäº†æ›´åŠ å®¹æ˜“ç†è§£,è¿™é‡Œç”¨æ–‡å­—å’Œç¬¦å·è¡¨è¿°): 123SF(LS,1) = (2.0/NF(LS))*(OUTF(1) - TAF(1))è¾“å‡ºå±‚ç¬¬1ä¸ªç¥ç»å…ƒçš„è¯¯å·® = (2.0/è¾“å‡ºå±‚ç¥ç»å…ƒæ•°é‡)*(å®é™…ç¬¬1ä¸ªè¾“å‡º-ç†æƒ³ç¬¬1ä¸ªè¾“å‡º),ä»¥æ­¤ç±»æ¨ps:æ³¨æ„è¿™é‡Œæ˜¯æµ®ç‚¹æ•°2.0ä¸æ˜¯æ•´æ•°2 æ›´æ–°è¾“å…¥å±‚çš„æƒé‡å’Œåç½®: 12345678910BF(LS,1) = BF(LS,1) - LN * SF(LS,1)æ›´æ–°åçš„è¾“å‡ºå±‚ç¬¬1ä¸ªåç½® = åŸåç½® - å­¦ä¹ ç‡*è¾“å‡ºå±‚ç¬¬1ä¸ªè¯¯å·®,ä»¥æ­¤ç±»æ¨WF(LS,1,2) = WF(LS,1,2) - LN * SF(LS,1) * OF(LS-1,2);æ›´æ–°åçš„è¾“å‡ºå±‚ç¬¬1ä¸ªç¥ç»å…ƒçš„ç¬¬2ä¸ªæƒé‡ = åŸæƒé‡ - å­¦ä¹ ç‡ * è¾“å‡ºå±‚ç¬¬1ä¸ªè¯¯å·® * ä¸Šä¸€å±‚ç¬¬2ä¸ªè¾“å‡ºä½œä¸ºå‚ç…§:WF(n,1,4) = WF(n,1,4) - LN * SF(n+1,4) * OF(n,4);æ›´æ–°åçš„ç¬¬nå±‚ç¬¬1ä¸ªç¥ç»å…ƒçš„ç¬¬4ä¸ªæƒé‡ = åŸæƒé‡ - å­¦ä¹ ç‡ * ä¸‹ä¸€å±‚å±‚ç¬¬4ä¸ªè¯¯å·® * ç¬¬nå±‚ç¬¬1ä¸ªè¾“å‡ºä»¥æ­¤ç±»æ¨ ç„¶åæ˜¯éšè—å±‚çš„è¯¯å·®: 12345678910SF(n,4) = SF(n+1,1)*WF(n,4,1)*F_(NETF(n,4)) + SF(n+1,2)*WF(n,4,2)*F_(NETF(n,4)) +SF(n+1,3)*WF(n,4,3)*F_(NETF(n,4)) +...........ç¬¬nå±‚ç¬¬4ä¸ªç¥ç»å…ƒçš„è¯¯å·® = ä¸‹ä¸€å±‚ç¬¬1ä¸ªç¥ç»å…ƒçš„è¯¯å·® * ç¬¬nå±‚ç¬¬4ä¸ªç¥ç»å…ƒç¬¬1ä¸ªæƒé‡ * ç¬¬nå±‚çš„ç¬¬4ä¸ªç¥ç»å…ƒçš„å¯¼å‡½æ•°è¾“å‡º +ä¸‹ä¸€å±‚ç¬¬2ä¸ªç¥ç»å…ƒçš„è¯¯å·® * ç¬¬nå±‚ç¬¬4ä¸ªç¥ç»å…ƒç¬¬2ä¸ªæƒé‡ * ç¬¬nå±‚çš„ç¬¬4ä¸ªç¥ç»å…ƒçš„å¯¼å‡½æ•°è¾“å‡º +ä¸‹ä¸€å±‚ç¬¬3ä¸ªç¥ç»å…ƒçš„è¯¯å·® * ç¬¬nå±‚ç¬¬4ä¸ªç¥ç»å…ƒç¬¬3ä¸ªæƒé‡ * ç¬¬nå±‚çš„ç¬¬4ä¸ªç¥ç»å…ƒçš„å¯¼å‡½æ•°è¾“å‡º+........ps:è¿™é‡Œä¹‹æ‰€ä»¥ç”¨è®¡ç®—ç¬¬nå±‚ç¬¬4ä¸ªç¥ç»å…ƒçš„è¯¯å·®åšä¾‹,æ˜¯ä¸ºäº†æ›´å¥½çš„ç†è§£å®é™…ä¸Šå°±æ˜¯ä¸ªæ•°å­¦è¡¨è¾¾å¼:ç¬¬nå±‚çš„è¯¯å·®æ•°ç»„ = (ä¸‹ä¸€å±‚çš„è¯¯å·®æ•°ç»„*ç¬¬nå±‚çš„æƒé‡çŸ©é˜µ)*ç¬¬nå±‚çš„åŠ æƒå’Œçš„å¯¼æ•°æ•°ç»„ éšè—å±‚çš„è¯¯å·®è®¡ç®— , æƒé‡å’Œåç½®çš„æ›´æ–°ä¸è¾“å‡ºå±‚ä¸€æ ·,è¿™é‡Œå°±ä¸åŠ èµ˜è¿°äº† ç”±äºè¾“å…¥å±‚åªæœ‰è¾“å…¥,æ‰€ä»¥æ²¡æœ‰è¯¯å·® æ€»ä¹‹,ç¥ç»ç½‘ç»œæ­å»ºå®Œå,å°±å¯ä»¥å¼€å§‹è®­ç»ƒäº†,å¯¼å…¥æ ·æœ¬,ç„¶åå¼€å§‹å‰å‘ä¼ æ’­ä¸€æ¬¡,åå‘ä¼ æ’­ä¸€æ¬¡,åå¤è®¡ç®— å…¶ä¸­éœ€è¦è®¡ç®—æ€»è¯¯å·®: 1234double val = 0;for (int a = 1; a &lt;= NF(LS); a++) &#123; val += ((OF(LS, a) - TAF(a)) * (OF(LS, a) - TAF(a))) / NF(LS); &#125; è‡³æ­¤,åå‘ä¼ æ’­çš„å¤§è‡´å…¬å¼å°±å®Œäº†,å…·ä½“æ•°å­¦åŸç†å¯è‡ªè¡ŒæŸ¥è¯¢(èµ„æ–™æŒºå¤šçš„,åº”è¯¥ä¸ç”¨æ‹…å¿ƒ)","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"ç”¨çº¯cè¯­è¨€å†™ä¸€ä¸ªå®Œæ•´çš„BPç¥ç»ç½‘ç»œ","slug":"ç®—æ³•/ç”¨çº¯cè¯­è¨€å†™ä¸€ä¸ªå®Œæ•´çš„BPç¥ç»ç½‘ç»œ","date":"2020-04-22T10:13:00.000Z","updated":"2023-04-28T16:56:51.174Z","comments":true,"path":"2020/04/22/ç®—æ³•/ç”¨çº¯cè¯­è¨€å†™ä¸€ä¸ªå®Œæ•´çš„BPç¥ç»ç½‘ç»œ/","link":"","permalink":"https://tastynoob.github.io/2020/04/22/%E7%AE%97%E6%B3%95/%E7%94%A8%E7%BA%AFc%E8%AF%AD%E8%A8%80%E5%86%99%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%95%B4%E7%9A%84BP%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/","excerpt":"ç”¨çº¯cè¯­è¨€å†™ä¸€ä¸ªå®Œæ•´çš„BPç¥ç»ç½‘ç»œ","text":"ç”¨çº¯cè¯­è¨€å†™ä¸€ä¸ªå®Œæ•´çš„BPç¥ç»ç½‘ç»œ è¯ä¸å¤šè¯´,ç›´æ¥ä¸Šä»£ç  æ‰€æœ‰çš„è¯´æ˜å‡åœ¨ä»£ç ä¸­ é¦–å…ˆæ˜¯å¤´æ–‡ä»¶BPNetWork.h 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#ifndef BPNETWORK_H#define BPNETWORK_H//æ‰€éœ€å¤´æ–‡ä»¶#include&lt;math.h&gt;#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;#define f(x) Sigmoid(x)//æ¿€æ´»å‡½æ•°è®¾å®š#define f_(x) Sigmoidf(x)//å¯¼å‡½æ•°typedef struct &#123; double* ws;//æƒé‡çŸ©é˜µ double* bs;//åç½®æ•°ç»„ double* os;//è¾“å‡ºæ•°ç»„ double* ss;//è¯¯å·®(æ€»è¯¯å·®å…³äºåŠ æƒå’Œçš„åå¯¼)&#125; Layer;typedef struct &#123; int lns;//å±‚æ•° int* ns;//æ¯å±‚ç¥ç»å…ƒçš„æ•°é‡ double* is;//ç¥ç»ç½‘ç»œè¾“å…¥ double* ts;//ç†æƒ³è¾“å‡º Layer* las;//ç¥ç»ç½‘ç»œå„ä¸ªå±‚(ä¸åŒ…æ‹¬è¾“å…¥å±‚) double ln;//å­¦ä¹ ç‡&#125;BPNetWork;//åˆ›å»ºç¥ç»ç½‘ç»œBPNetWork* BPCreate(int* nums, int len,double ln);//è¿è¡Œä¸€æ¬¡ç¥ç»ç½‘ç»œvoid RunOnce(BPNetWork* network);//è½½å…¥è®­ç»ƒé›†void LoadIn(BPNetWork* network, double* input, double* putout);//åå‘ä¼ æ’­ä¸€æ¬¡(è®­ç»ƒä¸€æ¬¡)void TrainOnce(BPNetWork* network);//è¾“å‡ºæ€»è¯¯å·®double ETotal(BPNetWork* network);//sigmoidæ¿€æ´»å‡½æ•°#define Sigmoid(x) (1 / (1 + exp(-(x))))//sigmoidæ¿€æ´»å‡½æ•°çš„å¯¼å‡½æ•°,è¾“å…¥ä¸ºsigmoidè¾“å‡º#define Sigmoidf(f) ((f) * (1 - (f)))#define Tanh(x) ((2 / (1 + exp(-2 * (x))))-1)#define Tanhf(f) ((1+(f))*(1-(f)))#endif ç„¶åæ˜¯ç¨‹åºæœ¬ä½“BPNetWork.c å®å®šä¹‰ 123456789101112131415161718192021222324252627282930313233343536#include&quot;BPNetWork.h&quot;//ç¥ç»ç½‘ç»œçš„å±‚æ•°#define LS network-&gt;lns//è¾“å…¥å±‚ç¥ç»å…ƒçš„æ•°é‡#define INNS network-&gt;ns[0]//è¾“å…¥å±‚çš„ç¬¬aä¸ªè¾“å…¥#define INS(a) network-&gt;is[a-1]//ç¬¬aä¸ªç†æƒ³è¾“å‡º#define TAS(a) network-&gt;ts[a-1]//è¾“å‡ºå±‚ç¥ç»å…ƒçš„æ•°é‡#define OUTNS network-&gt;ns[LS-1]//ç¬¬nå±‚ç¥ç»å…ƒçš„æ•°é‡#define NS(n) network-&gt;ns[n-1]//ç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„ç¬¬pä¸ªæƒé‡#define WF(n,a,p) network-&gt;las[n-2].ws[(p-1)+(a-1)*NS(n-1)]//ç¬¬nå±‚çš„ç¬¬aä¸ªç¥ç»å…ƒçš„åç½®#define BF(n,a) network-&gt;las[n-2].bs[a-1]//ç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„è¾“å‡º#define OF(n,a) network-&gt;las[n-2].os[a-1]//ç¬¬nå±‚ç¬¬aä¸ªç¥ç»å…ƒçš„è¯¯å·®#define SF(n,a) network-&gt;las[n-2].ss[a-1]//å­¦ä¹ ç‡#define LN network-&gt;ln BPCreateå‡½æ•°: 123456789101112131415161718192021222324252627282930313233BPNetWork* BPCreate(int* nums, int len,double ln)&#123; BPNetWork* network = malloc(sizeof(BPNetWork)); network-&gt;lns = len; network-&gt;ns = malloc(len * sizeof(int)); network-&gt;ln = ln; memcpy(network-&gt;ns, nums, len * sizeof(int)); // network-&gt;is = malloc(nums[0] * sizeof(double)); network-&gt;las = malloc(sizeof(Layer) * (len - 1)); network-&gt;ts = malloc(sizeof(double) * nums[len - 1]); srand(&amp;network);//ç”¨networkdçš„å†…å­˜åœ°å€åšä¸ºéšæœºæ•°ç§å­ for (int p = 0; p &lt; len - 1; p++) &#123; int lastnum = nums[p];//ä¸Šä¸€å±‚çš„ç¥ç»å…ƒæ•°é‡ int num = nums[p + 1];//å½“å‰å±‚çš„ç¥ç»å…ƒæ•°é‡ network-&gt;las[p].bs = malloc(sizeof(double) * num); // network-&gt;las[p].ws = malloc(sizeof(double) * num * lastnum); // network-&gt;las[p].os = malloc(sizeof(double) * num); // network-&gt;las[p].ss = malloc(sizeof(double) * num); for (int pp = 0; pp &lt; num; pp++) &#123; //è¿™é‡Œrand()/2.0çš„æ„æ€æ˜¯æŠŠæ•´æ•°é™¤æ•´æ•°è½¬æ¢ä¸ºæµ®ç‚¹æ•°é™¤æ•´æ•° //å¦‚æœæ˜¯æ•´æ•°é™¤æ•´æ•°,è¾“å‡ºåˆ™ä¸ºå¸¦ä½™çš„å•† network-&gt;las[p].bs[pp] = rand() / 2.0 / RAND_MAX; for (int ppp = 0; ppp &lt; lastnum; ppp++) &#123; network-&gt;las[p].ws[ppp + pp * lastnum] = rand() / 2.0 / RAND_MAX; &#125; &#125; &#125; return network;&#125; RunOnceå‡½æ•°: 123456789101112131415161718192021void RunOnce(BPNetWork* network) &#123; //è®¡ç®—è¾“å…¥å±‚åˆ°ç¬¬äºŒå±‚ for (int a = 1; a &lt;= NS(2); a++) &#123; double net = 0; double* o = &amp;OF(2,a);//è·å–ç¬¬2å±‚çš„è¾“å‡ºå€¼for (int aa = 1; aa &lt;= INNS; aa++) &#123; net += INS(aa) * WF(2, a, aa);//INS(aa) * WF(2, a, aa); &#125; *o = f(net + BF(2,a)); &#125; for (int n = 2; n &lt;= LS-1; n++) &#123; for (int a = 1; a &lt;= NS(n + 1); a++) &#123;//ä¸‹ä¸€å±‚çš„ç¥ç»ç½‘ç»œ double net = 0; double* o = &amp;OF(n+1,a);for (int aa = 1; aa &lt;= NS(n); aa++) &#123;//å½“å‰å±‚çš„ç¥ç»ç½‘ç»œ double oo = OF(n, aa); double* ww = &amp;WF(n + 1, a, aa); net += oo * (*ww); &#125; *o = f(net + BF(n + 1, a)); &#125; &#125;&#125; TrainOnceå‡½æ•°: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657void TrainOnce(BPNetWork* network) &#123; //è®¡ç®—è¾“å‡ºå±‚çš„è¯¯å·®å‡½æ•° for (int a = 1; a &lt;= OUTNS; a++) &#123; double* s = &amp;SF(LS,a);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¯¯å·®double* b = &amp;BF(LS, a);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„åç½® double o = OF(LS, a);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¾“å‡º *s = (2.0 / OUTNS) * (o - TAS(a))* f_(o); *b = *b - LN * (*s);//æ›´æ–°åç½® //æ›´æ–°æƒé‡ for (int aa = 1; aa &lt;=NS(LS-1) ; aa++) &#123; double* w = &amp;WF(LS, a, aa); *w = *w - LN * (*s) * OF(LS-1, aa); &#125; &#125; //è®¡ç®—éšè—å±‚çš„è¯¯å·® for (int a = LS-1; a &gt; 2; a--) &#123; //å¼€å§‹è®¡ç®—ç¬¬aå±‚æ¯ä¸ªç¥ç»å…ƒçš„è¯¯å·® for (int n = 1; n &lt;= NS(a); n++) &#123;//å½“å‰å±‚ double* s = &amp;SF(a, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¯¯å·® *s = 0; double* b = &amp;BF(a, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„åç½® double o = OF(a, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¾“å‡º for (int nn = 1; nn &lt;= NS(a+1); nn++) &#123;//ä¸‹ä¸€å±‚ double lw = WF(a + 1, nn, n);//è·å–ä¸‹ä¸€å±‚åˆ°å½“å‰ç¥ç»å…ƒçš„åç½® double ls = SF(a + 1, nn);//è·å–ä¸‹ä¸€å±‚ç¬¬nnä¸ªç¥ç»å…ƒçš„è¯¯å·® *s += ls * lw * f_(o); &#125; *b = *b - LN * (*s);//æ›´æ–°åç½® //æ›´æ–°æƒé‡ for (int nn = 1; nn &lt;= NS(a - 1); nn++) &#123;//ä¸Šä¸€å±‚ double* w = &amp;WF(a, n, nn); *w = *w - LN * (*s) *OF(a - 1, nn); &#125; &#125; &#125; //è®¡ç®—ç¬¬2å±‚çš„è¯¯å·®å‡½æ•° for (int n = 1; n &lt;= NS(2); n++) &#123;//å½“å‰å±‚ double* s = &amp;SF(2, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¯¯å·® *s = 0; double* b = &amp;BF(2, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„åç½® double o = OF(2, n);//è·å–ç¬¬aä¸ªç¥ç»å…ƒçš„è¾“å‡º for (int nn = 1; nn &lt;= NS(3); nn++) &#123;//ä¸‹ä¸€å±‚ double lw = WF(3, nn, n);//è·å–ä¸‹ä¸€å±‚åˆ°å½“å‰ç¥ç»å…ƒçš„åç½® double ls = SF(3, nn);//è·å–ä¸‹ä¸€å±‚ç¬¬nnä¸ªç¥ç»å…ƒçš„è¯¯å·® *s += ls * lw * f_(o); &#125; *b = *b - LN * (*s);//æ›´æ–°åç½® //æ›´æ–°æƒé‡ for (int nn = 1; nn &lt;= INNS; nn++) &#123;//ä¸Šä¸€å±‚ double* w = &amp;WF(2, n, nn); *w = *w - LN * (*s) * INS(nn); &#125; &#125; &#125; LoadInå‡½æ•°: 1234void LoadIn(BPNetWork* network,double* input,double* putout) &#123; memcpy(network-&gt;is, input, INNS*sizeof(double)); memcpy(network-&gt;ts, putout, OUTNS*sizeof(double));&#125; ETotalå‡½æ•°: 1234567double ETotal(BPNetWork* network) &#123; double val = 0; for (int a = 1; a &lt;= OUTNS; a++) &#123; val += ((OF(LS, a) - TAS(a)) * (OF(LS, a) - TAS(a))) / OUTNS; &#125; return val;&#125; å…¥å£å‡½æ•°: 12345678910111213141516171819202122232425262728293031int main() &#123; int a[] = &#123; 1,20,20,1 &#125;;//4å±‚ç¥ç»å…ƒ,æ•°é‡åˆ†åˆ«ä¸º1,20,20,1 double in[1] = &#123; 0.9 &#125;;//è®­ç»ƒæ ·æœ¬è¾“å…¥1 double in1[1] = &#123; 0.1 &#125;;//è®­ç»ƒæ ·æœ¬è¾“å…¥2 double in2[1] = &#123; 0.5 &#125;;//è®­ç»ƒæ ·æœ¬è¾“å…¥3 double out[1] = &#123; 0.1 &#125;;//ç†æƒ³è¾“å‡º //ç¥ç»ç½‘ç»œè®­ç»ƒç›®æ ‡: //è¾“å…¥ä»»æ„å€¼,è¾“å‡º0.1 BPNetWork* network = BPCreate(a, 4, 0.5); int c = 1000;//è®­ç»ƒ1000æ¬¡ while (c--) &#123; LoadIn(network, in, out); RunOnce(network); TrainOnce(network); LoadIn(network, in1, out); RunOnce(network); TrainOnce(network); LoadIn(network, in2, out); RunOnce(network); TrainOnce(network); &#125; //è®­ç»ƒå®Œåæ¥ä¸€æ³¢æµ‹è¯• double t[1] = &#123; 0.7 &#125;;//è¾“å…¥ double o[1] = &#123; 0.2 &#125;;//å‡‘æ•° LoadIn(network, t, o); RunOnce(network); printf(&quot;OK\\n&quot;); printf(&quot;%g\\n&quot;, ETotal(network)); printf(&quot;%g&quot;, OF(4, 1)); return 0;&#125; è®­ç»ƒç›®æ ‡: è¾“å…¥ä»»æ„æ•°,è¾“å‡ºæ€»ä¸º0.1 ç»è¿‡1000æ¬¡è®­ç»ƒåçš„è¾“å‡º: 123OK0.0101097//æœ€ç»ˆè¯¯å·®0.0994528//è¾“å…¥0.7,è¾“å‡ºçº¦ä¸º0.1","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"GD32Vè¿è¡Œé€Ÿåº¦æ…¢çš„è§£å†³æ–¹æ³•","slug":"GD32Vè¿è¡Œé€Ÿåº¦æ…¢çš„è§£å†³æ–¹æ³•","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/GD32Vè¿è¡Œé€Ÿåº¦æ…¢çš„è§£å†³æ–¹æ³•/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/GD32V%E8%BF%90%E8%A1%8C%E9%80%9F%E5%BA%A6%E6%85%A2%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","excerpt":"ä½¿ç”¨longan mcuæ—¶ï¼Œå‡ºç°äº†å»¶æ—¶1så´å®é™…ä¸Šæ„Ÿè§‰å»¶æ—¶äº†5så·¦å³ è¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ç”±äºå®˜æ–¹æä¾›çš„æ—¶é’Ÿåˆå§‹åŒ–å‡½æ•°æ²¡æœ‰æ‰§è¡Œ","text":"ä½¿ç”¨longan mcuæ—¶ï¼Œå‡ºç°äº†å»¶æ—¶1så´å®é™…ä¸Šæ„Ÿè§‰å»¶æ—¶äº†5så·¦å³ è¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ç”±äºå®˜æ–¹æä¾›çš„æ—¶é’Ÿåˆå§‹åŒ–å‡½æ•°æ²¡æœ‰æ‰§è¡Œ å¯¼è‡´æ ¸å¿ƒé¢‘ç‡è¾¾ä¸åˆ°å…¨é¢‘108MHzï¼Œå‡ºç°å®šæ—¶å™¨å»¶æ—¶é”™è¯¯ æˆ‘ä»¬åªéœ€è¦æŠŠè¯¥åŠŸèƒ½å¼€å¯å³å¯ æ‰¾åˆ°è¯¥å‡½æ•°_init() 1234567891011121314151617181920212223void _init()&#123; SystemInit(); //ECLIC init eclic_init(ECLIC_NUM_INTERRUPTS); eclic_mode_enable(); //printf(&quot;After ECLIC mode enabled, the mtvec value is %x \\n\\n\\r&quot;, read_csr(mtvec)); // // It must be NOTED: // // * In the RISC-V arch, if user mode and PMP supported, then by default if PMP is not configured // // with valid entries, then user mode cannot access any memory, and cannot execute any instructions. // // * So if switch to user-mode and still want to continue, then you must configure PMP first //pmp_open_all_space(); //switch_m2u_mode(); /* Before enter into main, add the cycle/instret disable by default to save power, only use them when needed to measure the cycle/instret */ disable_mcycle_minstret();&#125; åœ¨ä¸»å‡½æ•°å¼€å¤´é‡Œè°ƒç”¨è¯¥å‡½æ•°å³å¯","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"armæ±‡ç¼–æ±‡æ€»","slug":"arm","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.123Z","comments":true,"path":"1970/01/01/arm/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/arm/","excerpt":"å½“åˆå­¦stm32æ—¶å› ä¸ºä¸€ä¸ªæƒ³æ³•ï¼Œç„¶åå°±èµ°å…¥äº†armæ±‡ç¼–çš„ä¸–ç•Œï¼Œè¿™é‡Œå°±æ¥æ±‡æ€»ä¸€ä¸‹ã€‚","text":"å½“åˆå­¦stm32æ—¶å› ä¸ºä¸€ä¸ªæƒ³æ³•ï¼Œç„¶åå°±èµ°å…¥äº†armæ±‡ç¼–çš„ä¸–ç•Œï¼Œè¿™é‡Œå°±æ¥æ±‡æ€»ä¸€ä¸‹ã€‚ stm32çš„armå¤„ç†ä¸€èˆ¬æœ‰7ä¸ªè¿è¡Œæ¨¡å¼ï¼Œåˆ†åˆ«ä¸ºï¼š â€‹ â‘  ç”¨æˆ·æ¨¡å¼ï¼ˆUSRï¼‰ï¼š ç”¨äºæ­£å¸¸æ‰§è¡Œç¨‹åºï¼ˆThe normal ARM program execution stateï¼‰ â€‹ â‘¡ å¿«é€Ÿä¸­æ–­æ¨¡å¼ï¼ˆFIQï¼‰ï¼š ç”¨äºé«˜é€Ÿæ•°æ®ä¼ è¾“ï¼ˆDesigned to support a data transfer or channel processï¼‰ â€‹ â‘¢ å¤–éƒ¨ä¸­æ–­æ¨¡å¼ï¼ˆIRQï¼‰ï¼š ç”¨äºé€šå¸¸çš„ä¸­æ–­å¤„ç†ï¼ˆUsed for general-purpose interrupt handlingï¼‰ â€‹ â‘£ ç®¡ç†æ¨¡å¼ï¼ˆSVCï¼‰ï¼š æ“ä½œç³»ç»Ÿä½¿ç”¨çš„ä¿æŠ¤æ¨¡å¼ï¼ˆProtected mode for the operating systemï¼‰ â€‹ â‘¤ æ•°æ®è®¿é—®ç»ˆæ­¢æ¨¡å¼ï¼ˆABTï¼‰ï¼š å½“æ•°æ®æˆ–æŒ‡ä»¤é¢„å–ç»ˆæ­¢æ—¶è¿›å…¥è¯¥æ¨¡å¼ï¼ˆEntered after a data or instruction prefetch abortï¼‰ â€‹ â‘¥ ç³»ç»Ÿæ¨¡å¼ï¼ˆSYSï¼‰ï¼š è¿è¡Œå…·æœ‰ç‰¹æƒçš„æ“ä½œç³»ç»Ÿä»»åŠ¡ï¼ˆA privileged user mode for the operating systemï¼‰&gt; â€‹ â‘¦ æœªå®šä¹‰æŒ‡ä»¤å¼‚å¸¸æ¨¡å¼ï¼ˆUNDï¼‰ï¼š å½“æœªå®šä¹‰çš„æŒ‡ä»¤æ‰§è¡Œæ—¶è¿›å…¥è¯¥æ¨¡å¼ï¼ˆEntered when an undefined instruction is executedï¼‰ &lt;&gt;æ³¨ï¼šARMå¾®å¤„ç†å™¨çš„è¿è¡Œæ¨¡å¼å¯ä»¥é€šè¿‡è½¯ä»¶æ”¹å˜ï¼ˆä¿®æ”¹CPSRå5ä½ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸­æ–­æˆ–è€…å¼‚å¸¸å¤„ç†æ”¹å˜ æ¯ä¸ªè¿è¡Œæ¨¡å¼ä¸‹è®¿é—®çš„å¯„å­˜å™¨éƒ½æœ‰ä¸€å®šçš„åŒºåˆ« åœ¨ARMå¤„ç†å™¨å†…éƒ¨å…±æœ‰37ä¸ªç”¨æˆ·å¯è®¿é—®çš„å¯„å­˜å™¨ï¼Œåˆ†åˆ«ä¸º 31ä¸ªé€šç”¨çš„32ä½å¯„å­˜å™¨å’Œ6ä¸ªçŠ¶æ€å¯„å­˜å™¨ å…¶ä¸­çš„ç‰¹æ®Šå¯„å­˜å™¨ï¼šr14ï¼šlrå¯„å­˜å™¨ï¼Œç”¨æ¥ä¿å­˜pcå€¼r13ï¼šspå¯„å­˜å™¨ï¼Œæ ˆé¡¶å¯„å­˜å™¨ å¸¸ç”¨æŒ‡ä»¤: 123456789101112131415161718192021mov r0,r1 ;r0 = r1mov r0,#0x1 ;r0 = 0x1mov r0,r1,lsl #3 ;r0 = r1&lt;&lt;3 é€»è¾‘å·¦ç§»(aslç®—æ•°å·¦ç§»)mov r0,r1,lsr #3 ;r0 = r1&gt;&gt;3 é€»è¾‘å³ç§»,é«˜ä½è¡¥0 (asrç®—æ•°å³ç§»ï¼Œé«˜ä½è¡¥ç¬¦å·ä½)ldr r0,[r1] ;å°†r1å¯¹åº”çš„æŒ‡é’ˆæŒ‡å‘çš„å€¼å­˜å…¥r0str r0,[r1] ;å°†r0å­˜å…¥r1å¯¹åº”çš„æŒ‡é’ˆæŒ‡å‘çš„åœ°å€;æ¯”è¾ƒæŒ‡ä»¤cmp r0,r1 ;å°†r0ä¸r1çš„å€¼ç›¸å‡ï¼Œå¹¶æ ¹æ®ç»“æœè®¾ç½®cpsrçš„æ ‡å¿—ä½cmp r0,#100ï¼›å°†r0ä¸100ç›¸å‡ï¼Œå¹¶æ ¹æ®ç»“æœè®¾ç½®cpsrçš„æ ‡å¿—ä½tst r0,r1 ;æŠŠr0çš„å†…å®¹å’Œr1çš„å†…å®¹æˆ–ç«‹å³æ•°è¿›è¡ŒæŒ‰ä½çš„ä¸è¿ç®—ï¼Œå¹¶æ ¹æ®è¿ç®—ç»“æœæ›´æ–°CPSRä¸­æ¡ä»¶æ ‡å¿—ä½çš„å€¼ã€‚;è¿ç®—æŒ‡ä»¤add r0,r1,r2 ;R0 = R1 + R2add r0,r1,#256 ;R0 = R1 + 256add r0,r2,r3,lsl#1 ;R0 = R2 + (R3 &lt;&lt; 1)orr r0,r1,r2 ;å°†r1ä¸r2æˆ–ç«‹å³æ•°åšæˆ–æŒ‰ä½è¿ç®—å¹¶æ”¾å…¥r0;è·³è½¬æŒ‡ä»¤b label ;ç›´æ¥è·³è½¬åˆ°labelå¤„bl label ;ç›´æ¥è·³è½¬åˆ°labelå¤„ï¼Œå¹¶å°†å½“å‰çš„pcå€¼å­˜å…¥r14;ä¼ªæŒ‡ä»¤push &#123;r0&#125; ;å‹æ ˆå…¥æ ˆ,æ³¨æ„stm32å‹æ ˆä¸ºå‘ä¸‹å‹æ ˆ,å³sp=sp-4pop &#123;r0&#125; PS: â€œ#0x1â€æ˜¯ç«‹å³æ•°ï¼Œç«‹å³æ•°æ˜¯æŒ‡ï¼Œèƒ½å¤Ÿç”¨0-255ä¹‹å†…çš„æ•°æ®å¾ªç¯å³ç§»å¶æ•°ä½å¾—åˆ°çš„æ•° åˆ¤æ–­è§„åˆ™å¦‚ä¸‹ï¼š æŠŠæ•°æ®è½¬æ¢æˆäºŒè¿›åˆ¶å½¢å¼ï¼Œä»ä½ä½åˆ°é«˜ä½å†™æˆ4ä½1ç»„çš„å½¢å¼ï¼Œæœ€é«˜ä½ä¸€ç»„ä¸å¤Ÿ4ä½çš„ï¼Œåœ¨æœ€é«˜ä½å‰é¢è¡¥0ã€‚ æ•°1çš„ä¸ªæ•°ï¼Œå¦‚æœå¤§äº8ä¸ªè‚¯å®šä¸æ˜¯ç«‹å³æ•°ï¼Œå¦‚æœå°äºç­‰äº8è¿›è¡Œä¸‹é¢æ­¥éª¤ã€‚ å¦‚æœæ•°æ®ä¸­é—´æœ‰è¿ç»­çš„å¤§äºç­‰äº24ä¸ª0,å¾ªç¯å·¦ç§»2çš„å€æ•°ï¼Œä½¿é«˜ä½å…¨ä¸º0ã€‚ æ‰¾åˆ°æœ€é«˜ä½çš„1ï¼Œå»æ‰å‰é¢æœ€å¤§å¶æ•°ä¸ª0ã€‚ æ‰¾åˆ°æœ€ä½ä½çš„1ï¼Œå»æ‰åé¢æœ€å¤§å¶æ•°ä¸ª0ã€‚ æ•°å‰©ä¸‹çš„ä½æ•°ï¼Œå¦‚æœå°äºç­‰äº8ä½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯ç«‹å³æ•°ï¼Œåä¹‹å°±ä¸æ˜¯ç«‹å³æ•°ã€‚ å‡½æ•°è°ƒç”¨è§„åˆ™: å‡½æ•°è°ƒç”¨æ—¶ä¼šæ‰§è¡Œâ€œBL funcâ€æŒ‡ä»¤ å‡½æ•°å‚æ•°ä¼ é€’é€šè¿‡r0~r4å¯„å­˜å™¨ï¼Œå¤šä½™å‚æ•°é€šè¿‡æ ˆä¼ é€’ è¿›å…¥å‡½æ•°åä¼šæ‰§è¡Œä¸€æ¡â€œpush {lr}â€æŒ‡ä»¤(æ ¹æ®ä¸åŒæƒ…å†µï¼Œä¼šå‹å…¥å…¶å®ƒå¯„å­˜å™¨) é€€å‡ºå‡½æ•°æ—¶é€šè¿‡r0è¿”å›ç»“æœï¼Œå¹¶æ‰§è¡Œâ€œpop {pc}â€(æ ¹æ®ä¸åŒæƒ…å†µï¼Œä¼šå¼¹å‡ºå…¶å®ƒå€¼åˆ°å¦å¤–çš„å¯„å­˜å™¨)","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"arm","slug":"arm","permalink":"https://tastynoob.github.io/tags/arm/"}]},{"title":"k210æ—¶é’Ÿæ ‘è®²è§£","slug":"k210æ—¶é’Ÿæ ‘è®²è§£","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.124Z","comments":true,"path":"1970/01/01/k210æ—¶é’Ÿæ ‘è®²è§£/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/k210%E6%97%B6%E9%92%9F%E6%A0%91%E8%AE%B2%E8%A7%A3/","excerpt":"k210æ—¶é’Ÿæ ‘è®²è§£","text":"k210æ—¶é’Ÿæ ‘è®²è§£ é¦–å…ˆæ¥çœ‹çœ‹å®Œæ•´çš„k210æ—¶é’Ÿæ ‘ çœ‹ç€å¾ˆå¤æ‚å¯¹å§ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥åˆ†æçœ‹çœ‹ k210 æ€»å…±æœ‰3ä¸ªPLLå€é¢‘å™¨ PLL0ä¸ºå†…æ ¸å’Œå¤§éƒ¨åˆ†å¤–è®¾æä¾›æ—¶é’Ÿ PLL1ä¸ºAIæä¾›æ—¶é’Ÿ PLL2ä¸ºI2Sæä¾›æ—¶é’Ÿ æ¯ä¸ªPLLå†…éƒ¨åˆ†åˆ«ç»è¿‡ï¼š CLKRï¼ˆ1~16ï¼‰åˆ†é¢‘ï¼ŒCLKFï¼ˆ1~64ï¼‰å€é¢‘ï¼ŒCLKODï¼ˆ1~16ï¼‰åˆ†é¢‘ è¾“å‡ºæ—¶é’Ÿ å…ˆæ¥çœ‹çœ‹PLL0 PLL0æ˜¯æœ€å¤æ‚çš„ä¸€éƒ¨åˆ† é¦–å…ˆï¼Œå¤–éƒ¨26Mæ™¶æŒ¯è¿å…¥PLL0å’ŒACLK MUXæ—¶é’Ÿé€‰æ‹©å™¨ PLL0ç”±â€PLL0 OUT ENâ€œä¿¡å·ä½¿èƒ½è¾“å‡º PLL0æ—¶é’Ÿè¿å…¥ACLKåˆ†é¢‘å™¨ï¼ŒACLKï¼ˆ2,4,8,16ï¼‰åˆ†é¢‘å™¨è¿å…¥ACLK MUXæ—¶é’Ÿé€‰æ‹© é€šè¿‡æ§åˆ¶â€ACLK SELâ€œä¿¡å·å¯é€‰æ‹©ALCKæ—¶é’Ÿæ˜¯PLL0è¾“å…¥è¿˜æ˜¯26Mæ™¶æŒ¯è¾“å…¥ ACLKæ—¶é’Ÿæ‰æ˜¯å®é™…ä¸Šä¸ºå†…æ ¸å’Œå¤§éƒ¨åˆ†å¤–è®¾æä¾›çš„æ—¶é’Ÿ ç”±å›¾å¯ä»¥çœ‹åˆ° ACLKæ—¶é’Ÿç›´æ¥ç»™CPUï¼ŒDMAï¼ŒSPI3ï¼ŒFFT,SRAM0,SRAM1æä¾›æ—¶é’Ÿ ACLKä¸‹æŒ‚è½½ç€APB0~APB2å’ŒDVPï¼ŒROMè¿™5ä¸ªåˆ†é¢‘å™¨ APBåˆ†é¢‘å™¨å¯ä»¥æä¾›1~8çš„åˆ†é¢‘ æ¯ä¸ªåˆ†é¢‘å™¨éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ä½¿èƒ½ä¿¡å· å†æ¥çœ‹çœ‹å¤–è®¾çš„ä¸€éƒ¨åˆ† æ¯ä¸ªAPBæ€»çº¿å¯å•ç‹¬å †ACLKåˆ†é¢‘ï¼Œåˆ†é¢‘ç³»æ•°ä¸º1~8 æ¯ä¸ªAPBæ€»çº¿éƒ½æœ‰ä¸ªâ€œCLK EN GROUPâ€ æ—¶é’Ÿä½¿èƒ½ç»„ æ„æ€æ˜¯æ¯ä¸ªAPBæ€»çº¿ä¸ŠæŒ‚è½½çš„å¤–è®¾éƒ½æœ‰ä¸ªä¸ä¹‹å¯¹åº”çš„æ—¶é’Ÿä½¿èƒ½ä¿¡å· APB0ä¸Šæ˜¯å¸¸ç”¨çš„GPIOï¼ŒUARTï¼ŒSPIç­‰å¤–è®¾æ—¶é’Ÿ è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼Œçœ‹åˆ°APBå¤–è®¾ç»„æ—è¾¹çš„å‡ æ ¹è™šçº¿æ²¡ï¼Ÿ è¿™ä¸ªè¿æ¥çš„æ˜¯ä¸€äº›ç‰¹æ®Šå¤–è®¾ï¼ŒåŒ…æ‹¬TIMERï¼ŒI2Cï¼ŒSPIï¼ŒI2Sï¼ŒWDTï¼Œ å®ƒä»¬çš„æ—¶é’Ÿå®é™…ä¸Šç”±ä¸“ç”¨çš„åˆ†é¢‘å™¨æä¾› è¿™æ„å‘³è¿™è¿™å‡ ä¸ªå¤–è®¾å¯ä»¥æ›´åŠ çµæ´»çš„åœ¨ä¸åŒé¢‘ç‡ä¸‹å·¥ä½œè€Œä¸ä¼šæ”¶åˆ°APBæ—¶é’Ÿå½±å“ åˆæ­¤ä¹‹å¤–ï¼ŒAPB1æ—¶é’Ÿè¿˜è¿æ¥ç€OPT MUXæ—¶é’Ÿé€‰æ‹©å™¨ OPT MUXæ—¶é’Ÿé€‰æ‹©å™¨è¿˜å¯ä»¥é€‰æ‹©ç”±å¤–éƒ¨æ™¶æŒ¯ç»è¿‡2åˆ†é¢‘åçš„æ—¶é’Ÿ APB1åŒæ—¶é€šè¿‡ä¸€ä¸ªåˆ†é¢‘å™¨ç»„â€œAPB1 CLK THâ€è¾“å‡ºAPB1æ—¶é’Ÿ ä¸‹é¢æ¥çœ‹çœ‹è¿™äº›ç‰¹æ®Šå¤–è®¾ è¿™é‡Œæ¯ä¸ªåˆ†é¢‘å™¨éƒ½æ˜¯åˆ†é¢‘å™¨ç»„ éƒ½å¯ä»¥å•ç‹¬ä¸ºè¿™äº›å¤–è®¾SPI0ï¼ŒSPI1â€¦TIMER0ï¼ŒTIMER1â€¦ æä¾›2~512çš„åˆ†é¢‘ å…¶ä¸­è¿˜æœ‰ä¸ªæ›´ç‰¹æ®Šçš„å¤–è®¾SPI3 å®ƒæœ‰ç‹¬ç«‹çš„æ—¶é’Ÿé€‰æ‹©å™¨ï¼Œæ—¶é’Ÿéè¾“å‡ºï¼Œ2è·¯SPIæ—¶é’Ÿè¾“å‡º æœ€ä¸‹é¢è¿˜æœ‰RTCæ—¶é’Ÿï¼Œç›´æ¥ç”±å¤–éƒ¨æ™¶æŒ¯æä¾› æœ€ä¸Šé¢å°±åˆ™æ˜¯PLL1å’ŒPLL2 PLL1ç»è¿‡â€œAI GCLK THâ€åˆ†é¢‘å™¨ç»™AIæä¾›æ—¶é’Ÿ PLL2è¾“å…¥ä¸ºMUXæ—¶é’Ÿé€‰æ‹©å™¨ï¼Œå¯ä»¥ç”±PLL1ï¼ŒPLL0å’Œå¤–éƒ¨æ™¶æŒ¯æä¾›è¾“å…¥ PLL2æä¾›I2Sé«˜ç²¾åº¦æ—¶é’Ÿ å› æ­¤ï¼Œåœ¨å®é™…è£¸æœºå¼€å‘æ—¶è¦æ³¨æ„æ—¶é’Ÿçš„ç®¡ç† å¯èƒ½ä¼šç”±äºè°ƒæ•´cpué¢‘ç‡è€Œå¯¼è‡´å…¶å®ƒå¤–è®¾æ— æ³•å·¥ä½œçš„æƒ…å†µ ä¾‹å¦‚åœ¨PLL0é¢‘ç‡è¾¾åˆ°600MHzçš„æƒ…å†µä¸‹ä½¿ç”¨SPI0è®¾å¤‡ å¦‚æœä¸å¯¹SPI0åˆ†é¢‘å™¨è¿›è¡Œåˆ†é¢‘ï¼Œå°±æœ‰ä¼šå¯¼è‡´SPI0æ—¶é’Ÿè¿‡å¤§ k210æ—¶é’Ÿç”±â€œsysctlâ€å¯„å­˜å™¨ç»„è¿›è¡Œæ§åˆ¶ æ—¶é’Ÿä¸»è¦ç”±è¿™å‡ ä¸ªå¯„å­˜å™¨æ§åˆ¶ PLL0ï¼ŒPLL1ï¼ŒPLL12 æ§åˆ¶å¯„å­˜å™¨ æ—¶é’Ÿé€‰æ‹©0ã€1å¯„å­˜å™¨ æ—¶é’Ÿé¢‘ç‡è®¾ç½®0~6å¯„å­˜å™¨ ç”±äºå¯„å­˜å™¨è®¾ç½®ä½å¤ªå¤šï¼Œè¿™é‡Œä¸è¯¦ç»†ä»‹ç» è¯¦ç»†å¯å‚è€ƒk210å¯„å­˜å™¨æ‰‹å†Œ","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"k210","slug":"k210","permalink":"https://tastynoob.github.io/tags/k210/"}]},{"title":"vscodeä¸Šçš„linuxè¿œç¨‹å¼€å‘é…ç½®","slug":"linux_ssh","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.132Z","comments":true,"path":"1970/01/01/linux_ssh/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/linux_ssh/","excerpt":"1234æ— ","text":"1234æ—  åœ¨åˆ©ç”¨sshè¿›è¡Œè¿œç¨‹å¼€å‘æ—¶ å¦‚æœè¦æŸ¥çœ‹è¿œç¨‹çš„å›¾åƒæˆ–è€…æ‘„åƒå¤´æ—¶ å°±ä¼šæ— æ³•æ˜¾ç¤º æ¯”å¦‚åœ¨è¿œç¨‹å¼€å‘opencvæ—¶ å°±ä¼šæ— æ³•æŸ¥çœ‹opencvçš„çª—å£ ä½†æ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨è¿œç¨‹å¼€å‘æ—¶ è¿œç¨‹çš„çª—å£ä¹Ÿèƒ½åœ¨æœ¬åœ°æ˜¾ç¤º è¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘å’Œè°ƒè¯• è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨vscodeçš„remoteæ’ä»¶è¿›è¡Œè¿œç¨‹å¼€å‘ ä¸å…‰å¯ä»¥æ˜¾ç¤ºå›¾ç‰‡ï¼Œè¿˜å¯ä»¥æ˜¾ç¤ºå’Œæ§åˆ¶å›¾å½¢ç¨‹åº é¦–å…ˆä½ è¦åœ¨vscodeä¸Šå®‰è£…remote sshå’Œremote x11æ’ä»¶ å¹¶èƒ½è¿›è¡Œå…å¯†ç™»å½•è¿œç¨‹æœåŠ¡å™¨ æˆ‘ä»¬æ¥å°è¯•ä½¿ç”¨windowsæœ¬åœ°ä¸»åŠ›æœºè¿æ¥è¿œç¨‹linuxæœåŠ¡å™¨è¿›è¡Œè¿œç¨‹å¼€å‘ é¦–å…ˆæ˜¯sshçš„é…ç½®ï¼Œç¡®ä¿ä½ æ‹¥æœ‰opensshå¹¶å¼€å¯äº†sshæœåŠ¡ å®¢æˆ·ç«¯(windows)å’ŒæœåŠ¡ç«¯(linux)éƒ½éœ€è¦å¼€å¯ windowsä¸‹ï¼š windowsæˆ‘ä»¬éœ€è¦ç”Ÿæˆæœ¬åœ°çš„sshå¯†åŒ™ æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥ssh-keygen,å›è½¦ ç„¶åä»–ä¼šè®©ä½ é…ç½®å¯†ç ï¼Œæˆ‘ä»¬è¦å…å¯†ç™»å½•æ‰€ä»¥ç›´æ¥å›è½¦ï¼Œä¸é…ç½®å¯†ç  åé¢éœ€è¦å›è½¦ä¸‰æ¬¡ï¼Œå¦‚æœæœ€åè¾“å‡ºä¸€æ®µå¥‡æ€ªå­—ç¬¦å°±ä»£è¡¨ç”ŸæˆæˆåŠŸ æ‰“å¼€user&#x2F;.sshæ–‡ä»¶å¤¹ï¼Œå°±èƒ½çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶ å…¶ä¸­id_rsa.pubå°±æ˜¯ä½ çš„å…¬åŒ™ï¼Œå¯ä»¥ç”¨è¯¥å…¬åŒ™å®ç°è¿œç¨‹å…å¯†ç™»å½• linuxä¸‹ï¼š linuxæœåŠ¡ç«¯éœ€è¦å…è®¸å¤–éƒ¨sshè¿æ¥ å…ˆæå‰åœ¨linuxä¸Šé…ç½®å¥½ç›¸å…³é…ç½® å‡å¦‚ä½ windowsè¿œç¨‹éœ€è¦ç™»å½•æœåŠ¡å™¨ä¸Šçš„userç”¨æˆ· åœ¨linuxä¸Šç™»å½•userè´¦å· æ‰“å¼€ç»ˆç«¯ è¾“å…¥sudo vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config æ‰¾åˆ°å¦‚å›¾çš„2é¡¹ é»˜è®¤æƒ…å†µä¸‹è¿™ä¸¤é¡¹æ˜¯è¢«æ³¨é‡Šæ‰çš„ å°†è¿™ä¸¤é¡¹å–æ¶ˆæ³¨é‡Šå³å¯ .ssh&#x2F;authorized_keysè¿™ä¸ªæ˜¯ä½ çš„å¤–éƒ¨å¯†åŒ™ä¿å­˜æ–‡ä»¶ å¦‚æœä½ æ˜¯ä½¿ç”¨userç”¨æˆ·ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶åº”è¯¥å°±æ˜¯user&#x2F;.ssh&#x2F;authorized_keys ç»§ç»­ç»ˆç«¯è¾“å…¥ cd ~&#x2F;.ssh è¾“å…¥vim authorized_keys å°†åœ¨windowsä¸Šçš„å¯†åŒ™æ–‡ä»¶id_rsa.pubé‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ°authorized_keysæ–‡ä»¶é‡Œ ä¿é™©æœŸé—´æˆ‘ä»¬ä¸€èˆ¬æ˜¯å…ˆæŠŠid_rsa.pubå¤åˆ¶åˆ°user&#x2F;.ssh&#x2F;æ–‡ä»¶å¤¹ä¸‹ ç„¶åä½¿ç”¨cat id_rsa.pub &gt;&gt; authorized_keys id_rsa.pubé‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ°authorized_keysæ–‡ä»¶é‡Œ ç„¶åé‡å¯sshæœåŠ¡service sshd restart æ¥ä¸‹æ¥åœ¨vscodeè¿™è¾¹å®‰è£…å¥½remote sshå’Œremote x11 æ‰“å¼€ä¾§è¾¹æ çš„â€œè¿œç¨‹èµ„æºç®¡ç†å™¨â€ è¿™é‡Œæˆ‘æ˜¯å·²ç»é…ç½®å¥½2ä¸ªè¿œç¨‹å¼€å‘ç¯å¢ƒäº† ç‚¹å‡»å³ä¸Šè§’çš„è®¾ç½®,å¼¹å‡ºä¸€ä¸ªé€‰æ‹©æ¡†,é€‰æ‹©ç¬¬ä¸€ä¸ª å…¶ä¸­ï¼šHostæ˜¯è¿œç¨‹æœåŠ¡å™¨çš„åç§°ï¼Œå¯è‡ªå®šä¹‰ HostNameæ˜¯è¿œç¨‹æœåŠ¡å™¨IPåœ°å€æˆ–è€…ç½‘å€,å¿…é¡»è¦å¡«å¯¹ Portæ˜¯è¿œç¨‹æœåŠ¡å™¨sshç«¯å£ï¼Œé»˜è®¤ä¸º22 Useræ˜¯ä½ è¦ç™»å½•è¿œç¨‹æœåŠ¡å™¨çš„è´¦å·ï¼Œå¿…é¡»è¦å¡«å¯¹ï¼Œä½ è¦ä½¿ç”¨userè´¦å·å°±å¡«user å¦å¤–æœ€ä¸‹é¢çš„3ä¸ªé€‰é¡¹æ˜¯è¿œç¨‹æœåŠ¡å™¨çš„çª—ä½“æ˜ å°„å¼€å¯ å¼€å¯è¿™ä¸‰ä¸ªé€‰é¡¹å°±èƒ½å®ç°è¿œç¨‹çª—å£åœ¨æœ¬åœ°æ˜¾ç¤º æ¯”å¦‚æƒ³åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ˜¾ç¤ºå›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨æœ¬åœ°å°±èƒ½ç”Ÿæˆä¸€ä¸ªçª—å£æ˜¾ç¤ºè¿œç¨‹å›¾ç‰‡ å¼€å¯x11è¿˜éœ€è¦å®‰è£…X server æœ¬åœ°éœ€è¦ä¸‹è½½å¹¶å®‰è£…Xlaunchè½¯ä»¶ è¿™ä¸ªå¯è‡ªè¡Œæœç´¢ä¸‹è½½ ä»¥ä¸Šè®¾ç½®é…ç½®å¥½åï¼Œ å°±å¯ä»¥å³é”®è¿œç¨‹èµ„æºçª—å£é‡Œçš„è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œè¿æ¥ å¦‚å›¾å·²è¿æ¥ä¸Šè¿œç¨‹æœåŠ¡å™¨ æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹æ„‰å¿«çš„å¼€å‘äº† ç”±äºå¼ºå¤§çš„vscodeæ”¯æŒï¼Œè¿œç¨‹å¼€å‘ååˆ†é¡ºæ»‘ï¼Œæ¯”è¿œç¨‹æ¡Œé¢æ›´å¥½ç”¨ æœ€åå†æ¥è¯´ä¸€ä¸‹Xlaunchçš„ç”¨æ³• æ‰“å¼€Xlaunchè½¯ä»¶ï¼Œå®ƒä¼šæç¤ºä½ è®¾ç½®çª—å£ç•Œé¢ï¼Œç›´æ¥ä¸‹ä¸€æ­¥å³å¯ ç„¶ååœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä¹Ÿè¦å®‰è£…remote x11æ’ä»¶ å¦‚å›¾é€‰æ‹©åœ¨SSH:userä¸Šå®‰è£…å³å¯ å®‰è£…å®Œæˆåä»¥é˜²ä¸‡ä¸€é‡å¯æ¬¡æœåŠ¡å™¨å’Œvscode æ¥ä¸‹æ¥ç¡®ä¿x11æœåŠ¡å¼€å¯ï¼ŒXLaunchå¼€å¯ åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰“å¼€ä¸€ä¸ªå›¾ç‰‡ å¦‚æœæ— è¯¯ï¼Œé‚£ä¹ˆæœ¬åœ°å°±ä¼šå‡ºç°ä¸€ä¸ªçª—å£ï¼Œé‡Œé¢æ˜¾ç¤ºä½ é€‰æ‹©çš„å›¾ç‰‡ X11ä¹Ÿå¯ä»¥ç”¨æ¥æ˜¾ç¤ºå›¾å½¢åŒ–è½¯ä»¶ï¼Œopencvç­‰çª—å£ï¼Œæ¯”è¿œç¨‹æ¡Œé¢å“åº”æ›´å¿«ï¼Œå»¶è¿Ÿæ›´å°","categories":[{"name":"linux","slug":"linux","permalink":"https://tastynoob.github.io/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"https://tastynoob.github.io/tags/linux/"}]},{"title":"åŸºäºgd32vfçš„çœŸÂ·å¤šçº¿ç¨‹ç³»ç»Ÿ","slug":"longan thread","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.132Z","comments":true,"path":"1970/01/01/longan thread/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/longan%20thread/","excerpt":"åŸºäºgd32vfçš„çœŸÂ·å¤šçº¿ç¨‹ç³»ç»Ÿ","text":"åŸºäºgd32vfçš„çœŸÂ·å¤šçº¿ç¨‹ç³»ç»Ÿ ç›®å‰åº”ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„æ“ä½œç³»ç»Ÿä¸€èˆ¬éƒ½æ˜¯ å®æ—¶å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿï¼Œå®é™…ä¸Šç®—æ˜¯ä¼ªå¤šçº¿ç¨‹ åªæœ‰å½“ä½ æ˜ç¡®çš„è°ƒç”¨ä»»åŠ¡delayå‡½æ•°æ—¶æ‰ä¼šå‘ç”Ÿè°ƒåº¦ ä»¥å‰æƒ³è®¾è®¡ä¸€ä¸ªçœŸÂ·å¤šçº¿ç¨‹æ“ä½œç³»ç»Ÿ ä½†æ˜¯åœ¨stm32å¹³å°ä¸Šå¼€å‘çš„ï¼Œç”±äºcm3å†…æ ¸çš„å°é—­æ€§ï¼Œæ— æ³•æ˜ç¡®çš„ä¿®æ”¹å…³é”®å¯„å­˜å™¨ ä½†æ˜¯åœ¨riscvä¸Šåˆ™å¯ä»¥å®ç°ï¼Œriscvæ˜ç¡®äº†å‡ ç§ä¸­æ–­è§¦å‘æ–¹å¼ åˆ©ç”¨è‡ªå®šä¹‰ä¸­æ–­å¤„ç†å‡½æ•°å¯ä»¥å®ç°å¯¹å…³é”®å¯„å­˜å™¨è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œè¾¾åˆ°åˆ‡æ¢çº¿ç¨‹çš„ç›®çš„ ä¸‹é¢æ˜¯gd32vçš„ä¸­æ–­å…¥å£ è¿™é‡Œä½¿ç”¨å®šæ—¶å™¨6ä½œä¸ºçº¿ç¨‹è°ƒåº¦æ—¶é’Ÿï¼Œæ—¶é—´è®¾ç½®ä¸º1msä¸­æ–­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111 .section .text.irq .align 2 .global irq_entry.weak irq_entryirq_entry: // -------------&gt; This label will be set to MTVT2 register // Allocate the stack space //ä¿å­˜ç°åœº SAVE_CONTEXT// Save 16 regs //------This special CSR read operation, which is actually use mcause as operand to directly store it to memory csrrwi x0, CSR_PUSHMCAUSE, 17 //------This special CSR read operation, which is actually use mepc as operand to directly store it to memory csrrwi x0, CSR_PUSHMEPC, 18 //------This special CSR read operation, which is actually use Msubm as operand to directly store it to memory csrrwi x0, CSR_PUSHMSUBM, 19 service_loop: //------This special CSR read/write operation, which is actually Claim the CLIC to find its pending highest // ID, if the ID is not 0, then automatically enable the mstatus.MIE, and jump to its vector-entry-label, and // update the link register csrrw ra, CSR_JALMNXTI, ra //RESTORE_CONTEXT_EXCPT_X5 //æ¢å¤ç°åœº #---- Critical section with interrupts disabled ----------------------- DISABLE_MIE # Disable interrupts LOAD x5, 19*REGBYTES(sp) csrw CSR_MSUBM, x5 LOAD x5, 18*REGBYTES(sp) csrw CSR_MEPC, x5 LOAD x5, 17*REGBYTES(sp) csrw CSR_MCAUSE, x5 RESTORE_CONTEXT // Return to regular code mret.global TIMER6_IRQHandler//å®šæ—¶å™¨å…­ä¸­æ–­ï¼Œä½œä¸ºçº¿ç¨‹åˆ‡æ¢ä¸­æ–­TIMER6_IRQHandler: //ä¿å­˜x18~x27å¯„å­˜å™¨,s1 addi sp, sp, -11*REGBYTES STORE x27, 0*REGBYTES(sp) STORE x26, 1*REGBYTES(sp) STORE x25, 2*REGBYTES(sp) STORE x24, 3*REGBYTES(sp) STORE x23, 4*REGBYTES(sp) STORE x22, 5*REGBYTES(sp) STORE x21, 6*REGBYTES(sp) STORE x20, 7*REGBYTES(sp) STORE x19, 8*REGBYTES(sp) STORE x18, 9*REGBYTES(sp) STORE x9, 10*REGBYTES(sp) mv a0,sp //sp mv a1,s0 //fp addi sp,sp,-4 sw ra,0(sp) call switch_thread lw ra,0(sp) addi sp,sp,4 mv sp,x30 //åˆ‡æ¢sp mv s0,x31 //åˆ‡æ¢fp //è¿˜åŸx18~x27å¯„å­˜å™¨,s1 LOAD x27, 0*REGBYTES(sp) LOAD x26, 1*REGBYTES(sp) LOAD x25, 2*REGBYTES(sp) LOAD x24, 3*REGBYTES(sp) LOAD x23, 4*REGBYTES(sp) LOAD x22, 5*REGBYTES(sp) LOAD x21, 6*REGBYTES(sp) LOAD x20, 7*REGBYTES(sp) LOAD x19, 8*REGBYTES(sp) LOAD x18, 9*REGBYTES(sp) LOAD x9, 10*REGBYTES(sp) addi sp, sp, 11*REGBYTES //æ¸…ç©ºè®¡æ•°å™¨ lui a0,0x40001 addi a1,a0,1060 sw zero,0(a1) //æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½ addi a1,a0,1040 li a2,-2 sw a2,0(a1) ret ä¸‹é¢æ˜¯çº¿ç¨‹åˆ‡æ¢çš„å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#ifndef THREAD_H#define THREAD_H#include &quot;config.h&quot;#include &quot;myalloc.h&quot;#include &quot;systick.h&quot;//æœ€å¤§å¯ç”¨çº¿ç¨‹æ•°#define max_thread_num 5typedef void(*Func)();typedef struct &#123; volatile int sp; volatile int fp; volatile int* stack; volatile int wait_tick;//ç­‰å¾…tick volatile int available;//æ˜¯å¦æ¿€æ´» volatile int pri;//è¿è¡Œä¼˜å…ˆçº§ volatile int re_pri;//é‡è£…è½½ä¼˜å…ˆçº§,æ¯å½“ä¸€ä¸ªçº¿ç¨‹è¿è¡Œå®Œæ¯•å°±ä¼šé‡ç½®pri&#125;Thread;extern volatile int thd_flag;extern volatile int thd_ptr;extern Thread thds[max_thread_num];//çº¿ç¨‹åˆå§‹åŒ–void thread_init();//çº¿ç¨‹åˆ›å»ºThread* thread_creat(Func func, int stack_size, int level);void thread_release(Thread* thd);//çº¿ç¨‹é‡Šæ”¾//çº¿ç¨‹ç¡çœ void thread_sleep_tick(int tick);//çº¿ç¨‹å¼€å¯è°ƒåº¦void thread_start();//åœ¨è¿›è¡Œä¸€äº›ä¸å¯åˆ†å‰²æ“ä½œæ—¶ï¼Œè°ƒç”¨è¯¥å‡½æ•°è¿›è¡Œæš‚åœçº¿ç¨‹è°ƒåº¦//å…³é—­å®šæ—¶å™¨ä¸­æ–­ //åœæ­¢è®¡æ•°#define thd_stop do&#123;\\if (thd_flag == 1)\\&#123;\\TIMER_DMAINTEN(TIMER6) &amp;= (~(uint32_t)TIMER_INT_UP); \\&#125;\\&#125;while (0)//åœ¨è¿›è¡Œä¸€äº›ä¸å¯åˆ†å‰²æ“ä½œæ—¶ï¼Œè°ƒç”¨è¯¥å‡½æ•°è¿›è¡Œç»§ç»­çº¿ç¨‹è°ƒåº¦//å¼€å¯å®šæ—¶å™¨ä¸­æ–­//ç»§ç»­è®¡æ•°#define thd_cont do&#123;\\if (thd_flag == 1)\\&#123; \\TIMER_DMAINTEN(TIMER6) |= (uint32_t)TIMER_INT_UP; \\&#125;\\&#125;while (0)#endif // !THREAD_H 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195#include &quot;thread.h&quot;int thd_num = 1;Thread thds[max_thread_num];//å½“å‰çº¿ç¨‹æŒ‡é’ˆvolatile int thd_ptr = 0;volatile int thd_flag = 0;/*çº¿ç¨‹è°ƒåº¦è¯´æ˜ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªåŸºç¡€ç­‰çº§,ç­‰çº§è¶Šå¤§æ‰§è¡Œæ¦‚ç‡è¶Šä½åŸºç¡€ç­‰çº§ = levelæ¯ä¸ªçº¿ç¨‹è¿è¡Œä¸€æ¬¡åˆ™å¢åŠ 1ç‚¹ç­‰çº§å…¶å®ƒå¯ç”¨ä½†æœªæ‰§è¡Œçš„çº¿ç¨‹ç­‰çº§-1*///çº¿ç¨‹åˆå§‹åŒ–void thread_init() &#123; for (int i = 0;i &lt; max_thread_num;i++) &#123; thds[i].fp = 0; thds[i].sp = 0; thds[i].stack = 0; thds[i].wait_tick = 0; thds[i].available = 0; &#125; //ä¸»çº¿ç¨‹,ä¸»çº¿ç¨‹ä¼˜å…ˆçº§ä¸º2 thds[0].available = 1; thds[0].wait_tick = 0; thds[0].pri = 2; thds[0].re_pri = 2;&#125;//çº¿ç¨‹åˆ›å»ºThread* thread_creat(Func func, int stack_size, int level) &#123; thd_stop; for (int i = 0;i &lt; max_thread_num;i++) &#123; if (thds[i].available == 0) &#123; thds[i].stack = myalloc(stack_size); int stack_dep = (stack_size - 1) / 4; //è®¾ç½®æ ˆå’Œæ ˆå¸§ thds[i].sp = (int)&amp;(thds[i].stack[stack_dep - 31]); thds[i].fp = (int)&amp;(thds[i].stack[stack_dep]); //msubmæ‰€åœ¨ä½ç½® thds[i].stack[stack_dep - 31 + 11 + 19] = 64; //mecpæ‰€åœ¨ä½ç½® thds[i].stack[stack_dep - 31 + 11 + 18] = (int)func; //mcauseæ‰€åœ¨ä½ç½® thds[i].stack[stack_dep - 31 + 11 + 17] = -1207959478; //x1æ‰€åœ¨ä½ç½® thds[i].stack[stack_dep - 31 + 11 + 0] = (int)func; thds[i].available = 1; thds[i].pri = level; thds[i].re_pri = level; return &amp;thds[i]; &#125; &#125; thd_cont; return NULL;&#125;//çº¿ç¨‹é‡Šæ”¾inline void thread_release(Thread* thd) &#123; thd_stop; thd-&gt;available = 0; myfree((void*)thd-&gt;stack); thd_cont;&#125;//çº¿ç¨‹ç¡çœ ,å¹¶æ‰‹åŠ¨è§¦å‘ä¸­æ–­void thread_sleep_tick(int tick) &#123; thds[thd_ptr].wait_tick = tick; //ç­‰å¾…ä¸­æ–­ asm volatile(&quot;wfi&quot;);&#125;//çº¿ç¨‹å¼€å¯è°ƒåº¦void thread_start() &#123; thd_flag = 1; //æ¸…é™¤æ ‡å¿—ä½ TIMER_INTF(TIMER6) = (~1); //å¼€å¯æ—¶é’Ÿ TIMER_CTL0(TIMER6) |= (uint32_t)TIMER_CTL0_CEN; //å…³é—­æ—¶é’Ÿ //TIMER_CTL0(TIMER6) &amp;= ~(uint32_t)TIMER_CTL0_CEN;&#125;volatile int thds_temp[max_thread_num];//çº¿ç¨‹åˆ‡æ¢ï¼Œç”±ä¸­æ–­ç¨‹åºè¿›è¡Œè°ƒç”¨void switch_thread(int sp, int fp) &#123; //ä¿å­˜ä¸Šæ¬¡ä¸­æ–­å¤„çš„spã€fp thds[thd_ptr].sp = sp; thds[thd_ptr].fp = fp; int temp_head = 0; int thd_vld = 0; while (1) &#123; // int p; // asm volatile(&quot;mv %0,sp&quot;:&quot;=r&quot;(p) : ); //printf(&quot;sp%d\\n\\n&quot;, thds[thd_ptr].wait_tick); for (int i = 0;i &lt; max_thread_num;i++) &#123; if (thds[i].available) &#123; if (thds[i].wait_tick &lt; 1) &#123; thds_temp[temp_head++] = i;//å¯»æ‰¾æ˜¯å¦æœ‰ç©ºé—²çº¿ç¨‹,å¦‚æœæœ‰ï¼Œåˆ™ä¿å­˜çº¿ç¨‹ç´¢å¼• thd_vld = 1; &#125; else &#123;//å¯¹äºéç©ºé—²çº¿ç¨‹ thds[i].wait_tick--;//æ¯ä¸ªçº¿ç¨‹çš„ç­‰å¾…æ—¶é—´-1ms &#125; &#125; &#125; //printf(&quot;dd\\n\\n&quot;); if (thd_vld)break; delayms(1);//å¦‚æœæ²¡æœ‰ç©ºé—²çº¿ç¨‹ï¼Œåˆ™ç­‰å¾…1ms &#125; //å¯¹å¯ç”¨çº¿ç¨‹çš„ç­‰çº§è¿›è¡Œä»å°åˆ°å¤§æ’åº for (int i = 0;i &lt; temp_head - 1;i++) &#123; for (int j = 0;j &lt; temp_head - 1 - i;j++) &#123; if (thds[thds_temp[j]].pri &gt; thds[thds_temp[j + 1]].pri) &#123; int t = thds_temp[j]; thds_temp[j] = thds_temp[j + 1]; thds_temp[j + 1] = t; &#125; else if (thds[thds_temp[j]].pri == thds[thds_temp[j + 1]].pri) &#123; if (mtime_hi() % 2) &#123;//å¦‚æœæœ‰ç›¸åŒçš„åˆ™éšæœºäº¤æ¢ int t = thds_temp[j]; thds_temp[j] = thds_temp[j + 1]; thds_temp[j + 1] = t; &#125; &#125; &#125; &#125; //å–å‡ºæ ˆé¡¶ç´¢å¼• thd_ptr = thds_temp[0]; //å½“å‰çº¿ç¨‹è¢«æ‰§è¡Œï¼Œé‡æ–°è®¾ç½®ä¼˜å…ˆçº§ thds[thd_ptr].pri = thds[thd_ptr].re_pri; //å…¶å®ƒæœªæ‰§è¡Œçš„çº¿ç¨‹ä¼˜å…ˆçº§å¢åŠ  for (int i = 1;i &lt; temp_head;i++) &#123; thds[thds_temp[i]].pri--; &#125; //printf(&quot;p%d\\n\\n&quot;, thd_ptr); //åˆ‡æ¢åˆ°é€‰ä¸­çš„çº¿ç¨‹ asm volatile(&quot;mv x30,%0&quot;::&quot;r&quot;(thds[thd_ptr].sp)); asm volatile(&quot;mv x31,%0&quot;::&quot;r&quot;(thds[thd_ptr].fp));&#125; ç”±äºåªæ˜¯ç®€å•çš„å®éªŒï¼Œæ‰€ä»¥çº¿ç¨‹è°ƒåº¦å¹¶æ²¡æœ‰é‡‡ç”¨å¤æ‚çš„ç®—æ³• ä»…åšå‚è€ƒ å®Œæ•´é¡¹ç›®ç‚¹æˆ‘","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://tastynoob.github.io/categories/%E6%A1%86%E6%9E%B6/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"},{"name":"ç³»ç»Ÿ","slug":"ç³»ç»Ÿ","permalink":"https://tastynoob.github.io/tags/%E7%B3%BB%E7%BB%9F/"}]},{"title":"longan-gd32v vscodeç¯å¢ƒé…ç½®","slug":"longan1","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.132Z","comments":true,"path":"1970/01/01/longan1/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/longan1/","excerpt":"longan-gd32v vscodeç¯å¢ƒé…ç½®","text":"longan-gd32v vscodeç¯å¢ƒé…ç½® é¦–å…ˆä½ è¦åœ¨vscodeå®˜ç½‘ä¸‹è½½vscodeæœ€æ–°ç‰ˆ å®‰è£…å®Œæˆåï¼Œç‚¹å‡»å³ä¾§çš„æ’ä»¶æ  æœç´¢ â€œEIDEâ€ æ’ä»¶ ç‚¹å‡»å®‰è£…å³å¯ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦.netç¯å¢ƒæ”¯æŒ å¦å¤–è¿˜éœ€è¦è¾…åŠ©æ’ä»¶ â€œc&#x2F;c++â€,æœç´¢å®‰è£…å³å¯ é‡å¯vscode vscodeä¾§è¾¹æ å°±ä¼šå‡ºç°eideå›¾æ ‡ï¼Œç‚¹å‡» ä½ éœ€è¦æŒ‡å®šç¼–è¯‘å™¨æ‰èƒ½å®ç°å¯¹é¡¹ç›®çš„ç¼–è¯‘å¦‚æœä½ æ²¡æœ‰é€‰æ‹©ä»»ä½•å·¥å…·é“¾ï¼Œé‚£ä¹ˆâ€œè®¾ç½®å·¥å…·é“¾è·¯å¾„â€çš„å›¾æ ‡æ˜¯ä¸€ä¸ªçº¢è‰²å‰å‰ç‚¹å‡»è®¾ç½®å·¥å…·é“¾è·¯å¾„å®ƒä¼šè¦æ±‚ä½ é€‰æ‹©å¦‚ä¸‹ç¼–è¯‘å™¨æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥é€‰æ‹©ç¼–è¯‘å™¨è·¯å¾„è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è®¾ç½®riscv gccè·¯å¾„ gd32 gccå·¥å…·é“¾å¯ä»¥åœ¨æ­¤åœ°å€ä¸‹è½½ ä¸‹è½½xpack-riscv-none-embed-gccå·¥å…·é“¾ è§£å‹ åœ¨eideæ’ä»¶é‡Œé€‰æ‹©riscvå·¥å…·é“¾è·¯å¾„ è·¯å¾„å³riscv gccå®‰è£…æ ¹ç›®å½• æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ–°å»ºé¡¹ç›® EIDEæ’ä»¶å·²ç»ä¸ºä½ æå‰å‡†å¤‡å¥½äº†longan gd32vçš„å¼€å‘æ¨¡æ¿ åœ¨EIDEæ’ä»¶ä¸­é€‰æ‹©æ–°å»ºé¡¹ç›® é€‰æ‹©å†…ç½®é¡¹ç›®æ¨¡æ¿ï¼Œå¾€ä¸‹æ‹‰ é€‰æ‹©æ–°å»ºgd32vfé¡¹ç›®æ¨¡æ¿ å¦‚æœé…ç½®æ— è¯¯ï¼Œå³å¯çœ‹åˆ°1å¦‚ä¸‹ç•Œé¢ æŒ‰ä¸‹F7è¿›è¡Œç¼–è¯‘ ç‚¹å‡»ä¾§è¾¹æ EIDEæ’ä»¶ï¼Œå°±å¯ä»¥çœ‹åˆ°å½“å‰é¡¹ç›®çš„ä¿¡æ¯ ![_&#96;RU_VE_4BN7_6PB0__XSJK.png](https://i.loli.net/2021/06/17/LYx9hUIPpbfjslg.png) ä½ å¯å¯¹è¯¥é¡¹ç›®çš„å¤´æ–‡ä»¶åŒ…å«è·¯å¾„ï¼Œæºæ–‡ä»¶åŒ…å«è·¯å¾„è¿›è¡Œæ›´æ”¹ æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹æ„‰å¿«çš„å¼€å‘äº†","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"},{"name":"vscode","slug":"vscode","permalink":"https://tastynoob.github.io/tags/vscode/"}]},{"title":"åšå®¢æµ‹è¯•","slug":"test","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.132Z","comments":true,"path":"1970/01/01/test/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/test/","excerpt":"ç¬¬ä¸€æ¬¡å†™åšå®¢ï¼Œè¿™ç¯‡åšå®¢å°±å½“ä¸ªæµ‹è¯•ï¼Œè°ƒè¯•äº†ä¸€å¤©æ‰è°ƒå¥½çš„ï¼Œä¹Ÿç®—æ˜¯åšä¸ªçºªå¿µ","text":"ç¬¬ä¸€æ¬¡å†™åšå®¢ï¼Œè¿™ç¯‡åšå®¢å°±å½“ä¸ªæµ‹è¯•ï¼Œè°ƒè¯•äº†ä¸€å¤©æ‰è°ƒå¥½çš„ï¼Œä¹Ÿç®—æ˜¯åšä¸ªçºªå¿µ 1234#include &lt;stdio.h&gt;int main()&#123; printf(&quot;hello blog!&quot;);&#125;","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://tastynoob.github.io/tags/test/"}]},{"title":"ç¥ç»ç½‘ç»œé£æ ¼è¿ç§»","slug":"å›¾åƒé£æ ¼è¿ç§»","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.164Z","comments":true,"path":"1970/01/01/å›¾åƒé£æ ¼è¿ç§»/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E5%9B%BE%E5%83%8F%E9%A3%8E%E6%A0%BC%E8%BF%81%E7%A7%BB/","excerpt":"é«˜ä¸­æ—¶ç©äººå·¥æ™ºèƒ½å‘ç°çš„å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿","text":"é«˜ä¸­æ—¶ç©äººå·¥æ™ºèƒ½å‘ç°çš„å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ ä»£ç åŸºäºtensorflowå®˜æ–¹æ–‡æ¡£ï¼Œä¸Šä»£ç ï¼éœ€è¦ä½¿ç”¨VGG19tensorflow2.0ä»¥ä¸Š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188from __future__ import absolute_import, division, print_function, unicode_literalsimport tensorflow as tfimport matplotlib.pyplot as pltimport matplotlib as mplfrom tqdm import trangesteps = 100style_weight = 1e-2content_weight = 1e4total_variation_weight = 1e8mpl.rcParams[&#x27;figure.figsize&#x27;] = (13, 10)mpl.rcParams[&#x27;axes.grid&#x27;] = False# è·å–ä¸‹è½½åæœ¬åœ°å›¾ç‰‡çš„è·¯å¾„ï¼Œcontent_pathæ˜¯çœŸå®ç…§ç‰‡ï¼Œstyle_pathæ˜¯é£æ ¼å›¾ç‰‡content_path = &#x27;content.jpg&#x27;style_path = &#x27;style.jpg&#x27;# è¯»å–ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶åšé¢„å¤„ç†def load_img(path_to_img): max_dim = 600 # è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ img = tf.io.read_file(path_to_img) # åšJPEGè§£ç ï¼Œå¾—åˆ°å®½xé«˜xè‰²æ·±çŸ©é˜µï¼ŒèŒƒå›´0-255 img = tf.image.decode_jpeg(img) # ç±»å‹ä»intè½¬æ¢åˆ°32ä½æµ®ç‚¹ï¼Œæ•°å€¼èŒƒå›´0-1 img = tf.image.convert_image_dtype(img, tf.float32) # å‡æ‰æœ€åè‰²æ·±ä¸€ç»´ï¼Œè·å–åˆ°çš„ç›¸å½“äºå›¾ç‰‡å°ºå¯¸ï¼ˆæ•´æ•°ï¼‰ï¼Œè½¬ä¸ºæµ®ç‚¹ shape = tf.cast(tf.shape(img)[:-1], tf.float32) # è·å–å›¾ç‰‡é•¿ç«¯ long = max(shape) # ä»¥é•¿ç«¯ä¸ºæ¯”ä¾‹ç¼©æ”¾ scale = max_dim/long new_shape = tf.cast(shape*scale, tf.int32) # å®é™…ç¼©æ”¾å›¾ç‰‡ img = tf.image.resize(img, new_shape) # å†æ‰©å±•ä¸€ç»´ï¼Œæˆä¸ºå›¾ç‰‡æ•°å­—ä¸­çš„ä¸€å¼ å›¾ç‰‡ï¼ˆ1ï¼Œé•¿ï¼Œå®½ï¼Œè‰²æ·±ï¼‰ img = img[tf.newaxis, :] return img# è¯»å…¥ä¸¤å¼ å›¾ç‰‡content_image = load_img(content_path)style_image = load_img(style_path)############################################################# å®šä¹‰æœ€èƒ½ä»£è¡¨å†…å®¹ç‰¹å¾çš„ç½‘ç»œå±‚content_layers = [&#x27;block5_conv2&#x27;] # å®šä¹‰æœ€èƒ½ä»£è¡¨é£æ ¼ç‰¹å¾çš„ç½‘ç»œå±‚style_layers = [&#x27;block1_conv1&#x27;, &#x27;block2_conv1&#x27;, &#x27;block3_conv1&#x27;, &#x27;block4_conv1&#x27;, &#x27;block5_conv1&#x27;]# ç¥ç»ç½‘ç»œå±‚çš„æ•°é‡num_content_layers = len(content_layers)num_style_layers = len(style_layers)# å®šä¹‰ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼Œå¸®åŠ©å»ºç«‹å¾—åˆ°ç‰¹å®šä¸­é—´å±‚è¾“å‡ºç»“æœçš„æ–°æ¨¡å‹def vgg_layers(layer_names): &quot;&quot;&quot; Creates a vgg model that returns a list of intermediate output values.&quot;&quot;&quot; # å®šä¹‰ä½¿ç”¨ImageNetæ•°æ®è®­ç»ƒçš„vgg19ç½‘ç»œ vgg = tf.keras.applications.VGG19(include_top=False, weights=&#x27;imagenet&#x27;) # å·²ç»ç»è¿‡äº†è®­ç»ƒï¼Œæ‰€ä»¥é”å®šå„é¡¹å‚æ•°é¿å…å†æ¬¡è®­ç»ƒ vgg.trainable = False # è·å–æ‰€éœ€å±‚çš„è¾“å‡ºç»“æœ outputs = [vgg.get_layer(name).output for name in layer_names] # æœ€ç»ˆè¿”å›ç»“æœæ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œè¾“å…¥æ˜¯å›¾ç‰‡ï¼Œè¾“å‡ºä¸ºæ‰€éœ€çš„ä¸­é—´å±‚è¾“å‡º model = tf.keras.Model([vgg.input], outputs) return modeldef gram_matrix(input_tensor): result = tf.linalg.einsum(&#x27;bijc,bijd-&gt;bcd&#x27;, input_tensor, input_tensor) input_shape = tf.shape(input_tensor) num_locations = tf.cast(input_shape[1]*input_shape[2], tf.float32) return result/(num_locations)# è‡ªå®šä¹‰kerasæ¨¡å‹class StyleContentModel(tf.keras.models.Model): def __init__(self, style_layers, content_layers): super(StyleContentModel, self).__init__() # è‡ªå·±çš„vggæ¨¡å‹ï¼ŒåŒ…å«ä¸Šé¢æ‰€åˆ—çš„é£æ ¼æŠ½å–å±‚å’Œå†…å®¹æŠ½å–å±‚ self.vgg = vgg_layers(style_layers + content_layers) self.style_layers = style_layers self.content_layers = content_layers self.num_style_layers = len(style_layers) # vggå„å±‚å‚æ•°é”å®šä¸å†å‚æ•°è®­ç»ƒ self.vgg.trainable = False def call(self, input): # è¾“å…¥çš„å›¾ç‰‡æ˜¯0-1èŒƒå›´æµ®ç‚¹ï¼Œè½¬æ¢åˆ°0-255ä»¥ç¬¦åˆvggè¦æ±‚ input = input*255.0 # å¯¹è¾“å…¥å›¾ç‰‡æ•°æ®åšé¢„å¤„ç† preprocessed_input = tf.keras.applications.vgg19.preprocess_input(input) # è·å–é£æ ¼å±‚å’Œå†…å®¹å±‚è¾“å‡º outputs = self.vgg(preprocessed_input) # è¾“å‡ºå®é™…æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‹†åˆ†ä¸ºé£æ ¼è¾“å‡ºå’Œå†…å®¹è¾“å‡º style_outputs, content_outputs = ( outputs[:self.num_style_layers], outputs[self.num_style_layers:]) # è®¡ç®—é£æ ¼çŸ©é˜µ style_outputs = [gram_matrix(style_output) for style_output in style_outputs] # è½¬æ¢ä¸ºå­—å…¸ content_dict = &#123;content_name: value for content_name, value in zip(self.content_layers, content_outputs)&#125; # è½¬æ¢ä¸ºå­—å…¸ style_dict = &#123;style_name: value for style_name, value in zip(self.style_layers, style_outputs)&#125; # è¿”å›å†…å®¹å’Œé£æ ¼ç»“æœ return &#123;&#x27;content&#x27;: content_dict, &#x27;style&#x27;: style_dict&#125;# ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹å»ºç«‹ä¸€ä¸ªæŠ½å–å™¨extractor = StyleContentModel(style_layers, content_layers)# è®¾å®šé£æ ¼ç‰¹å¾çš„ç›®æ ‡ï¼Œå³æœ€ç»ˆç”Ÿæˆçš„å›¾ç‰‡ï¼Œå¸Œæœ›é£æ ¼ä¸Šå°½é‡æ¥è¿‘é£æ ¼å›¾ç‰‡style_targets = extractor(style_image)[&#x27;style&#x27;]# è®¾å®šå†…å®¹ç‰¹å¾çš„ç›®æ ‡ï¼Œå³æœ€ç»ˆç”Ÿæˆçš„å›¾ç‰‡ï¼Œå¸Œæœ›å†…å®¹ä¸Šå°½é‡æ¥è¿‘å†…å®¹å›¾ç‰‡content_targets = extractor(content_image)[&#x27;content&#x27;]# å†…å®¹å›¾ç‰‡è½¬æ¢ä¸ºå¼ é‡image = tf.Variable(content_image)# æˆªå–0-1çš„æµ®ç‚¹æ•°ï¼Œè¶…èŒƒå›´éƒ¨åˆ†è¢«æˆªå–def clip_0_1(image): return tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=1.0)# ä¼˜åŒ–å™¨opt = tf.optimizers.Adam(learning_rate=0.02, beta_1=0.99, epsilon=1e-1)# é¢„å®šä¹‰é£æ ¼å’Œå†…å®¹åœ¨æœ€ç»ˆç»“æœä¸­çš„æƒé‡å€¼ï¼Œç”¨äºåœ¨æŸå¤±å‡½æ•°ä¸­è®¡ç®—æ€»æŸå¤±å€¼# æŸå¤±å‡½æ•°def style_content_loss(outputs): style_outputs = outputs[&#x27;style&#x27;] content_outputs = outputs[&#x27;content&#x27;] # é£æ ¼æŸå¤±å€¼ï¼Œå°±æ˜¯è®¡ç®—æ–¹å·® style_loss = tf.add_n([tf.reduce_mean((style_outputs[name]-style_targets[name])**2) for name in style_outputs.keys()]) # æƒé‡å€¼å¹³å‡åˆ°æ¯å±‚ï¼Œè®¡ç®—æ€»ä½“é£æ ¼æŸå¤±å€¼ style_loss *= style_weight/num_style_layers # å†…å®¹æŸå¤±å€¼ï¼Œä¹Ÿæ˜¯è®¡ç®—æ–¹å·® content_loss = tf.add_n([tf.reduce_mean((content_outputs[name]-content_targets[name])**2) for name in content_outputs.keys()]) content_loss *= content_weight/num_content_layers # æ€»æŸå¤±å€¼ loss = style_loss+content_loss return loss###################################################def high_pass_x_y(image): x_var = image[:, :, 1:, :] - image[:, :, :-1, :] y_var = image[:, 1:, :, :] - image[:, :-1, :, :] return x_var, y_var# è®¡ç®—æ€»ä½“å˜åˆ†æŸå¤±def total_variation_loss(image): x_deltas, y_deltas = high_pass_x_y(image) return tf.reduce_mean(x_deltas**2)+tf.reduce_mean(y_deltas**2)@tf.function() def train_step(image): with tf.GradientTape() as tape: outputs = extractor(image) loss = style_content_loss(outputs) loss += total_variation_weight*total_variation_loss(image) grad = tape.gradient(loss, image) opt.apply_gradients([(grad, image)]) image.assign(clip_0_1(image))image = tf.Variable(content_image)for n in trange(steps): train_step(image)plt.imshow(image.read_value()[0])","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"å¦‚ä½•ä½¿ç”¨vscodeèˆ’é€‚çš„å¼€å‘åµŒå…¥å¼","slug":"vscodeEIDE","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.133Z","comments":true,"path":"1970/01/01/vscodeEIDE/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/vscodeEIDE/","excerpt":"æƒ³å¿…ç”¨è¿‡keilçš„éƒ½ä¼šè¢«keilç³Ÿç³•çš„ç¼–è¾‘ä½“éªŒå’Œé—ªççœ¼çš„ç•Œé¢æŠ˜ç£¨è¿‡ä½¿ç”¨vscodeå¼€å‘ç¯å¢ƒåˆéš¾é…ç½®é‚£ä¹ˆè¿™é‡Œå°±æ¥å®‰åˆ©ä¸€æ¬¾ååˆ†å¥½ç”¨ï¼ŒåŠŸèƒ½å¼ºå¤§çš„æ’ä»¶â€“EIDE","text":"æƒ³å¿…ç”¨è¿‡keilçš„éƒ½ä¼šè¢«keilç³Ÿç³•çš„ç¼–è¾‘ä½“éªŒå’Œé—ªççœ¼çš„ç•Œé¢æŠ˜ç£¨è¿‡ä½¿ç”¨vscodeå¼€å‘ç¯å¢ƒåˆéš¾é…ç½®é‚£ä¹ˆè¿™é‡Œå°±æ¥å®‰åˆ©ä¸€æ¬¾ååˆ†å¥½ç”¨ï¼ŒåŠŸèƒ½å¼ºå¤§çš„æ’ä»¶â€“EIDE é¦–å…ˆï¼Œä½ å¾—è¦æœ‰vscodeï¼Œvscodeå¯ä»¥å»å¾®è½¯å®˜ç½‘ä¸‹è½½ç‚¹å‡»è¿™é‡Œ ç„¶ååœ¨æ’ä»¶æœç´¢æ¡†å†…æœç´¢â€EIDEâ€å’Œâ€œC++â€ c++æ’ä»¶ä¸éœ€å¤šè¯´æä¾›äº†c&#x2F;c++çš„è‡ªåŠ¨è¡¥å…¨ï¼Œè·³è½¬ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ç­‰å¼ºå¤§åŠŸèƒ½ é‡ç‚¹åœ¨äºEIDEæ’ä»¶ è£…å¥½åå®ƒå¯èƒ½ä¼šæç¤ºä½ éœ€è¦.netæ¡†æ¶ï¼Œå®‰è£…å³å¯ï¼Œå®‰è£…å®Œæˆåé‡å¯ä¸€æ¬¡ç”µè„‘é‡æ–°æ‰“å¼€vscodeå³å¯ ç‚¹å‡»ä¾§è¾¹æ çš„EIDEæ’ä»¶ ä½ éœ€è¦æŒ‡å®šç¼–è¯‘å™¨æ‰èƒ½å®ç°å¯¹é¡¹ç›®çš„ç¼–è¯‘å¦‚æœä½ æ²¡æœ‰é€‰æ‹©ä»»ä½•å·¥å…·é“¾ï¼Œé‚£ä¹ˆâ€œè®¾ç½®å·¥å…·é“¾è·¯å¾„â€çš„å›¾æ ‡æ˜¯ä¸€ä¸ªçº¢è‰²å‰å‰ç‚¹å‡»è®¾ç½®å·¥å…·é“¾è·¯å¾„å®ƒä¼šè¦æ±‚ä½ é€‰æ‹©å¦‚ä¸‹ç¼–è¯‘å™¨æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥é€‰æ‹©ç¼–è¯‘å™¨è·¯å¾„å¦‚æœä½ ä½¿ç”¨keilå¼€å‘51é‚£ä¹ˆå¯ä»¥é€‰æ‹© keil c51å·¥å…·é“¾è·¯å¾„ ç‚¹å‡» â€œkeil c51â€é€‰æ‹©ä½ å®‰è£…keilc51è·¯å¾„ä¸‹çš„TOOLS.INIæ–‡ä»¶ å¦‚æœä½ æ­£ç¡®å®‰è£…äº†keilc51å¹¶ä¸”vscodeæ²¡æœ‰é…ç½®é”™çš„è¯é‚£ä¹ˆâ€œè®¾ç½®å·¥å…·é“¾è·¯å¾„â€çš„å›¾æ ‡å°±ä¼šå˜æˆå’Œæˆ‘ä¸€æ ·çš„é»„è‰²æ„Ÿå¹å· æ¥ä¸‹æ¥åˆ›å»ºæ–°é¡¹ç›®ç‚¹å‡»æ–°å»ºé¡¹ç›®ä½ å¯ä»¥é€‰æ‹©é¡¹ç›®çš„åˆ›å»ºæ–¹å¼ å†…ç½®æ¨¡æ¿é¡¹ç›®æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯å¸¸ç”¨ä¹Ÿå¯ä»¥ä»è¿œç¨‹ä»“åº“é€‰æ‹©ä½ æƒ³è¦çš„æ¨¡æ¿æˆ–è€…è‡ªå·±åˆ›å»ºç©ºé¡¹ç›®ï¼Œè‡ªå·±é…ç½® ç”Ÿæˆå¥½é¡¹ç›®åå°±å¦‚å›¾æ‰€ç¤º å³è¾¹æ˜¯ä½ çš„å·¥ä½œåŒºsrcæ–‡ä»¶å¤¹å°±æ˜¯å­˜æ”¾ä½ çš„ä»£ç çš„åŒºåŸŸ.vscodeå’Œ.eideæ–‡ä»¶å¤¹æ˜¯é¡¹ç›®é…ç½®æ–‡ä»¶å¤¹ï¼Œä¸å¯ä¿®æ”¹ æŒ‰F7å³å¯å¼€å§‹ç¼–è¯‘ ç‚¹å‡»ä¾§è¾¹æ çš„EIDEæ’ä»¶å›¾æ ‡ å³å¯çœ‹ä½ é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ ä½ å¯ä»¥é…ç½®é¡¹ç›®çš„ç¼–è¯‘æ¡ä»¶å’Œçƒ§å½•å™¨ åŒæ ·å¯ä»¥è®¾ç½®51çš„ç¼–è¯‘ä¼˜åŒ–ç­‰çº§ å‡ ä¹å’Œkeilä¸€æ¨¡ä¸€æ · ä½†æ˜¯vscodeæ‹¥æœ‰æ›´é«˜çš„æ€§èƒ½å’Œæ›´èˆ’é€‚çš„å¼€å‘ä½“éªŒ å¦å¤–ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨EIDEå¼€å‘K210 é¦–å…ˆä½ éœ€è¦ä¸‹è½½å®˜æ–¹riscvç¼–è¯‘å™¨å¹¶åœ¨EIDEé‡Œæ·»åŠ ä½ çš„riscvç¼–è¯‘å™¨è·¯å¾„ ç”±äºk210çš„riscvç¼–è¯‘å™¨æ˜¯ç»è¿‡è°ƒæ•´çš„ï¼Œå› æ­¤éœ€è¦é¢å¤–å¯¹EIDEæ’ä»¶çš„ä¸€äº›è®¾ç½®è¿›è¡Œä¿®æ”¹ æ‰“å¼€EIDEæ’ä»¶è®¾ç½®ï¼Œæ‰¾åˆ°â€œEIDE.RISCV: Tool Prefixâ€é€‰é¡¹ å°†ç¼–è¯‘å™¨å‰ç¼€ä¿®æ”¹ä¸ºâ€œriscv64-unknown-elf-â€ è¿™æ˜¯k210 riscvç¼–è¯‘å™¨çš„å‰ç¼€åç§° åœ¨ç¼–è¯‘å™¨ç›®å½•ä¸‹å¯çœ‹åˆ°ï¼Œæ³¨æ„å®Œæ•´çš„ç¼–è¯‘å™¨å‰ç¼€è¿˜è¦åŠ ä¸€æ¨ª ç„¶ååœ¨EIDEä¸­æ–°å»ºé¡¹ç›® é€‰æ‹©â€œä»è¿œç¨‹ä»“åº“æ‹‰å–â€ æ‰¾åˆ°k210æ¨¡æ¿ï¼Œé€‰æ‹©å³å¯ æ–°å»ºé¡¹ç›®å®Œæˆåå¦‚å›¾æ‰€ç¤º è¿™é‡Œéœ€è¦æ·»åŠ è™šæ‹Ÿæ–‡ä»¶å¤¹ï¼Œå°†srcæ–‡ä»¶é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›å» å¦åˆ™æ·»åŠ æ–°æ–‡ä»¶æ—¶ï¼Œæ— æ³•æ­£å¸¸ç¼–è¯‘ è‡³æ­¤ï¼ŒEIDEæ’ä»¶çš„k210å¼€å‘ç¯å¢ƒé…ç½®å®Œæˆç”¨æˆ·æƒ³è¦æ·»åŠ ä»€ä¹ˆæ–‡ä»¶å°±å‘srcæ–‡ä»¶å¤¹é‡Œæ·»åŠ  é™¤æ­¤ä¹‹å¤–EIDEæ’ä»¶è¿˜æ”¯æŒarmï¼Œæ¶æ„å¤„ç†å™¨æ›´å¤šåŠŸèƒ½æ­£åœ¨å¼€å‘ å°±æˆ‘ä¸ªäººæ¥è¯´å¼€å‘51,stm32ï¼Œk210ç­‰ä¸»æµèŠ¯ç‰‡å®Œå…¨æ²¡æœ‰é—®é¢˜ä½ å¯ä»¥è‡ªå®šä¹‰ä¸»å›¾ï¼Œè‡ªå®šä¹‰èƒŒæ™¯äº«å—æ›´å¥½çš„å¼€å‘ç¯å¢ƒæ‹¥æœ‰æ›´é«˜çš„å¼€å‘é€Ÿåº¦å’Œå¼€å‘è´¨é‡ æ”¹æ’ä»¶ç”±å›½å†…å¤§ç¥å¼€å‘ï¼Œå¹¶æ‹¥æœ‰ç‹¬ç«‹çš„è®ºå›å’Œqqç¾¤å¯ä¾›ç©è€å¦å¤–è¿˜æœ‰è¯¦ç»†çš„æ’ä»¶æ–‡æ¡£ç‚¹å‡»è¿™é‡Œ","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"vscode","slug":"vscode","permalink":"https://tastynoob.github.io/tags/vscode/"}]},{"title":"å¤šçº¿ç¨‹æ“ä½œç³»ç»ŸåŸç†","slug":"å¤šçº¿ç¨‹æ“ä½œç³»ç»ŸåŸç†","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.165Z","comments":true,"path":"1970/01/01/å¤šçº¿ç¨‹æ“ä½œç³»ç»ŸåŸç†/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/","excerpt":"è®ºå¤šçº¿ç¨‹æ˜¯å¦‚ä½•å®ç°çš„åŸºäºarmå†…æ ¸","text":"è®ºå¤šçº¿ç¨‹æ˜¯å¦‚ä½•å®ç°çš„åŸºäºarmå†…æ ¸ åœ¨è£¸æœºç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªä¸»çº¿ç¨‹å’Œå¤šä¸ªå­çº¿ç¨‹ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå‡½æ•°æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬è‡ªçš„æ ˆåŒºä¸ä»£ç åŒº å½“ä½¿ç”¨å•æ ¸cpuæ—¶ä¸ºäº†ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½æ‰§è¡Œå› æ­¤cpué‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„æœºåˆ¶æ¥åˆ‡æ¢çº¿ç¨‹å³åˆ†é…ç»™æ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªæ—¶é—´ç‰‡è¯¥çº¿ç¨‹çš„è¿è¡Œæ—¶é—´ç»“æŸåï¼Œå³åˆ‡æ¢æ ˆåŒºå’Œä»£ç åŒºè¿›è¡Œçº¿ç¨‹åˆ‡æ¢æ­¤æ—¶ä¸ºä¸²è¡Œçº¿ç¨‹è¿™é‡Œä½¿ç”¨æ±‡ç¼–æ¥å®ç°ç®€å•çš„çº¿ç¨‹åˆ‡æ¢ 123456789101112131415///ä¿å­˜å½“å‰çº¿ç¨‹///è°ƒç”¨è¯¥å‡½æ•°æ—¶ä¼šå°†è°ƒç”¨å¤„çš„pcå€¼ä¿å­˜è¿›lrå¯„å­˜å™¨__asm void Save()&#123;push &#123;r0-r14&#125;;å°†å½“å‰æ‰€æœ‰å¯„å­˜å™¨ä¿å­˜è¿›å½“å‰æ ˆåŒºï¼ŒåŒ…æ‹¬lr,spmov sp,stack;å°†spæ ˆå¯„å­˜å™¨å†™ä¸ºç›¸åº”çº¿ç¨‹çš„æ ˆåŒºbx func;è·³è½¬åˆ°ç›¸åº”çº¿ç¨‹çš„æ‰§è¡Œä»£ç åŒº&#125;//åŠ è½½çº¿ç¨‹__asm void Load()&#123;mov sp,stack;å°†spæ ˆå¯„å­˜å™¨å†™ä¸ºç›¸åº”çº¿ç¨‹çš„æ ˆåŒºpop &#123;r0-r14&#125;;å°†ä¸‹ä¸ªçº¿ç¨‹æ ˆåŒºä¸­ä¿å­˜çš„å¯„å­˜å™¨å€¼è¿˜åŸbx lr;å›åˆ°ä¹‹å‰è°ƒç”¨ä¿å­˜çº¿ç¨‹å‡½æ•°çš„åœ°æ–¹å¾€ä¸‹æ‰§è¡Œ&#125; åœ¨å®é™…åº”ç”¨å½“ä¸­è‚¯å®šä¸ä¼šåªæœ‰è¿™ä¹ˆç®€å•çš„ä»£ç å®é™…ä¸Šï¼Œè¦è€ƒè™‘åˆ°æ¯ä¸ªçº¿ç¨‹çš„é‡è¦æ€§å’Œè¿è¡Œæ—¶æ®µï¼Œå³çº¿ç¨‹ä¼˜å…ˆçº§å’Œçº¿ç¨‹ç¡çœ  ä¾‹å¦‚ï¼š 1234567891011çº¿ç¨‹1è¿è¡Œ1msçº¿ç¨‹1ç¡çœ 10ms çº¿ç¨‹2è¿è¡Œ2ms çº¿ç¨‹2ç¡çœ 2ms çº¿ç¨‹3è¿è¡Œ2ms çº¿ç¨‹3ç¡çœ 2ms çº¿ç¨‹2è¿è¡Œ2ms çº¿ç¨‹2ç¡çœ 4ms çº¿ç¨‹3è¿è¡Œ4ms çº¿ç¨‹3ç¡çœ 5msçº¿ç¨‹1è¿è¡Œ.... å¦‚æ­¤å¾€å¤ ç°åœ¨æˆ‘å·²ç»åœ¨riscvå¹³å°ä¸Šå¼€å‘äº†ä¸€ä¸ªå¤šçº¿ç¨‹ç³»ç»Ÿï¼Œå…·ä½“å¯å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼šåŸºäºriscvçš„çœŸå¤šçº¿ç¨‹ç³»ç»Ÿ","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"ç³»ç»Ÿ","slug":"ç³»ç»Ÿ","permalink":"https://tastynoob.github.io/tags/%E7%B3%BB%E7%BB%9F/"}]},{"title":"å¹³è¡¡å°è½¦åˆ¶ä½œ","slug":"å¹³è¡¡å°è½¦åˆ¶ä½œ","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.166Z","comments":true,"path":"1970/01/01/å¹³è¡¡å°è½¦åˆ¶ä½œ/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E5%B9%B3%E8%A1%A1%E5%B0%8F%E8%BD%A6%E5%88%B6%E4%BD%9C/","excerpt":"emmmm,å­¦æ ¡å·¥ä½œå®¤å¯’å‡ç­”è¾©ä½œå“è®¾è®¡","text":"emmmm,å­¦æ ¡å·¥ä½œå®¤å¯’å‡ç­”è¾©ä½œå“è®¾è®¡ è€è§„çŸ©ï¼Œä¸åºŸè¯ ææ–™: 2ä¸ªç¼–ç ç”µæœº çº¯æ‰‹å·¥æ‰“ç£¨(é›¾)æœ¨æ¿ä¸€å— stm32f1æ ¸å¿ƒæ¿ä¸€å— ESP8266-1sä¸€å— GY521ä¸€å— é”‚ç”µæ± 2ä¸ª ç¨³å‹æ¨¡å—ä¸€ä¸ª é©±åŠ¨æ¨¡å—ä¸€ä¸ª ç®—æ³•éœ€æ±‚: PIDæ§åˆ¶ ESP8266é€šä¿¡ MPU6050è¯»å– å¹³è¡¡å°è½¦çš„åŸç†å®é™…ä¸Šå¾ˆç®€å•æ— éå°±ä¸€ä¸ªé“ç†ï¼šä½ å‰å€¾æˆ‘å°±å¾€å‰åŠ é€Ÿï¼Œåå€¾å°±å¾€ååŠ é€Ÿç”µæœºæ§åˆ¶ä½¿ç”¨PWMæ§åˆ¶ å¹³è¡¡å°è½¦éœ€è¦ä½¿ç”¨åˆ°3ä¸ªæ§åˆ¶ç¯ï¼šåˆ†åˆ«æ˜¯å¹³è¡¡ç¯ï¼Œé€Ÿåº¦ç¯ï¼Œè½¬å‘æ¢æ¥ä¸‹æ¥ä»‹ç»PIDç®—æ³•æ­¤å¤„åªä»‹ç»ç®—æ³•çš„ç®€ä¾¿å½¢å¼ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šåšæ”¹è¿› é¦–å…ˆ3ä¸ªæ§åˆ¶ç¯è´Ÿè´£è”åˆæ§åˆ¶å¹³è¡¡è½¦çš„å·¦å³ä¸¤ä¸ªè½®å­3ä¸ªæ§åˆ¶æ¢å¯å¾—åˆ°3ä¸ªå€¼:dc_balance,dc_speed,dc_turn å·¦å³2ä¸ªç”µæœºPWMå ç©ºæ¯”dc_left&#x3D;dc_balance+dc_speed+dc_turndc_right&#x3D;dc_balance+dc_speed-dc_turn å¹³è¡¡ç¯: 1234error = angle_this-angle_balanceerror_integral+=errorgyro = getGyro(tilt)dc_balance=kp*error+ki*error_integral+kd*gyro é€Ÿåº¦ç¯ç¯: 123error = (speed_left+speed_right)-speed_pointerror_integral+=errordc_speed=kp*error+ki*error_integral è½¬å‘ç¯: 123turn = turn_pointgyro = getGyro(turn)dc_bturn=kp*turn+kd*gyro","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"}]},{"title":"ç”¨expressæ¡†æ¶è‡ªå·±è®¾è®¡webæœåŠ¡å™¨","slug":"ç”¨expressæ¡†æ¶è‡ªå·±è®¾è®¡webæœåŠ¡å™¨","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.166Z","comments":true,"path":"1970/01/01/ç”¨expressæ¡†æ¶è‡ªå·±è®¾è®¡webæœåŠ¡å™¨/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%94%A8express%E6%A1%86%E6%9E%B6%E8%87%AA%E5%B7%B1%E8%AE%BE%E8%AE%A1web%E6%9C%8D%E5%8A%A1%E5%99%A8/","excerpt":"ä½¿ç”¨nodejsçš„expressæ¡†æ¶æ­å»ºä¸€å°webæœåŠ¡å™¨","text":"ä½¿ç”¨nodejsçš„expressæ¡†æ¶æ­å»ºä¸€å°webæœåŠ¡å™¨ é¦–å…ˆè¦å®‰è£…expressæ¡†æ¶å‘½ä»¤è¡Œè¾“å…¥ 1npm install -g express ç­‰å¾…å®‰è£…å®Œæˆå³å¯è¿™é‡Œæ˜¯å…¨å±€å®‰è£…expressæ¡†æ¶éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡NODE_PATHå°†expressæ¨¡å—è·¯å¾„æ·»åŠ åˆ°NODE_PATHä¸­ å¦å¤–ï¼Œä½ éœ€è¦ç®€å•äº†è§£è·¯ç”±çš„æ¦‚å¿µæ¯”å¦‚ï¼šbaidu.com&#x2F;file&#x2F;2333.jpgå…¶ä¸­ â€œbaidu.comâ€æ˜¯hostâ€œ&#x2F;fileâ€æŒ‡çš„å°±æ˜¯è·¯ç”±ï¼Œç”±æœåŠ¡å™¨å¤„ç†ä½ éœ€è¦ç”³è¯·è®¿é—®çš„è·¯ç”±â€œ&#x2F;file&#x2F;2333.jpgâ€ éœ€è¦å°±æ˜¯è®¿é—®çš„é“¾æ¥ æ¥ä¸‹æ¥ï¼Œç›´æ¥ä¸Šä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384//å¯¼å…¥expressæ¨¡å—var express = require(&#x27;express&#x27;);var bodyParser = require(&#x27;body-parser&#x27;);var url = require(&#x27;url&#x27;);var app = express();// åˆ›å»º application/x-www-form-urlencoded ç¼–ç è§£ævar urlencodedParser = bodyParser.urlencoded(&#123; extended: false &#125;)//è¿™é‡Œæ˜¯æœåŠ¡å™¨å¤„ç†GETè¯·æ±‚çš„æ–¹æ³•//&#x27;*&#x27;ä»£è¡¨å¤„ç†ä»»ä½•GETé“¾æ¥//æ¯”å¦‚GET baidu.com/2333/ ,&quot;/2333/&quot;å°±ä¼šè¢«è¯¥getæ–¹æ³•æ‰€æ¥å—//åŒæ—¶ä¼ é€’ç›¸å…³å‚æ•°ç»™å›è°ƒå‡½æ•°app.get(&#x27;*&#x27;, function (req, res) &#123; //è§£æä¼ å…¥çš„è·¯ç”±é“¾æ¥ï¼Œå¦‚æœä¼ å…¥çš„é“¾æ¥åŒ…å«ä¸­æ–‡ï¼Œéœ€è¦ä½¿ç”¨URIåç¼–ç  var reqPath = decodeURI(url.parse(req.url).pathname); //è¾“å‡ºGETè¯·æ±‚å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œä»¥åŠé“¾æ¥ console.log(&#x27;GETè¯·æ±‚åœ°å€ï¼š&#x27; + req.ip.match(/\\d+\\.\\d+\\.\\d+\\.\\d+/) + &quot;;é“¾æ¥ï¼š&quot; + reqPath); //è¿™é‡Œåšä¸ªå°ç¤ºèŒƒ //å¦‚æœGET /file/çš„è¯ï¼Œå°±æŠŠæœ¬åœ°è·¯å¾„ä¸‹/file/index.htmlæ–‡ä»¶å‘é€ç»™å®¢æˆ·ç«¯ var filePath; if (reqPath.endsWith(&#x27;/&#x27;)) &#123; filePath = reqPath.substr(1) + &#x27;index.html&#x27;; if (fs.existsSync(filePath)) &#123; //è¯¥æ–¹æ³•å¯ç›´æ¥å‘é€æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ–‡æœ¬ï¼Œå›¾ç‰‡ç­‰... res.sendFile(filePath); &#125; else &#123;//å¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶ //è¯¥æ–¹æ³•ç›´æ¥å‘é€ç›®æ ‡æ•°æ® res.send(&quot;è®¿é—®é”™è¯¯ï¼ï¼&quot;); &#125; &#125; else &#123; filePath = __dirname + reqPath; if (fs.existsSync(filePath)) &#123; res.sendFile(filePath); &#125; else &#123; res.send(&quot;è®¿é—®é”™è¯¯ï¼ï¼&quot;); &#125; &#125;&#125;)//è¿™é‡Œæ˜¯å¤„ç†POSTè¯·æ±‚//&#x27;*&#x27;è¡¨ç¤ºå¤„ç†ä»»ä½•POSTé“¾æ¥//æ¯”å¦‚ POST /ADD/,é‚£ä¹ˆâ€œ/ADD/â€å°±ä¼šè¢«è¯¥æ–¹æ³•æ‰€æ¥å—//åŒæ—¶ä¼ é€’ç›¸å…³å‚æ•°ç»™å›è°ƒå‡½æ•°app.post(&#x27;*&#x27;, urlencodedParser, function (req, res) &#123; //è§£æPOSTé“¾æ¥ var reqPath = decodeURI(url.parse(req.url).pathname); console.log(&#x27;POSTè¯·æ±‚åœ°å€ï¼š&#x27; + req.ip.match(/\\d+\\.\\d+\\.\\d+\\.\\d+/) + &quot;;é“¾æ¥ï¼š&quot; + reqPath); //æ‰“å°å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„POSTæ•°æ®ï¼Œå¯ä»¥æ˜¯jsonå­—ç¬¦ä¸²æˆ–è€…å…¶å®ƒä»€ä¹ˆçš„ //æ¯”å¦‚å®¢æˆ·ç«¯POST /hello,å¹¶å‘é€â€œhello worldâ€å­—ç¬¦ä¸², //é‚£ä¹ˆæ­¤å¤„å°±ä¼šæ‰“å°hello world console.log(req.body); //postè¯·æ±‚ä¹Ÿéœ€è¦ç»™å®¢æˆ·ç«¯ä¸€ä¸ªå›åº” res.send(&quot;æˆåŠŸï¼ï¼&quot;);&#125;)//å¯åŠ¨æœåŠ¡å™¨//webæœåŠ¡å™¨éœ€è¦æä¾›80ç«¯å£ç»™å¤–éƒ¨è®¿é—®var server = app.listen(80, function () &#123; console.log(&quot;å¯åŠ¨æœåŠ¡å™¨&quot;); //æœåŠ¡å™¨é»˜è®¤çš„IPåœ°å€å°±æ˜¯å½“å‰ä¸»æœºçš„IPåœ°å€ console.log(server.address());&#125;) å½“ç„¶å¯ä»¥å¯ä½¿ç”¨ä¸“é—¨çš„GETï¼ŒPOSTè·¯ç”±æ¥å¤„ç†ä¸“é—¨çš„è¯·æ±‚ 1234567891011app.get(&#x27;/get&#x27;,å‚æ•°çœç•¥)//è¿™é‡Œåªæ¥å—/getè·¯ç”±//ä¾‹å¦‚ baidu.com/get/ , baidu.com/get/2333.jpg//ä¸æ¥å— baidu.com/233/app.post(&#x27;/post&#x27;,å‚æ•°çœç•¥)//è¿™é‡Œåªæ¥å—/postè·¯ç”±//ä¾‹å¦‚ baidu.com/post/ , baidu.com/post/2333.jpg//ä¸æ¥å— baidu.com/233/ è·¯ç”±ä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæ–‡ä»¶ 12345app.get(&#x27;/233.jpg&#x27;,å‚æ•°çœç•¥)//è¿™é‡Œåªæ¥å—/233.jpgè·¯ç”±//ä¾‹å¦‚ baidu.com/233.jpg//ä¸æ¥å— baidu.com/233 å¦‚æœæƒ³è®©å®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨ä¸­ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œæ‰€æœ‰çš„æ–‡ä»¶å®ç°ä¸€ä¸ªç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ â€œuseâ€æ–¹æ³• 1234app.use(&#x27;/public&#x27;, express.static(&#x27;DataBase&#x27;));//å½“å®¢æˆ·ç«¯æäº¤GET /public/233.jpgè¯·æ±‚//é‚£ä¹ˆæœåŠ¡å™¨ä¼šå°†æœ¬åœ°è·¯å¾„ä¸‹ DataBase/233.jpgå‘é€ç»™å®¢æˆ·ç«¯ æœ‰å…³expressæ¡†æ¶è¯¦ç»†æ•™ç¨‹å¯å‚è§èœé¸Ÿæ•™ç¨‹","categories":[{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://tastynoob.github.io/categories/%E6%A1%86%E6%9E%B6/"}],"tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://tastynoob.github.io/tags/nodejs/"}]},{"title":"ç§»æ¤LVGL","slug":"ç§»æ¤LVGL","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.167Z","comments":true,"path":"1970/01/01/ç§»æ¤LVGL/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%A7%BB%E6%A4%8DLVGL/","excerpt":"ç§»æ¤LVGLçš„æ–¹æ³•","text":"ç§»æ¤LVGLçš„æ–¹æ³• é¦–å…ˆä½ è¦å»LVGLçš„githubä¸Šä¸‹è½½lvglæºä»£ç  ä¸‹è½½å®Œåè§£å‹ä½ ä¼šå¾—åˆ°å¦‚ä¸‹æ–‡ä»¶: å…¶ä¸­srcæ–‡ä»¶å¤¹ä¸‹ä¸ºLVGLæºç ï¼Œä¸å¯ä¿®æ”¹ examplesä¸‹ä¸ºLVGLä¸ç¡¬ä»¶äº¤äº’çš„æ¥å£æ¨¡æ¿ lv_conf_template.hä¸ºLVGLè®¾ç½®æ¨¡æ¿ lvgl.hä¸ºLVGLåº“è°ƒç”¨å¤´æ–‡ä»¶ LVGLçš„ç§»æ¤ååˆ†ç®€å• ä»…ä»…åªéœ€è¦æä¾›åˆ·å±å‡½æ•°å°±èƒ½å®ŒæˆlvglåŸºæœ¬çš„æ˜¾ç¤ºåŠŸèƒ½ é¦–å…ˆæŠŠéœ€è¦çš„æ–‡ä»¶å…¨éƒ¨ç§»åˆ°é¡¹ç›®é‡Œï¼Œéœ€è¦å¤åˆ¶ä¸€ä¸‹æ–‡ä»¶ï¼š 123srcæ–‡ä»¶å¤¹examples/portingæ–‡ä»¶å¤¹lvgl.hå’Œlv_conf_template.hæ–‡ä»¶ æ¥ä¸‹æ¥æ˜¯è¿›è¡ŒåŸºæœ¬çš„é…ç½® é¦–å…ˆæŠŠlv_conf_template.hæ–‡ä»¶æ”¹åä¸ºlv_conf.h å†å°†lvgl_conf.hå®å¼€å¯ æŠŠ0æ”¹æˆ1å°±è¡Œäº† ç„¶åæ˜¯æ›´æ”¹lv_conf.hé‡Œé¢çš„è®¾ç½®æ‰¾åˆ°ï¼š 123456789101112131415161718192021//è®¾ç½®å±å¹•çš„åƒç´ å®½#define LV_HOR_RES_MAX (480)//è®¾ç½®å±å¹•çš„åƒç´ é«˜#define LV_VER_RES_MAX (320)//è®¾ç½®é¢œè‰²ä½å®½ï¼Œé»˜è®¤16ä½é¢œè‰²#define LV_COLOR_DEPTH 16//è®¾ç½®æ˜¾å­˜å¤§å°#define LV_DISP_ROT_MAX_BUF (10U * 1024U)//è®¾ç½®åƒç´ å¯†åº¦ï¼Œä¸€èˆ¬è®¾ç½®ä¸º60#define LV_DPI 130 //è®¾ç½®æ˜¯å¦ä½¿ç”¨GPUï¼Œå¦‚æœæ²¡æœ‰å°±è®¾ä¸º0å…³äº†#define LV_USE_GPU 1 //è®¾ç½®æ˜¯å¦ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿ#define LV_USE_FILESYSTEM 1 ç›®å‰å°±è¿™äº›ä¸»è¦è®¾ç½®ï¼Œæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥çœ‹ è®¾ç½®æ— è¯¯åå…ˆè¿›è¡Œä¸€æ¬¡ç¼–è¯‘ï¼Œå¦‚æœlvglè®¾ç½®æ­£ç¡®ï¼Œé‚£ä¹ˆç¼–è¯‘åº”è¯¥ä¼šé€šè¿‡ æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™lvglä¸ç¡¬ä»¶äº¤äº’çš„åº•å±‚é©±åŠ¨ æ‰“å¼€potingæ–‡ä»¶å¤¹ æŠŠlv_port_disp_template.cæ”¹åä¸ºlv_port_disp.c æŠŠlv_port_disp_template.hæ”¹ä¸ºlv_port_disp.h è®°ä½ä¿®æ”¹lv_port_disp.cæ—¶åŒæ ·è¦ä¿®æ”¹å¤´æ–‡ä»¶å å¼€å¯è¿™å‡ ä¸ªæ–‡ä»¶çš„å® ä¿®æ”¹lv_port_disp.hæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š åœ¨lv_port_disp.cä¸­æ‰¾åˆ°lv_port_disp_initå‡½æ•° 12345678910111213141516171819/* Example for 1) */static lv_disp_buf_t draw_buf_dsc_1;static lv_color_t draw_buf_1[LV_HOR_RES_MAX * 10]; /*A buffer for 10 rows*/lv_disp_buf_init(&amp;draw_buf_dsc_1, draw_buf_1, NULL, LV_HOR_RES_MAX * 10); /*Initialize the display buffer*//* Example for 2) */static lv_disp_buf_t draw_buf_dsc_2;static lv_color_t draw_buf_2_1[LV_HOR_RES_MAX * 10]; /*A buffer for 10 rows*/static lv_color_t draw_buf_2_2[LV_HOR_RES_MAX * 10]; /*An other buffer for 10 rows*/lv_disp_buf_init(&amp;draw_buf_dsc_2, draw_buf_2_1, draw_buf_2_2, LV_HOR_RES_MAX * 10); /*Initialize the display buffer*//* Example for 3) */static lv_disp_buf_t draw_buf_dsc_3;static lv_color_t draw_buf_3_1[LV_HOR_RES_MAX * LV_VER_RES_MAX]; /*A screen sized buffer*/static lv_color_t draw_buf_3_2[LV_HOR_RES_MAX * LV_VER_RES_MAX]; /*An other screen sized buffer*/lv_disp_buf_init(&amp;draw_buf_dsc_3, draw_buf_3_1, draw_buf_3_2, LV_HOR_RES_MAX * LV_VER_RES_MAX); /*Initialize the display æ‰¾åˆ°è¿™ä¸€æ®µä»£ç  è¿™3ä¸ªä¾‹å­æ˜¯é©±åŠ¨å±å¹•çš„æ–¹å¼ï¼Œé€‰æ‹©ç¬¬ä¸€ç§å³å¯ï¼ŒæŠŠå…¶å®ƒ2ç§æ³¨é‡Šæ‰ åœ¨ä¸Šé¢çš„ä»£ç ä¸‹æ‰¾åˆ°è¿™2è¡Œ 123456//æ˜¾ç¤ºèŒƒå›´å®½åº¦disp_drv.hor_res = 480;//æ˜¾ç¤ºèŒƒå›´é«˜åº¦disp_drv.ver_res = 320; åœ¨ä¸‹é¢æ‰¾åˆ°disp_flushå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æ ¸å¿ƒçš„æ˜¾ç¤ºå±åˆ·å±å‡½æ•° 12345678910111213141516171819202122232425262728//å‚æ•°è¯´æ˜ï¼š//disp_drv:ä¸ç”¨ç®¡//area:æ˜¾ç¤ºèŒƒå›´çš„x1ï¼Œy1,x2,y2,åæ ‡//color_p:åƒç´ ç‚¹ï¼Œå¯è§†ä¸º16ä½æ•´æ•°static void disp_flush(lv_disp_drv_t * disp_drv, const lv_area_t * area, lv_color_t * color_p)&#123; /*The most simple case (but also the slowest) to put all pixels to the screen one-by-one*/ int32_t x; int32_t y; for(y = area-&gt;y1; y &lt;= area-&gt;y2; y++) &#123; for(x = area-&gt;x1; x &lt;= area-&gt;x2; x++) &#123; //è¿™é‡Œç¼–å†™ä½ çš„ç»˜åˆ¶ä¸€ä¸ªåƒç´ ç‚¹çš„å‡½æ•°ï¼Œä½†å®é™…ä¸Šè¿™ç§æ•ˆç‡å¾ˆä½ /* put_px(x, y, *color_p)*/ color_p++; &#125; &#125; //å¦‚æœæœ‰ç±»ä¼¼äºè¿™ç§å‡½æ•°çš„è¯ï¼Œå»ºè®®ç”¨è¿™ç§ï¼Œé€Ÿåº¦æ›´å¿« //lcd_draw(area-&gt;x1,area-&gt;y1,area-&gt;x2,area-&gt;y2,(uint16_t*)color_p); /* IMPORTANT!!! * Inform the graphics library that you are ready with the flushing*/ lv_disp_flush_ready(disp_drv);&#125; è‡³æ­¤ï¼Œlvglä¸æ˜¾ç¤ºå±çš„æ¥å£ç¼–å†™å®Œæˆ æ¥ä¸‹æ¥åšä¸ªç®€å•çš„æµ‹è¯• 123456789101112131415161718192021222324252627#inclue &quot;lvgl.h&quot;int main()&#123; lv_init(); lv_port_disp_init(); lv_port_indev_init(); //åˆ›å»ºä¸€ä¸ªå›¾å½¢æŒ‰é’® lv_obj_t* btn = lv_btn_create(lv_scr_act(), NULL); //è®¾ç½®æŒ‰é’®å¤§å° lv_obj_set_pos(btn, 10, 10); //è®¾ç½®æŒ‰é’®ä½ç½® lv_obj_set_size(btn, 120, 50); //å¼€å¯lvglå·¥ä½œçº¿ç¨‹ï¼Œè¿™ä¸ªå‡½æ•°ä¸»è¦å¤„ç†lvglå›¾åƒç»˜åˆ¶å’Œäº‹ä»¶å“åº”ç­‰ä»»åŠ¡ task_run(lv_task_handler); while(1)&#123; //å¿ƒè·³å‡½æ•°ï¼Œè®¾ç½®ä¸º1ä»£è¡¨å¾ªç¯ä¸€æ¬¡æ¶ˆè€—1msï¼Œç”¨æ¥è®¾ç½®lvglçš„äº‹ä»¶é¢‘ç‡ //æ¯”å¦‚lvglåŠ¨ç”»ï¼Œå¦‚æœåœ¨1mså†…è¿è¡Œ100æ¬¡lv_tick_inc(1) //é‚£ä¹ˆåŠ¨ç”»é€Ÿåº¦ç†è®ºä¸Šä¼šå¿«100å€ lv_tick_inc(1); delayms(1); &#125;&#125; å¦‚æœlvglèƒ½æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆå±å¹•ä¸Šåº”è¯¥ä¼šç»˜åˆ¶ä¸€ä¸ªæŒ‰é’® æ¥ä¸‹æ¥æ˜¯ç§»æ¤è¾“å…¥è®¾å¤‡ ä¸ä¸Šé¢ä¸€æ · åœ¨portingä¸‹æ‰¾åˆ°lv_port_indev_template.cå’Œlv_port_indev_template.h ç„¶åä¿®æ”¹æ–‡ä»¶åï¼Œå® ä¿®æ”¹lv_port_indev.hæ–‡ä»¶å†…å®¹å¦‚ä¸‹ å†ä¿®æ”¹ä¿®æ”¹lv_port_indev.cé‡Œé¢çš„ä»£ç  lv_port_indev.cé‡Œé¢æä¾›çš„æ¥å£æ¯”è¾ƒå¤šï¼Œè¿™é‡Œåªä»‹ç»ç¼–å†™è§¦æ‘¸æŒ‰é”®æ¥å£ æ‰¾åˆ°ä¸€ä¸‹ä»£ç  12345678910111213141516171819202122232425/*------------------ * Button * -----------------*//*Initialize your button if you have*/button_init();/*Register a button input device*/lv_indev_drv_init(&amp;indev_drv);indev_drv.type = LV_INDEV_TYPE_BUTTON;indev_drv.read_cb = button_read;indev_button = lv_indev_drv_register(&amp;indev_drv);/*Assign buttons to points on the screen*///è¿™é‡Œæ˜¯æŒ‰é’®æ˜ å°„//æ¯”å¦‚æŒ‰ä¸‹IDä¸º0çš„æŒ‰é’®å°±ç›¸å½“äºç‚¹å‡»å±å¹•ï¼ˆ10ï¼Œ10ï¼‰çš„ä½ç½®static const lv_point_t btn_points[2] = &#123; &#123;10, 10&#125;, /*Button 0 -&gt; x:10; y:10*/ &#123;40, 100&#125;, /*Button 1 -&gt; x:40; y:100*/&#125;;//è¿™é‡Œé»˜è®¤ä½¿ç”¨buttonæ¥å£lv_indev_set_button_points(indev_button, btn_points); ä»£ç ä¸­é»˜è®¤ä½¿ç”¨buttonæ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæŒ‰é”®æ˜ å°„æ”¹ä¸€ä¸‹å°±è¡Œ ç„¶åæ‰¾åˆ°æŒ‰é’®çš„æ¥å£ 1234567891011121314151617181920212223242526272829303132/*Get ID (0, 1, 2 ..) of the pressed button*///è·å–æŒ‰é”®æŒ‰ä¸‹çš„IDstatic int8_t button_get_pressed_id(void)&#123; uint8_t i; /*Check to buttons see which is being pressed (assume there are 2 buttons)*/ for(i = 0; i &lt; 2; i++) &#123; /*Return the pressed button&#x27;s ID*/ if(button_is_pressed(i)) &#123; return i; &#125; &#125; /*No button pressed*/ return -1;&#125;/*Test if `id` button is pressed or not*///ç¡®è®¤æŒ‰é”®æ˜¯å¦è¢«æŒ‰ä¸‹static bool button_is_pressed(uint8_t id)&#123; /*Your code comes here*/ return false;&#125; è¿™é‡Œå°±æŒ‰è‡ªå·±çš„æ„æ„¿æ”¹äº† åŒæ ·å†åšä¸€ä¸ªå°æµ‹è¯• #inclue &quot;lvgl.h&quot; int main()&#123; lv_init(); lv_port_disp_init(); lv_port_indev_init(); //åˆ›å»ºä¸€ä¸ªå›¾å½¢æŒ‰é’® lv_obj_t* btn = lv_btn_create(lv_scr_act(), NULL); //è®¾ç½®æŒ‰é’®å¤§å° lv_obj_set_pos(btn, 10, 10); //è®¾ç½®æŒ‰é’®ä½ç½® lv_obj_set_size(btn, 120, 50); //è¿™é‡Œæ˜¯è®¾ç½®lvglæŒ‰é’®çš„äº‹ä»¶ lv_obj_set_event_cb(btn, [](lv_obj_t* btn, lv_event_t event) &#123; switch (event) &#123; //ç¬¬ä¸€æ¬¡æŒ‰ä¸‹ case LV_EVENT_PRESSED: printf(&quot;pressed!\\n&quot;); break; //æŒç»­æŒ‰ä¸‹ case LV_EVENT_PRESSING: printf(&quot;pressing!\\n&quot;); break; //æŒ‰é’®é‡Šæ”¾ case LV_EVENT_CLICKED: printf(&quot;clicked!\\n&quot;); break; &#125; &#125;); /*Assign a call //å¼€å¯lvglå·¥ä½œçº¿ç¨‹ï¼Œè¿™ä¸ªå‡½æ•°ä¸»è¦å¤„ç†lvglå›¾åƒç»˜åˆ¶å’Œäº‹ä»¶å“åº”ç­‰ä»»åŠ¡ task_run(lv_task_handler); while(1)&#123; //å¿ƒè·³å‡½æ•°ï¼Œè®¾ç½®ä¸º1ä»£è¡¨å¾ªç¯ä¸€æ¬¡æ¶ˆè€—1msï¼Œç”¨æ¥è®¾ç½®lvglçš„äº‹ä»¶é¢‘ç‡ //æ¯”å¦‚lvglåŠ¨ç”»ï¼Œå¦‚æœåœ¨1mså†…è¿è¡Œ100æ¬¡lv_tick_inc(1) //é‚£ä¹ˆåŠ¨ç”»é€Ÿåº¦ç†è®ºä¸Šä¼šå¿«100å€ lv_tick_inc(1); delayms(1); &#125; &#125; lvglåŒæ ·å¯ä»¥ç§»æ¤æ–‡ä»¶ç³»ç»Ÿï¼Œå°±è·Ÿä¸Šé¢æ•™ç¨‹ä¸€æ ·ï¼Œè¿™é‡Œä¸åŠ èµ˜è¿°","categories":[{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://tastynoob.github.io/categories/%E6%A1%86%E6%9E%B6/"}],"tags":[{"name":"LVGL","slug":"LVGL","permalink":"https://tastynoob.github.io/tags/LVGL/"}]},{"title":"é›¶åŸºç¡€ç¥ç»ç½‘ç»œç§‘æ™®","slug":"é›¶åŸºç¡€ç¥ç»ç½‘ç»œç§‘æ™®","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.175Z","comments":true,"path":"1970/01/01/é›¶åŸºç¡€ç¥ç»ç½‘ç»œç§‘æ™®/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E9%9B%B6%E5%9F%BA%E7%A1%80%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%A7%91%E6%99%AE/","excerpt":"ç®€å•çš„è®²è§£ä¸€ä¸‹äººå·¥ç¥ç»ç½‘ç»œçš„ç»“æ„","text":"ç®€å•çš„è®²è§£ä¸€ä¸‹äººå·¥ç¥ç»ç½‘ç»œçš„ç»“æ„ é¦–å…ˆ è®²ä¸€ä¸‹ä»€ä¹ˆæ˜¯äººå·¥ç¥ç»ç½‘ç»œé¡¾åæ€ä¹‰ï¼Œäººå·¥ç¥ç»ç½‘ç»œå°±æ˜¯äººä¸ºçš„æ¨¡æ‹Ÿå¤§è„‘çš„ç»“æ„ä»è€Œè®©äººå·¥ç¥ç»ç½‘ç»œèƒ½å¤Ÿå®Œæˆéƒ¨åˆ†æ™ºèƒ½æ“ä½œ äººå·¥ç¥ç»ç½‘ç»œæ­£å¦‚æ¨¡æ‹Ÿå¤§è„‘çš„ä¸€æ ·å®ƒä¹Ÿç”±è®¸å¤šäººå·¥ç¥ç»å…ƒç»„æˆ ç°å®å½“ä¸­äººè„‘çš„ç¥ç»å…ƒä¼šæ ¹æ®è¾“å…¥ä¿¡å·æ¥è¾“å‡ºç›¸åº”çš„ä¿¡å·ç”±äºäººè„‘ç¥ç»å…ƒçš„å…·ä½“æ´»åŠ¨å®åœ¨æ˜¯å¤ªè¿‡å¤æ‚å› æ­¤äººå·¥ç¥ç»å…ƒå®é™…ä¸Šä¼šå¤§å¤§ç®€åŒ–æœ€ç»ˆï¼Œå®ƒçš„æ•°å­¦æ¨¡å‹å¦‚ä¸‹å®ƒæœ‰å¤šä¸ªè¾“å…¥ï¼Œä¸€ä¸ªè¾“å‡ºæ¯ä¸ªè¾“å…¥éƒ½å æœ‰ä¸åŒçš„æƒé‡äººå·¥ç¥ç»å…ƒå†…éƒ¨ä¼šè¿›è¡Œéçº¿æ€§è¿ç®—ï¼Œä¿è¯äººå·¥ç¥ç»ç½‘ç»œæ˜¯éçº¿æ€§çš„ æ­¤æ—¶ï¼Œè¿™ä¸ªäººå·¥ç¥ç»ç½‘ç»œçš„æ•°å­¦è¡¨è¾¾å¼å¯ä»¥å†™ä¸ºï¼š O &#x3D; f(Î£Yáµ¢Wáµ¢) å…¶ä¸­f()ä¸ºæ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸ä¸ºéçº¿æ€§è¿ç®—å‡½æ•°ä¾‹å¦‚sigmodå‡½æ•°å³å¯¹è¾“å…¥ä¸å¯¹åº”çš„æƒé‡ç›¸ä¹˜çš„å’Œè¿›è¡Œéçº¿æ€§è¿ç®— ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç¥ç»å…ƒçš„åŸºæœ¬æ¨¡å‹å¤§é‡çš„äººå·¥ç¥ç»å…ƒå‘ˆå¹³é¢ç»„åˆåœ¨ä¸€èµ·å°±å½¢æˆäº†BPç¥ç»ç½‘ç»œ(å¹³é¢ç¥ç»ç½‘ç»œ) å¯ä»¥çœ‹åˆ°ï¼ŒBPç¥ç»ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºçš„ä½æ•°å–å†³äºè¾“å…¥å±‚çš„ç¥ç»å…ƒæ•°é‡ï¼Œç›¸å½“äº2ä¸ªå¤šç»´å‘é‡å› æ­¤ï¼Œå†æŠ½è±¡ä¸€ç‚¹ï¼ŒBPç¥ç»ç½‘ç»œå°±ç›¸å½“äºä¸€ä¸ªè¾“å…¥ä¸ºnç»´çš„å‘é‡ï¼Œè¾“å‡ºä¸ºmç»´çš„å‘é‡çš„ä¸€ä¸ªå‡½æ•°è¯¥å‡½æ•°çš„å†…éƒ¨æ„é€ å°±æ˜¯ä¸€ä¸ªå¦‚åŒä¸Šå›¾çš„ç½‘ç»œ è€Œæˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯å»æ§åˆ¶è¿™ä¸ªå‡½æ•°ï¼Œè®©å®ƒèƒ½å®Œæˆç±»ä¼¼äººç±»å¤§è„‘çš„å·¥ä½œ é‚£ä¹ˆå¦‚ä½•å»æ§åˆ¶å®ƒå‘¢ å‡å¦‚æœ‰ä¸€ä¸ªæœªçŸ¥å‡½æ•°æ”¾åœ¨ä½ é¢å‰ï¼Œè¦ä½ å»çŒœè¿™ä¸ªå‡½æ•°çš„æ„é€ ä½ å”¯ä¸€çš„æ–¹æ³•å°±æ˜¯å°è¯•å»è¾“å…¥ä¸€ä¸ªå€¼ï¼Œçœ‹è¿™ä¸ªå‡½æ•°çš„è®¡ç®—ç»“æœæ˜¯ä»€ä¹ˆæ¯”å¦‚ç»™ä½ ä¸€ä¸ªå‡½æ•° g(x) ï¼Œå†ç»™ä½ 1ä¸ªè¾“å…¥æ•°æ® g(0) &#x3D; 0æ­¤æ—¶ä½ è¿˜çŒœä¸åˆ°è¿™ä¸ªå‡½æ•°æ˜¯ä»€ä¹ˆ,å†æ¥ä¸€ä¸ªæ•°æ® g(PI&#x2F;6) &#x3D; 1&#x2F;2è¿™æ—¶ï¼Œä½ å¯èƒ½ä¼šæƒ³åˆ°g(x)&#x3D;sin(x)ï¼Œä½†è¿˜ä¸ç¡®è®¤ï¼Œå¦‚æœ g(PI&#x2F;4) &#x3D; âˆš2&#x2F;2æ­¤æ—¶ï¼Œä½ ä¼šæƒ³åˆ°ï¼Œè¯¥å‡½æ•°å¾ˆå¤§å¯èƒ½æ˜¯g(x)&#x3D;sin(x),ä½†å‡¡äº‹éƒ½å¯èƒ½æœ‰ä¾‹å¤–â€¦ å¦‚æœç»™ä½ æ— ç©·ä¸ªæ•°æ®éƒ½æ»¡è¶³g(x)&#x3D;sin(x)ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç¡®å®šè¯¥å‡½æ•°ç™¾åˆ†ç™¾å°±æ˜¯g(x)&#x3D;sin(x) è¿™é‡ŒæŠŠè¾“å…¥æœªçŸ¥å‡½æ•°çš„æ•°æ®å’Œè¯¥å‡½æ•°è¾“å‡ºç›¸åº”çš„å€¼è”åˆèµ·æ¥ç§°ä¸ºâ€è¾“å…¥è¾“å‡ºæ•°æ®å¯¹â€ å®é™…ä¸Šï¼Œç¥ç»ç½‘ç»œå°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªâ€œçŒœè°œâ€æ¨¡å‹ ä¹‹å‰è¯´äº†,BPç¥ç»ç½‘ç»œå°±æ˜¯ä¸€ä¸ªæŠ½è±¡çš„å‘é‡å‡½æ•°æˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯ä¸åœçš„ç»™å®ƒå–‚æ•°æ®ï¼Œè®©å®ƒå»çŒœæˆ‘ä»¬æƒ³è¦çš„å‡½æ•°ç„¶ååˆ©ç”¨è¿™ä¸ªå‡½æ•°å»è®¡ç®—æˆ‘ä»¬è¾“å…¥çš„å…¶å®ƒæ•°æ® ä¾‹å¦‚ï¼Œç»™ä¸€ä¸ªBPç¥ç»ç½‘ç»œä¸åœçš„å–‚g(x) &#x3D; sin(x)è¿™ä¸ªè¾“å…¥è¾“å‡ºæ•°æ®å¯¹é‚£ä¹ˆè¿™ä¸ªç¥ç»ç½‘ç»œå°±å¯èƒ½æ‰¾åˆ°äº†è¾“å…¥è¾“å‡ºçš„è§„å¾‹ä¸‹æ¬¡ä½ è¾“å…¥ä¸€ä¸ªä¹‹å‰è¾“å…¥è¾“å‡ºæ•°æ®å¯¹å½“ä¸­æ²¡æœ‰å‡ºç°çš„æ•°æ®æ—¶ï¼Œå®ƒå°±å¯èƒ½æ˜ç™½ä½ çš„æ„æ€ï¼Œè¾“å‡ºå¯¹åº”çš„å€¼ çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¸€å¤´é›¾æ°´ï¼Œæ—¢ç„¶æˆ‘å·²ç»çŸ¥é“äº†g(x)&#x3D;sin(x),é‚£ä¹ˆæˆ‘è¿˜è®©ç¥ç»ç½‘ç»œå»çŒœg(x)å¹²å•¥å‘¢ï¼Ÿæ²¡é”™ï¼Œè®©ç¥ç»ç½‘ç»œå»çŒœg(x)å‡½æ•°æ—¶ï¼Œå®ƒè‡ªå·±å°±å˜æˆäº†g(x)å‡½æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€æ‹Ÿåˆâ€ å®é™…ä¸Šï¼Œç¥ç»ç½‘ç»œâ€œæ‹Ÿåˆâ€çš„è¿‡ç¨‹è¿œæ¯”è¿™å¤æ‚å¾—å¤šï¼Œåˆ«å¿˜äº†ï¼Œç¥ç»ç½‘ç»œå¯ä»¥è¾“å…¥å¤šä¸ªæ•°æ®ï¼Œè¾“å‡ºå¤šä¸ªæ•°æ®åŒæ—¶å¯ä»¥æ‹Ÿåˆä»»æ„å‡½æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°è¯•è¾“å…¥ä¸€ä¸ªæ‰‹å†™æ•°å­—å›¾åƒï¼Œç»™å®ƒä¸€ä¸ªæœŸæœ›è¾“å‡ºï¼Œè®©å®ƒå»çŒœï¼šâ€œè¾“å…¥æ‰‹å†™æ•°å­—å›¾åƒï¼Œè¾“å‡ºå¯¹åº”æ•°å­—â€è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·ä¸€æƒ³ï¼Œå²‚ä¸å¦™å“‰ï¼Ÿ æœ‰äº†â€œè¾“å…¥æ‰‹å†™æ•°å­—å›¾åƒï¼Œè¾“å‡ºå¯¹åº”æ•°å­—â€è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿å®ƒå»å®Œæˆäººå·¥æ‰èƒ½å®Œæˆçš„äº‹æ¯”å¦‚è¯†åˆ«æ‰‹å†™è´¦å•ï¼Œå‡ å¼ è´¦å•å¯èƒ½å¯¹äººç±»æ²¡å•¥å‹åŠ›ï¼Œä½†å¦‚æœå‡ åä¸‡å¼ å‘¢ï¼Œæœºå™¨å¯ä¸ä¼šä¼‘æ¯ï¼Œè€Œè¿™ä¹Ÿæ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒï¼šä»£æ›¿äººç±»å®Œæˆâ€äººç±»æ‰èƒ½å®Œæˆçš„å·¥ä½œâ€â€¦ è€Œè¿™ï¼Œä»…ä»…æ˜¯â€œå¹³é¢â€ç¥ç»ç½‘ç»œï¼Œåé¢è¿˜æœ‰æ›´åŠ å¼ºå¤§çš„â€œç«‹ä½“â€ç¥ç»ç½‘ç»œ","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"},{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"æ— ç¬¦å·é™¤æ³•å™¨çš„verilogå®ç°","slug":"FPGA_/FPGA-BOOTHDIV","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA-BOOTHDIV/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA-BOOTHDIV/","excerpt":"æ— ç¬¦å·ç¬¦å·å™¨çš„verilogå®ç°","text":"æ— ç¬¦å·ç¬¦å·å™¨çš„verilogå®ç° ä¸‹é¢æ˜¯å®ƒçš„å¤šå‘¨æœŸå®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657module DIV ( input wire i_clk, input wire i_rstn, input wire[31:0] A, input wire[31:0] B, input i_en, output wire[31:0] Y, output wire[31:0] REM, output wire o_finish); reg finish; reg[2:0] flag; reg[10:0] cnt; reg[63:0] yrem; wire[31:0] _B = -B; wire[63:0] yrem_shift = &#123;yrem[62:0],1&#x27;b0&#125;; wire[63:0] temp = &#123;B,32&#x27;h0&#125;; initial begin flag&lt;=0; finish&lt;=0; cnt&lt;=0; yrem&lt;=0; end always @(posedge i_clk or negedge i_rstn) begin if(i_rstn == `rst)begin end else begin case(flag) 0:begin if(i_en)begin cnt&lt;=0; flag&lt;=1; finish&lt;=0; yrem &lt;= &#123;32&#x27;h0,A&#125;; end end 1:begin yrem &lt;= (yrem_shift[63:32] &gt;= B) ? yrem_shift - temp + 1&#x27;b1 : yrem_shift; cnt&lt;=cnt+1; if(cnt == 31)begin//è¿™é‡Œæ˜¯å¹¶è¡Œåˆ¤æ–­ flag &lt;=2; finish &lt;= 1; end end 2:begin flag&lt;=0; finish&lt;=0; end endcase end end assign Y = yrem[31:0]; assign REM = yrem[63:32]; assign o_finish = finish;endmodule","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -1ï¼šä»€ä¹ˆæ˜¯FPGA","slug":"FPGA_/FPGA1","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA1/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA1/","excerpt":"FPGAä»‹ç»","text":"FPGAä»‹ç» FPGAï¼ˆField Programmable Gate Arrayï¼‰ å³ç°åœºå¯ç¼–ç¨‹é€»è¾‘é—¨é˜µåˆ— æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ‰€æœ‰çš„èŠ¯ç‰‡éƒ½æ˜¯ç”±ä¸€ä¸ªä¸ªæ™¶ä½“ç®¡ç»„æˆ é€šè¿‡æ™¶ä½“ç®¡çš„ä¸åŒç»„åˆæ¥å®ç°ä¸åŒçš„åŠŸèƒ½ æœ€å¸¸è§çš„è«è¿‡äºæˆ‘ä»¬æ‰‹æœºä¸Šçš„cpu ä½†æ˜¯è¿™äº›èŠ¯ç‰‡çš„å†…éƒ¨ç”µè·¯æ˜¯å›ºå®šçš„ åªèƒ½å®Œæˆç‰¹å®šåŠŸèƒ½ å³ä½¿æ˜¯cpuä¹Ÿæ˜¯é æå‰è®¾è®¡å¥½çš„æŒ‡ä»¤æ¥å®Œæˆä¸åŒä»»åŠ¡ ä½†æ˜¯ä»–ä»¬éƒ½æœ‰ä¸€äº›å…±åŒç‚¹ï¼Œé‚£å°±æ˜¯éƒ½ä¾èµ–äºåŸºæœ¬çš„é€»è¾‘é—¨ç”µè·¯ è€Œæ­£å¦‚FPGAçš„åå­—ä¸€æ ·ï¼Œå¯ç¼–ç¨‹é€»è¾‘é—¨ æ„å‘³ç€å¯ä»¥é€šè¿‡ç¼–ç¨‹æ¥è®¾è®¡é€»è¾‘é—¨çš„ç»„åˆå…³ç³» æ¥å®ç°ä¸åŒçš„ç”µè·¯ å¯ä»¥ä»¥æä½çš„å­¦ä¹ æˆæœ¬æ¥å­¦ä¹ æ•°å­—ç”µè·¯ï¼Œç”šè‡³æ˜¯è®¾è®¡CPUè¿™ç±»å¤æ‚ç”µè·¯ FPGAçš„å†…éƒ¨æ„é€ ä¹Ÿæ˜¯ååˆ†ç®€å•ç²—æš´ FPGAç”±è®¸å¤šLUTï¼ˆLook-Up-Table æŸ¥æ‰¾è¡¨ï¼‰æ„æˆ å®é™…ä¸Šï¼Œè€ƒè™‘åˆ°å„ç§å› ç´ ï¼ŒçœŸæ­£çš„â€œå¯ç¼–ç¨‹é€»è¾‘é—¨â€å¾ˆéš¾å®ç° å› æ­¤FPGAé‡‡ç”¨äº†ä¸€ç§å·§å¦™çš„æ–¹å¼ ä½¿ç”¨LUTæ¥æ¨¡æ‹Ÿé€»è¾‘å•å…ƒçš„çœŸå€¼è¡¨ å½“è¾“å…¥ä¸€ä¸ªä¿¡å·æ—¶ï¼Œå°±æ ¹æ®è¿™ä¸ªè¡¨æ¥è¾“å‡ºå¯¹åº”çš„ä¿¡å· æ¥å®ç°ç›®æ ‡é€»è¾‘å•å…ƒçš„åŠŸèƒ½ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆLUTå«â€œæŸ¥æ‰¾è¡¨â€ æ€»ä¹‹ï¼Œæœ‰äº†FPGA æˆ‘ä»¬å°±å¯ä»¥æ— éœ€ä¾èµ–ç‰¹æ®Šè®¾å¤‡æ¥è®¾è®¡ç”µè·¯","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"BOOTHä¹˜æ³•å™¨çš„verilogå®ç°","slug":"FPGA_/FPGA-BOOTHMUL","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA-BOOTHMUL/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA-BOOTHMUL/","excerpt":"BOOTHä¹˜æ³•å™¨çš„verilogå®ç°","text":"BOOTHä¹˜æ³•å™¨çš„verilogå®ç° boothä¹˜æ³•å™¨æ˜¯ä¸€ç§æœ‰ç¬¦å·æ•´æ•°ä¹˜æ³•å™¨ä¸‹é¢æ˜¯å®ƒçš„å¤šå‘¨æœŸå®ç°è‡³äºåŸç†å°±æ‡’å¾—è®²äº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859//boothå¤šå‘¨æœŸä¹˜æ³•å™¨module BOOTH_MUL ( input wire i_clk, input wire i_rstn, input wire[31:0] A, input wire[31:0] B, input i_en, output wire[63:0] Y, output wire o_finish); reg[64:0] p; reg finish; reg[15:0] cnt; reg[1:0] tag; initial begin p&lt;=0; finish&lt;=0; cnt&lt;=0; tag&lt;=0; end wire[31:0] _A = 0-A;//è¢«ä¹˜æ•°Bçš„è´Ÿæ•° wire b0 = p[0]; wire b1 = p[1]; //pçš„é«˜32ä½ wire[31:0] ph = b0^b1 ? (p[64:33] + (b1 ? _A : A)) : p[64:33]; always @(posedge i_clk or negedge i_rstn) begin if(i_rstn == `rst)begin end else begin case(tag) 0:begin if(i_en)begin p &lt;= &#123;32&#x27;b0,B,1&#x27;b0&#125;; finish&lt;=0; cnt&lt;=0; tag&lt;=1; end end 1:begin cnt &lt;= cnt + 1; p &lt;= &#123;ph[31],ph,p[32:1]&#125;; if(cnt == 31)begin//è¿™é‡Œæ˜¯å¹¶è¡Œåˆ¤æ–­ tag &lt;=2; finish&lt;=1; end end 2:begin tag&lt;=0; finish&lt;=0; end endcase end end assign o_finish = finish; assign Y = p[64:1];endmodule","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGA-å¯é…ç½®çš„FIFOæ¨¡å—","slug":"FPGA_/FPGA-FIFO","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA-FIFO/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA-FIFO/","excerpt":"FPGA-å¯é…ç½®çš„FIFOæ¨¡å—","text":"FPGA-å¯é…ç½®çš„FIFOæ¨¡å— 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071module FIFO #( parameter unitwid = 1, parameter unitdpth = 2)( input wire i_clk, input wire i_rstn, input wire i_wen, input wire[unitwid-1:0] i_unitdata, output wire o_full, input wire i_ren, output reg[unitwid-1:0] o_unitdata, output wire o_empty); function integer clogb2 (input integer bit_depth); begin for(clogb2=0; bit_depth&gt;0; clogb2=clogb2+1) bit_depth = bit_depth&gt;&gt;1; end endfunction reg[unitwid-1:0] fifo_units[unitdpth-1:0]; reg[clogb2(unitdpth)-1:0] hptr,eptr,count; assign o_full = (count == unitdpth); assign o_empty = ~(|count); wire[clogb2(unitdpth)-1:0] hptr_1 = ((hptr == unitdpth) ? 0 : (hptr + 1)); wire[clogb2(unitdpth)-1:0] eptr_1 = ((eptr == unitdpth) ? 0 : (eptr + 1)); initial begin hptr&lt;=0; eptr&lt;=0; count&lt;=0; end always @(posedge i_clk) begin if(~i_rstn)begin hptr&lt;=0; eptr&lt;=0; count&lt;=0; end else begin if(i_wen &amp;&amp; i_ren)begin//å¦‚æœåŒæ—¶å‘ç”Ÿè¯»å†™ hptr&lt;=hptr_1; eptr&lt;=eptr_1; end else if(i_wen &amp; (~o_full))begin//åªæœ‰å†™ fifo_units[hptr] &lt;= i_unitdata; count&lt;=count+1; hptr&lt;=hptr_1; end else if(i_ren &amp; (~o_empty))begin//åªæœ‰è¯» count&lt;=count-1; eptr&lt;=eptr_1; o_unitdata &lt;=fifo_units[eptr]; end end end endmodule","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -9ï¼šæ—¶åºç”µè·¯ä¹‹ä¸²å£é€šè®¯æ¨¡å—","slug":"FPGA_/FPGA10","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA10/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA10/","excerpt":"æ—¶åºç”µè·¯ä¹‹ä¸²å£é€šè®¯æ¨¡å—","text":"æ—¶åºç”µè·¯ä¹‹ä¸²å£é€šè®¯æ¨¡å— é€šä¿¡æ˜¯æ—¶åºç”µè·¯çš„åŸºç¡€ä¹‹ä¸€ è¦ä¿è¯ä¿¡æ¯èƒ½å¤Ÿåœ¨ä¸åŒæ¨¡å—ç›´æ¥å‡†ç¡®ä¼ è¾“ é€šä¿¡åè®®æ˜¯ä¿è¯ä¿¡æ¯ä¼ è¾“çš„æ ¼å¼è¦æ±‚ é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±æ¥è®¾è®¡ä¸ªæœ€ç®€å•çš„ ä¹Ÿæ˜¯æœ€åŸºç¡€çš„ä¸²å£é€šä¿¡æ¨¡å— ä¸²å£é€šä¿¡æ—¶åºè¿™é‡Œä¸åšä»‹ç» è¯¥ä¸²å£æ¨¡å—çš„åŠŸèƒ½æè¿°å¦‚ä¸‹ï¼š æ³¢ç‰¹ç‡9600 åœæ­¢ä½1 æ ¡éªŒä½æ—  æ¥æ”¶å­—èŠ‚åå°†å­—èŠ‚åŠ ä¸€å‘é€å›å» é¦–å…ˆæ˜¯PLLæ¨¡å— PLLæ¨¡å—ç»™ä¸²å£æ¨¡å—æä¾›ç¨³å®šçš„æ—¶é’Ÿä¿¡å· ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627module PLL( input[31:0] sub, input clk, input rst, output reg clk_out); reg[31:0] cnt;initial begin cnt = 32&#x27;d1; clk_out = 0;end always @(posedge clk or negedge rst) begin if (rst == 0) begin cnt = 32&#x27;d1; clk_out = 0; end else if(cnt &lt; sub) begin cnt = cnt + 1; end else if(cnt &gt;= sub) begin clk_out = ~clk_out; cnt = 32&#x27;d1; endendendmodule ç„¶åæ˜¯ä¸²å£æ¨¡å— ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798module USART( input clk, //24Mhz input rst, input rx, output reg tx); reg[7:0] buff;reg[7:0] rx_shift;reg[7:0] tx_shift;initial begin tx = 1; buff = 0; rx_shift = 0; tx_shift = 0;end wire clk0;PLL pll(.sub (32&#x27;d1250),.clk (clk),.rst (rst),.clk_out (clk0));integer rx_i = 0;integer tx_i = 0;integer rx_flag = 0;integer tx_flag = 0;integer send_flag = 0;always @(posedge clk0 or negedge rst)begin if(rst == 0)begin rx_i=0; tx_i = 0; rx_flag=0; tx_flag = 0; tx = 1; buff = 0; rx_shift = 0; tx_shift = 0; end else begin case(rx_flag) 0:begin //èµ·å§‹ä½ if(rx==0)begin rx_flag=1; end end 1:begin//æ•°æ®ä½ rx_shift = rx_shift + &#123;rx,7&#x27;d0&#125;; if(rx_i &lt; 7)begin rx_shift = rx_shift &gt;&gt; 1; end rx_i = rx_i + 1; if (rx_i &gt;= 8)begin rx_flag = 2; rx_i = 0; end end 2:begin//ç»“æŸä½ if(rx == 1)begin buff = rx_shift; rx_shift = 0; send_flag = 1; rx_flag = 0; end end endcase if( send_flag==1 )begin case(tx_flag) 0:begin tx_shift = buff + 1; tx = 0; tx_flag=1; end 1:begin tx = tx_shift[0]; tx_shift = tx_shift &gt;&gt; 1; tx_i = tx_i+1; if(tx_i &gt;= 8)begin tx_flag = 2; tx_i = 0; end end 2:begin tx = 1; tx_flag = 0; send_flag = 0; end endcase end end endendmodule ç®¡è„šæ˜ å°„å¦‚ä¸‹ï¼š è¿æ¥USBè½¬ä¸²å£æ¨¡å— ä½¿ç”¨ä¸²å£è°ƒè¯•è½¯ä»¶è¿›è¡Œæµ‹è¯•ï¼š å®é™…ä½¿ç”¨æ•ˆæœå¦‚ä¸‹; å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å‘é€ä¸€ä¸²åå…­è¿›åˆ¶æ•°æ® å®ƒä¼šè‡ªåŠ¨å°†æ•°æ®åŠ ä¸€åå†è¿”å›æ¥ å¯ä»¥è¯æ˜æˆ‘ä»¬çš„ä»£ç æ²¡æœ‰é—®é¢˜","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAï¼š8051å†…æ ¸ç§»æ¤","slug":"FPGA_/FPGA11","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.119Z","comments":true,"path":"1970/01/01/FPGA_/FPGA11/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA11/","excerpt":"FPGAï¼š8051å†…æ ¸ç§»æ¤","text":"FPGAï¼š8051å†…æ ¸ç§»æ¤ ä»£ç å…¨éƒ¨éƒ½åœ¨GitHubä»“åº“ é€‚ç”¨äºä»»ä½•fpgaèŠ¯ç‰‡ æ¨èsipeedçš„tang perimerå¼€å‘æ¿","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGA-10ï¼šè®¾è®¡ä¸ªç®€å•çš„cpu(çœŸçš„ç®€å•ï¼)","slug":"FPGA_/FPGA12","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA12/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA12/","excerpt":"ç¼–å†™ä¸€ä¸ªç®€å•çš„cpu","text":"ç¼–å†™ä¸€ä¸ªç®€å•çš„cpu ç»è¿‡äº†ä¹‹å‰çš„å­¦ä¹  æƒ³å¿…å„ä½å¯¹verilogåº”è¯¥æœ‰äº†åŸºæœ¬çš„åŸºç¡€ é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥é€ cpuå§ï¼ æˆ‘ä»¬å°†å†™ä¸€ä¸ªç®€å•çš„å•å‘¨æœŸcpu è¯¥cpuæœ‰ä¸€ä¸‹ç‰¹ç‚¹ï¼š 32ä½æ¶æ„ å•å‘¨æœŸæ‰§è¡Œ ç®€æ´å®ç”¨ 32ä½å®šé•¿æŒ‡ä»¤ æœ‰æ‰‹å°±è¡Œ æˆ‘ç§°ä¹‹ä¸º â€œantâ€ å†…æ ¸ å°±è·Ÿèš‚èšä¸€æ ·ï¼Œâ€œåŠŸèƒ½å¼±å°â€ï¼Œä½†ä¹Ÿä»€ä¹ˆèƒ½å¹² æˆ‘ä¹Ÿç‰¹åœ°ä¸ºè¯¥cpuç¼–å†™äº†ä¸ªæ±‡ç¼–å™¨ åŒ…æ‹¬ä½¿ç”¨pythonç¼–å†™çš„binè½¬txtå·¥å…· è¿æ¥å¦‚ä¸‹ï¼š click me ä¸‹è½½è¯¥é¡¹ç›® å³å¯å¾—åˆ°5ä¸ªæ–‡ä»¶ 123456789cpu.v: antå†…æ ¸æ ¸å¿ƒæ–‡ä»¶test.v : antå†…æ ¸ä»¿çœŸæ–‡ä»¶ant-asm.exe: antæ±‡ç¼–å™¨binTotxt.py:å°†binæ–‡ä»¶è½¬æ¢æˆverilogå¯è¯»å–çš„å‚¨å­˜å™¨å¡«å……æ–‡ä»¶demo.ant:antæ±‡ç¼–ä¾‹ç¨‹ ä¸‹é¢æ˜¯å¯„å­˜å™¨è¯´æ˜åŠæŒ‡ä»¤é›†ï¼š 1234567891011121314151617181920212223å¯„å­˜å™¨ï¼šr0~r8 å…±16ä¸ª32ä½å¯„å­˜å™¨ï¼Œå‡å¯å¯è¯»å¯å†™ï¼Œr0~r14 é€šç”¨å¯„å­˜å™¨r15 pcå¯„å­˜å™¨æŒ‡ä»¤é›†:(æ€»å…±14æ¡)wh r0,num å†™r0å¯„å­˜å™¨çš„é«˜16ä½ &#123;8&#123;æŒ‡ä»¤&#125;,4&#123;å¯„å­˜å™¨id&#125;,16&#123;å¸¸æ•°&#125;ï¼Œ4&#123;æ— æ„ä¹‰&#125;&#125;wl r0,num å†™r0å¯„å­˜å™¨çš„ä½16ä½ &#123;8&#123;æŒ‡ä»¤&#125;,4&#123;å¯„å­˜å™¨id&#125;,16&#123;å¸¸æ•°&#125;ï¼Œ4&#123;æ— æ„ä¹‰&#125;&#125;add r0,r1,r2 : r0 = r1 + r2 //æ•´æ•°åŠ æ³• &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;sub r0,r1,r2 : r0 = r1 - r2 //æ•´æ•°å‡æ³• &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;or r0,r1,r2 : r0 = r1 | r2 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;and r0,r1,r2 : r0 = r1 &amp; r2 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;not r0,r1 : r0 = ~r1 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,16&#123;æ— æ„ä¹‰&#125;&#125;sl r0,r1,r2 r0 = r1 &lt;&lt; r2 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;sr r0,r1,r2 : r0 = r1 &gt;&gt; r2 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,4&#123;r2å¯„å­˜å™¨id&#125;,12&#123;æ— æ„ä¹‰&#125;&#125;mt r0,r1,r2 : r0 = r1 &gt; r2 //æ¯”å¤§å° è¿”å›0æˆ–1 &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,16&#123;æ— æ„ä¹‰&#125;&#125;lt r0,r1,r2 : r0 = r1 &lt; r2//åŒä¸Š &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,16&#123;æ— æ„ä¹‰&#125;&#125;rd r0,r1 : r1 = *r0//è¯»å†…å­˜ &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,16&#123;æ— æ„ä¹‰&#125;&#125;wd r0,r1 : *r0 = r1//å†™å†…å­˜ &#123;8&#123;æŒ‡ä»¤&#125;ï¼Œ4&#123;r0å¯„å­˜å™¨id&#125;,4&#123;r1å¯„å­˜å™¨id&#125;,16&#123;æ— æ„ä¹‰&#125;&#125;if r0 :å¦‚æœr0ä¸ºé0ï¼Œåˆ™è·³è¿‡ä¸‹ä¸€æ¡æŒ‡ä»¤ è™½ç„¶æŒ‡ä»¤åªæœ‰çŸ­çŸ­14æ¡ï¼Œä½†ä¹Ÿå‡ ä¹èƒ½å¤Ÿå®Œæˆæ‰€æœ‰äº‹äº† æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å†™ä¸ªç®€å•çš„1+2+3+â€¦+100çš„ç¨‹åº cä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718int main() &#123; int all = 0; int i = 1; int j = 101; int k = 0;l1: k = i &lt; j; if (!k) goto l2; else all = all + i; i = i + 1; goto l1;l2: printf(&quot;%d&quot;, all);&#125; cä»£ç å¯¹åº”çš„æ±‡ç¼–ä»£ç æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233//0èµ·å§‹åœ°å€wl r0,0 //æ’ä¸º0wh r0,0wl r1,1 //æ’ä¸º1wh r1,0//ç´¯åŠ wl r2,0wh r2,0//iwl r3,1 wh r3,0//101wl r4,101 wh r4,0//kwl r5,0wh r5,0//åœ°å€16wl r6,16wh r6,0//åœ°å€22wl r7,22wh r7,0//åœ°å€16ï¼šlt r5,r3,r4if r5//å¦‚æœr3å°äºr4add r15,r7,r0add r2, r2, r3add r3,r3,r1add r15,r6,r0//åœ°å€22ï¼šwd r0,r2 å°†è¯¥æ±‡ç¼–ä»£ç ä¿å­˜è¿›â€demo.antâ€æ–‡ä»¶ä¸­ è¾“å…¥å‘½ä»¤ï¼š 12ant-asm demo.ant å³å¯å¾—åˆ° out.binå¯æ‰§è¡Œæ–‡ä»¶ å†æ‰§è¡ŒbinTotxt.pyè„šæœ¬ï¼ˆæ³¨æ„æ›´æ”¹é‡Œé¢çš„è·¯å¾„ï¼‰ å¾—åˆ°out.listå¡«å……æ–‡ä»¶ ä»¿çœŸtest.væ–‡ä»¶ï¼Œå°†out.listå†…å®¹å¡«å……è¿›rom è¿è¡Œ ä»¿çœŸæ•ˆæœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ­£ç¡®çš„ç®—å‡ºäº†5050è¿™ä¸ªå€¼ è¯´æ˜ä»£ç å’Œantå†…æ ¸æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -2ï¼šå¼€å‘æ¿åŠVerilogä»‹ç»","slug":"FPGA_/FPGA2","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA2/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA2/","excerpt":"å¼€å‘æ¿åŠverilogä»‹ç»","text":"å¼€å‘æ¿åŠverilogä»‹ç» æˆ‘ä»¬å°†ä½¿ç”¨sipeedå…¬å¸è®¾è®¡çš„tang permierå¼€å‘æ¿è¿›è¡Œå¼€å‘å­¦ä¹  è¿™æ¬¾å¼€å‘æ¿ä½¿ç”¨äº†å›½äº§EG4S20èŠ¯ç‰‡ æ‹¥æœ‰2ä¸‡å¤šä¸ªé€»è¾‘é—¨å•å…ƒ ä»·æ ¼ä»…100å¤šï¼Œæå…·æ€§ä»·æ¯” å¯ä»¥åœ¨ä¸Šé¢è·‘riscvå¼€æºæ¶æ„cpuæ ¸å¿ƒ å®Œå…¨å¤Ÿç”¨ IDEæˆ‘ä»¬ä½¿ç”¨å®˜æ–¹çš„å®‰è·¯TDè½¯ä»¶ è¯¦ç»†å®‰è£…è¿‡ç¨‹å¯å»sipeedæ–‡æ¡£ä¸ŠæŸ¥çœ‹ ä¸å¼€å‘ç¨‹åºç±»ä¼¼ å¼€å‘FPGAåŒæ ·æœ‰ç¼–ç¨‹è¯­è¨€ æ¯”å¦‚verilogï¼ŒVHDL è¿™é‡Œä½¿ç”¨verilogä½œä¸ºæ ¸å¿ƒå¼€å‘è¯­è¨€ å¦‚æœä½ å¯¹Cè¯­è¨€æœ‰ä¸€å®šçš„äº†è§£ï¼Œæœ‰åŠ©äºVerilogçš„å¿«é€Ÿä¸Šæ‰‹ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ 12345678910111213141516module top( input clk, output reg[15:0] out_cnt);initial begin out_cnt = 16&#x27;b0;endalways@(clk) begin if (out_cnt == 16&#x27;d250)begin out_cnt =0; end else begin out_cnt = out_cnt + 16&#x27;b1; endendendmodule verilogè¯­è¨€ä¸»è¦ä»¥æ¨¡å—ä¸ºå•ä½æ¥æè¿°ä¸€ä¸ªç”µè·¯ç»“æ„ æè¿°ç”µè·¯çš„æ–¹å¼æœ‰è¡Œä¸ºçº§æè¿°ï¼Œæ•°æ®æµæè¿°ï¼Œç»“æ„åŒ–æè¿° è¶Šå¾€åéš¾åº¦è¶Šé«˜ï¼Œæ›´æ¥è¿‘äºåŸå§‹ç”µè·¯è®¾è®¡ï¼Œä½†é€»è¾‘æ§åˆ¶è¶Šç®€å• verilogå°†å¤æ‚çš„ç”µè·¯åŠŸèƒ½æŠ½è±¡ä¸ºä¸€ä¸ªä¸ªæ¨¡å—(module) é€šè¿‡ç»„åˆä¸ªå„ä¸ªæ¨¡å—æ¥å®Œæˆä¸åŒçš„ç”µè·¯ å¹¶ä¸”verilogé‡‡ç”¨è‡ªé¡¶å‘ä¸‹çš„æ–¹å¼è¿›è¡Œç¨‹åºè®¾è®¡ ä¸€æ­¥æ­¥å®Œæˆå„ä¸ªæ¨¡å—å†è¿›è¡Œç»„åˆå³å®Œæˆä¸€ä¸ªåŸºæœ¬çš„FPGAé¡¹ç›®","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -3ï¼šç¯å¢ƒæ­å»º","slug":"FPGA_/FPGA3","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA3/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA3/","excerpt":"ç¯å¢ƒé…ç½®","text":"ç¯å¢ƒé…ç½® ç¯å¢ƒé…ç½®ï¼š å®‰è·¯FPGAçš„ç¯å¢ƒæ¯”è¾ƒå¥½æ­å»º ç›´æ¥å»sipeedä¸‹è½½ç«™ä¸­å³å¯ä¸‹è½½ å¦‚æœå‡ºç°æ²¡æœ‰licenseçš„æƒ…å†µ å‚åŠ è¿™ç¯‡å¸–å­ æ–°å»ºå·¥ç¨‹ï¼š è¿™æ˜¯å®‰è·¯TDå¼€å‘è½¯ä»¶çš„ç•Œé¢ æ–°å»ºé¡¹ç›®ç‚¹å‡»å·¦ä¸Šè§’èœå•çš„ â€œprojectâ€ å†ç‚¹å‡» â€œNew Projectâ€ é€‰æ‹©å¥½èŠ¯ç‰‡åï¼Œå°±å¯ç‚¹å‡»â€œOKâ€å»ºç«‹å·¥ç¨‹äº† æ¥ä¸‹æ¥å³é”®Hierarchyï¼Œé€‰æ‹©â€œæ–°å»ºæ–‡ä»¶ new sourceâ€ æ–‡ä»¶ç±»å‹é€‰æ‹©verilog æ–‡ä»¶åç§°å¯ä»¥éšæ„ æ–‡ä»¶ä¿å­˜åœ°å€é»˜è®¤åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ åŒæ—¶è¦å‹¾é€‰ â€œadd to projectâ€ è¿™æ ·æ‰èƒ½æ·»åŠ åˆ°å·¥ç¨‹å‚ä¸ç¼–è¯‘ æ­£ç¡®æ“ä½œåæ–°å»ºçš„æ–‡ä»¶åº”è¯¥å°±ä¼šè¢«æ·»åŠ åˆ°é¡¹ç›® å¹¶ä¸”æˆä¸º â€œtop moduleâ€ è¿™ä¸ªéå¸¸é‡è¦,verilogé‡‡ç”¨è‡ªé¡¶å‘ä¸‹çš„è®¾è®¡æ¨¡å¼ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½æœ‰ä¸€ä¸ª â€œtop moduleâ€ verilogç¼–è¯‘æ—¶æ˜¯ä»¥â€œtop moduleâ€å¼€å§‹çš„ æ¯”å¦‚ å½“ä½ å†æ·»åŠ ä¸€ä¸ªæ–‡ä»¶æ—¶ å°±ä¼šå‘ç°PLLæ–‡ä»¶å’Œstartæ–‡ä»¶çš„å›¾æ ‡ä¸åŒ æ­¤æ—¶ï¼Œstartä¸ºâ€œtop moduleâ€é¡¶å±‚æ¨¡å— è€ŒPLLä½œä¸ºä¸‹çº§æ¨¡å— å½“ç„¶ï¼Œå¯ä»¥å³é”®ä¸€ä¸ªæ¨¡å—é€‰æ‹© â€œset as topâ€ å°±å¯ä»¥æŠŠé€‰ä¸­çš„æ¨¡å—ä½œä¸ºé¡¶å±‚æ¨¡å—ï¼Œè€ŒåŸæ¥çš„é¡¶å±‚æ¨¡å—å°±ä¼šå˜ä¸ºä¸‹çº§æ¨¡å— ä¸€ä¸ªé¡¹ç›®å½“ä¸­ æœ‰ä¸”ä»…æœ‰ ä¸€ä¸ª â€œtop moduleâ€ å®‰è·¯TDè½¯ä»¶çš„ç¯å¢ƒé…ç½®å°±æ­¤ç»“æŸ","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -4ï¼šåˆæ­¥å…¥é—¨ç‚¹ä¸ªç¯","slug":"FPGA_/FPGA4","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA4/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA4/","excerpt":"ç‚¹ç¯","text":"ç‚¹ç¯ ç¯å¢ƒé…ç½®å¥½åå°±æ­£å¼è¿›å…¥verilogçš„å­¦ä¹ äº† å…ˆä»æœ€ç®€å•çš„ç‚¹ç¯å¼€å§‹ æˆ‘ä¼šå‘ä½ ä»¬ä»‹ç»æœ€åŸºç¡€çš„æ•°æ®ç±»å‹å’Œè¯­æ³•è§„åˆ™ ä»ç„¶æ˜¯ä»æˆ‘ä»¬ç†Ÿæ‚‰çš„ç•Œé¢å¼€å§‹ è½¬åˆ°é¡¶å±‚æ¨¡å— startä¸­ é¦–å…ˆï¼Œverilogéƒ½æ˜¯ä»¥æ¨¡å—ä¸ºå•ä½è¿›è¡Œç¼–ç¨‹ æ¨¡å—ä»¥ â€œmoduleâ€ â€œendmoduleâ€ ä½œä¸ºç•Œé™ å¦‚å›¾æ—¢æ˜¯å®šä¹‰ä¸€ä¸ªæ¨¡å—start,å³é¡¶å±‚æ¨¡å— å½“ç„¶ï¼Œå¯ä»¥å®šä¹‰å…¶å®ƒæ¨¡å—å†è®¾ç½®ä¸ºé¡¶å±‚æ¨¡å— é¦–å…ˆï¼Œä¸€ä¸ªç”µè·¯æ¨¡å—è‚¯å®šæœ‰è¾“å…¥è¾“å‡º è¿˜æœ‰å¯„å­˜å™¨ï¼Œé€»è¾‘æ§åˆ¶ä»€ä¹ˆçš„ å…ˆé™„ä¸Šç‚¹ç¯ä»£ç  1234567891011121314151617181920module start( input button,//æŒ‰é”®è¾“å…¥ output[2:0] led//3ä¸ªledè¾“å‡º );reg[2:0] dat=3&#x27;b111; //3ä¸ªledçš„çŠ¶æ€å¯„å­˜å™¨assign led = dat;//å°†å¯„å­˜å™¨çš„3ä¸ªå€¼è¿æ¥åˆ°ledè¾“å‡º//å½“æ£€æµ‹åˆ°æŒ‰é”®ä¸‹é™æ²¿æ—¶è§¦å‘always@(negedge button) begin //ä¸‹é¢ä¸cè¯­è¨€ç±»ä¼¼ //ä½†ä¹Ÿæœ‰å¾ˆå¤§çš„åŒºåˆ« if(dat == 3&#x27;b000)begin dat = 3&#x27;b111; end else begin dat = dat - 3&#x27;b1; endend//ç»“æŸendmodule è¿™é‡Œçœ‹ä¸æ‡‚æ²¡å…³ç³» åé¢å†æ…¢æ…¢è§£é‡Š å…ˆå°†è¿™äº›ä»£ç å†™å…¥é¡¶å±‚æ¨¡å— ç„¶åä¿å­˜ä¸€éï¼Œ æ³¨æ„ï¼šä¸€å®šè¦ä¿å­˜ï¼ï¼ æ—¢ç„¶æœ‰äº†ä»£ç ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•ç‚¹ç¯å‘¢ï¼Ÿ æ—¢ä¸åƒ51ç›´æ¥â€œled&#x3D;1â€ ä¹Ÿä¸ç›´æ¥æ“ä½œå¯„å­˜å™¨ è¿™é‡ŒFPGAé‡‡ç”¨äº†ä¸€ç§ç®¡è„šæ˜ å°„çš„æ–¹å¼ æ‰“å¼€TDè½¯ä»¶çš„â€œToolsâ€èœå•,ç‚¹å‡»â€œIO Constraintâ€ å³å¯çœ‹åˆ°å¼•è„šè®¾ç½®ç•Œé¢ å›¾æ­£ä¸­çš„å³èŠ¯ç‰‡ç®¡è„šå›¾ è€Œä¸‹é¢å°±ä¼šå‡ºç°æˆ‘ä»¬å®šä¹‰çš„å‡ ä¸ªè¾“å…¥è¾“å‡ºé€šé“ åˆ†åˆ«æ˜¯: button å¯¹åº”K16å¼•è„š led[0~2]åˆ†åˆ«å¯¹åº”R3ï¼ŒJ14ï¼ŒP13è¿™ä¸‰ä¸ªå¼•è„š ä»å¼€å‘æ¿çš„åŸç†å›¾ä¸­å¯ä»¥çœ‹åˆ° K16å¼•è„šå¯¹åº”â€œuserâ€æŒ‰é’® R3,J14,P13å¯¹åº”led_red,green,blue åˆ©ç”¨ç®¡è„šæ˜ å°„å³å¯å®ç°verilogæ¨¡å—å¯¹å¤–éƒ¨å¼•è„šçš„æ§åˆ¶ è®¾ç½®å¥½å¼•è„šåï¼Œå³å¯å…³é—­å¼•è„šç¼–è¾‘å™¨ å…³é—­æ—¶ï¼Œå®ƒä¼šæç¤ºä½ è¿›è¡Œä¿å­˜ï¼Œç‚¹å‡»ç¡®å®šï¼Œå¹¶ä¿å­˜å¼•è„šè®¾ç½®æ–‡ä»¶ æ­¤æ—¶ï¼Œä½ çš„é¡¹ç›®ä¸­å°±ä¼šå¤šå‡ºä¸€ä¸ª å¼•è„šè®¾ç½®æ–‡ä»¶ï¼šâ€œ.adcâ€ è¿™æ ·ï¼Œç‚¹ç¯ç¨‹åºå°±å®Œå…¨é…ç½®å®Œæˆäº† æ¥ä¸‹æ¥å°±æ˜¯ç¼–è¯‘ï¼Œçƒ§å½• ç‚¹å‡»æ­¤æŒ‰é’®è¿›è¡Œç¼–è¯‘ å¦‚æœæç¤ºï¼šæ²¡æœ‰license å‚åŠ è¿™ç¯‡å¸–å­ æ¥ä¸‹æ¥å°±æ˜¯çƒ§å½• ä½¿ç”¨micro-usbçº¿æ’ä¸Štang permier çƒ§å½•è¦æ›´æ–°é©±åŠ¨ å¦‚æœæ²¡æœ‰è¯¥è®¾å¤‡ é‚£ä¹ˆå¯èƒ½æ˜¯è¿™2ä¸ªä¸­çš„ä»»æ„ä¸€ä¸ª é€‰æ‹©æœ€å¯èƒ½æ˜¯tang permierçš„è®¾å¤‡ å³é”®-æ›´æ–°é©±åŠ¨ç¨‹åº-æµè§ˆæˆ‘çš„ç”µè„‘ä»¥æŸ¥æ‰¾é©±åŠ¨ç¨‹åº é€‰æ‹©å®‰è·¯TDè½¯ä»¶å®‰è£…ç›®å½•ä¸‹çš„driveré‡Œé€‰æ‹©æ­£ç¡®çš„é©±åŠ¨ æˆ‘çš„ç”µè„‘æ˜¯win10 64ä½ï¼Œå› æ­¤é€‰æ‹©win8_10_64é©±åŠ¨ ç‚¹å‡»ä¸‹ä¸€æ­¥è¿›è¡Œå®‰è£… é©±åŠ¨æ›´æ–°å®Œæˆå å†æ‰“å¼€å®‰è·¯TD ç‚¹å‡»æ­¤æŒ‰é’®è¿›å…¥çƒ§å½•ç•Œé¢ æ ¹æ®å›¾ç¤ºè¿›è¡Œçƒ§å½•å³å¯å®Œæˆ çƒ§å½•å®Œæˆå æŒ‰ä¸‹æ¿å­ä¸Šçš„useræŒ‰é’®ï¼Œå°±ä¼šå‘ç°ledå‡ºç°å˜æ¢é—ªçƒ ä¸»è¦è¿˜æ˜¯å› ä¸ºæŒ‰é”®æŠ–åŠ¨çš„åŸå› å¯¼è‡´æ—¶åºé”™è¯¯ è¿™ä¸ªå¯ä»¥ä¸ç”¨æ‹…å¿ƒèŠ¯ç‰‡æ˜¯å¦ä¼šæŸå","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -5ï¼šä»¿çœŸ","slug":"FPGA_/FPGA5","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA5/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA5/","excerpt":"ä»¿çœŸ","text":"ä»¿çœŸ åœ¨å®é™…FPGAå¼€å‘è¿‡ç¨‹ä¸­ æˆ‘ä»¬ä¸å¯èƒ½ç›´æ¥å°†ä»£ç çƒ§å½•è¿›æ¿å­é‡Œè¿›è¡Œæµ‹è¯• ä¸€æ˜¯æˆ‘ä»¬æ— æ³•è§‚å¯Ÿåˆ°å…¶å†…éƒ¨é€»è¾‘å˜æ¢ è€Œæ˜¯ä¸‡ä¸€ä»£ç ä¸­çš„é€»è¾‘æœ‰é—®é¢˜ ç›´æ¥è¿›è¡Œç”šè‡³ä¼šå¯¼è‡´èŠ¯ç‰‡æŸå æ¯•ç«ŸFPGAæ— æ³•åƒå•ç‰‡æœºé‚£æ ·å¯ä»¥åˆ©ç”¨ä¸²å£æ‰“å°ç­‰è°ƒè¯•æ–¹æ³• FPGAè°ƒè¯•åªèƒ½é ä»¿çœŸ ä¾ç„¶æ˜¯æ‹¿ä¹‹å‰æˆ‘ä»¬å†™çš„ç‚¹ç¯ä»£ç åšæµ‹è¯• é¦–å…ˆï¼Œä»¿çœŸéœ€è¦å®‰è£…modelsimä»¿çœŸå·¥å…· è¯¥è½¯ä»¶çš„å®‰è£…è¿™é‡Œä¸åšèµ˜è¿° è½¯ä»¶ã€ç¯å¢ƒå˜é‡éƒ½é…ç½®å¥½åå¼€å§‹ é¦–å…ˆFPGAä»¿çœŸéœ€è¦ä¸€ä¸ªæµ‹è¯•æ¨¡å— æˆ‘ä»¬å…ˆæ·»åŠ ä¸€ä¸ªæµ‹è¯•æ¨¡å— test.v åœ¨è¿›è¡Œä»¿çœŸæ—¶ï¼Œä»¿çœŸè½¯ä»¶å°±ä¼šæ¨¡æ‹Ÿè¿è¡Œtest.vè¿™ä¸ªæ¨¡å— ç‚¹ç¯ç¨‹åºä¸­ï¼Œæˆ‘ä»¬æœ‰3ä¸ªè¾“å‡ºå’Œ1ä¸ªè¾“å…¥ å› æ­¤åœ¨æ¨¡æ‹Ÿæ—¶æˆ‘ä»¬éœ€è¦ç»™ç›®æ ‡æ¨¡å—æä¾›ä¸€ä¸ªæ¨¡æ‹Ÿçš„è¾“å…¥ æˆ‘ä»¬ä½¿ç”¨å»¶æ—¶åŠŸèƒ½æ¥äº§ç”Ÿä¸€ä¸ªå›ºå®šé¢‘ç‡çš„è¾“å…¥ ç„¶åå°±æ˜¯å¯åŠ¨ä»¿çœŸ é€‰æ‹©å¦‚å›¾èœå• å†ç‚¹å‡» â€œBehavioral Simulatinâ€ å³è¡Œä¸ºçº§ä»¿çœŸ é€‰æ‹©æµ‹è¯•ä»£ç  å®ƒä¼šç”Ÿæˆmodelsimçš„ä»¿çœŸå‘½ä»¤è¡Œ æ‰“å¼€å‘½ä»¤è¡Œï¼Œä¾æ¬¡è¾“å…¥ä»¥ä¸Šå‰3æ¡æŒ‡ä»¤å³å¯å¯åŠ¨modelsim åœ¨modelsimæœ€ä¸‹é¢çš„å‘½ä»¤è¡Œä¸€ä¾æ¬¡è¾“å…¥ add wave * run 1ms ç„¶åé¼ æ ‡æŒ‡å‘ä»¿çœŸçª—å£ï¼ŒæŒ‰ä½ctrl+æ»šåŠ¨é¼ æ ‡æ»šè½® å°±èƒ½çœ‹è§ä»¿çœŸçš„æ³¢å½¢ å¯ä»¥å³é”®æŸä¸ªä¿¡å·ï¼Œæ¯”å¦‚outä¿¡å· é€‰æ‹©properties å°†radixè®¾ç½®ä¸ºâ€œunsignedâ€å³å¯é€‰æ‹©ä¿¡å·çš„æ•°æ®ç±»å‹ æ•ˆæœå¦‚ä¸‹ è¿™æ ·äºŒè¿›åˆ¶æ•°æ®å°±èƒ½ä»¥æ— ç¬¦å·æ•´æ•°æ˜¾ç¤º","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -6ï¼šç®€å•çš„ç»„åˆç”µè·¯","slug":"FPGA_/FPGA6","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.120Z","comments":true,"path":"1970/01/01/FPGA_/FPGA6/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA6/","excerpt":"ç®€å•çš„ç»„åˆç”µè·¯","text":"ç®€å•çš„ç»„åˆç”µè·¯ æ•°å­—ç”µè·¯å¯åˆ†ä¸º2å¤§ç±»ï¼š ç»„åˆç”µè·¯å’Œæ—¶åºç”µè·¯ ç»„åˆç”µè·¯çš„è¾“å‡ºåªå–å†³äºå®ƒçš„è¾“å…¥ å¹¶èƒ½å¤Ÿåœ¨ä¸€ç¬é—´å®Œæˆï¼Œä¸ä¹‹å‰çŠ¶æ€æ— å…³ æ—¶åºç”µè·¯åˆ™æ˜¯åœ¨æ—¶é’Ÿæ§åˆ¶ä¸‹æœ‰æ¡ç†çš„è¿è¡Œ å—æ—¶é’Ÿä¿¡å·å’Œè¾“å…¥çš„æ§åˆ¶ï¼Œä¸ä¹‹å‰çŠ¶æ€æœ‰å…³ ä¹‹å‰çš„ç‚¹ç¯ç¨‹åºå°±æ˜¯æ—¶åºç”µè·¯ ç°åœ¨æˆ‘ä»¬å…ˆä»ç»„åˆç”µè·¯å¼€å§‹å­¦ä¹  å†™ä¸€ä¸ªç®€å•çš„3-8è¯‘ç å™¨ æˆ‘ä»¬å·²ç»äº†è§£æ•°å­—ç”µè·¯çš„åŸºæœ¬ç»„æˆæ˜¯é€»è¾‘é—¨ï¼š ä¸é—¨ï¼Œæˆ–é—¨ï¼Œéé—¨ ç”±è¿™3ç§é€»è¾‘é—¨å³å¯ç»„æˆå„ç§å¤æ‚çš„é€»è¾‘ç”µè·¯ ç»„åˆé€»è¾‘ç”µè·¯ä¸€èˆ¬éƒ½æœ‰ä¸ªå”¯ä¸€ç¡®å®šçš„çœŸå€¼è¡¨ æˆ‘ä»¬è¦è®¾è®¡çš„3-8è¯‘ç å™¨çš„çœŸå€¼è¡¨å¦‚ä¸‹ è¾“å…¥ è¾“å‡º 000 00000001 001 00000010 010 00000100 011 00001000 100 00010000 101 00100000 110 01000010 111 10000010 è¡Œä¸ºçº§verilogä»£ç å¦‚ä¸‹ï¼š 123456789module start( input[2:0] in, output[7:0] out ); assign out = 8&#x27;b1 &lt;&lt; in;endmodule ä»¿çœŸæ³¢å½¢å¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œè¾“å…¥è¾“å‡ºç¬¦åˆæˆ‘ä»¬è®¾è®¡çš„çœŸå€¼è¡¨ ä½†ç”¨è¡Œä¸ºçº§æè¿°æ˜¯å¦è¿‡äºç®€å•ï¼Ÿ é‚£æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹é—¨çº§å»ºæ¨¡ ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223module start( input[2:0] in, output[7:0] out ); wire[2:0] nin;//éé—¨not(nin[0],in[0]);not(nin[1],in[1]);not(nin[2],in[2]);//æˆ–éé—¨nor(out[0],in[2],in[1],in[0]);nor(out[1],in[2],in[1],nin[0]);nor(out[2],in[2],nin[1],in[0]);nor(out[3],in[2],nin[1],nin[0]);nor(out[4],nin[2],in[1],in[0]);nor(out[5],nin[2],in[1],nin[0]);nor(out[6],nin[2],nin[1],in[0]);nor(out[7],nin[2],nin[1],nin[0]);endmodule ä»¿çœŸæ³¢å½¢å¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ° çœŸå€¼è¡¨ä¸é¢„æœŸä¸€æ ·","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸Š","slug":"FPGA_/FPGA7","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGA7/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA7/","excerpt":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸Š","text":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸Š ä¸Šä¸€èŠ‚æˆ‘ä»¬å­¦ä¹ äº†åŸºæœ¬çš„3-8è¯‘ç å™¨ç»„åˆç”µè·¯verilogå†™æ³• è¿™ä¸€æ¬¡æˆ‘ä»¬æ¥ç‚¹æœ‰éš¾åº¦çš„ï¼Œå†™ä¸€ä¸ªæ•´å‹å…¨åŠ å™¨ åœ¨æ­¤åŸºç¡€ä¸Šå†å†™ä¸€ä¸ªå•å‘¨æœŸæ— ç¬¦å·æ•´å‹ä¹˜æ³•å™¨ é¦–å…ˆä»ç®€å•çš„å¼€å§‹ï¼šåŠåŠ å™¨ åŠåŠ å™¨çœŸå€¼è¡¨ A B C 0 0 0 0 1 1 1 0 1 1 1 0 çœŸå€¼è¡¨å¯ä»¥å†™ä¸ºï¼š C &#x3D; A xor B å¯ä»¥çœ‹åˆ°åŠåŠ å™¨å°±æ˜¯2ä¸ª1ä½äºŒè¿›åˆ¶æ•°ç›¸åŠ  verilogè¡Œä¸ºçº§ä»£ç å¦‚ä¸‹ï¼š 123456789module Half_adder( input A, input B, output Y);assign Y = A + B;endmodule é—¨çº§ä»£ç å¦‚ä¸‹ï¼š 123456789module Half_adder( input A, input B, output Y);xor(Y,A,B);endmodule ä½†æ˜¯è¦æƒ³å®ç°8ä½ï¼Œ16ä½ï¼Œç”šè‡³32ä½çš„æ•´æ•°åŠ æ³•å•å•æ˜¯åŠåŠ å™¨æ— æ³•å®Œæˆçš„ å®é™…è¿ç®—è¿‡ç¨‹ç§ä¹Ÿæœ‰åŠ æ³•çš„è¿›ä½ï¼ŒåŠåŠ å™¨æ— æ³•ä¼ é€’è¿›ä½ä¿¡æ¯ æ‰€ä»¥æˆ‘ä»¬éœ€è¦ â€œå…¨åŠ å™¨â€ å…¨åŠ å™¨çœŸå€¼è¡¨ A B C(ä¸Šä¸€ä½è¿›ä½ä¿¡å·) D(å½“å‰è¿›ä½ä¿¡å·) Y 0 0 0 0 0 0 0 1 0 1 â€¦ â€¦ â€¦ â€¦ â€¦ 0 1 1 1 0 â€¦ â€¦ â€¦ â€¦ â€¦ 1 1 1 1 1 çœŸå€¼è¡¨å¯ä»¥å†™ä¸º: D &#x3D; (A and B) or (A and C) or (B and C)Y &#x3D; (A xor B) xor C è¡Œä¸ºçº§ä»£ç å¦‚ä¸‹: 1234567891011module Adder( input A, input B, input C, output D, output Y);assign &#123;D,Y&#125; = A+B+C;endmodule é—¨çº§ä»£ç å¦‚ä¸‹ 123456789101112131415161718module Adder( input A, input B, input C, output D, output Y);wire t1,t2,t3,t4;xor(t1,A,B);xor(Y,t1,C);and(t2,A,B);and(t3,A,C);and(t4,B,C);or(D,t2,t3,t4);endmodule ç”±äºç¯‡å¹…åŸå› ï¼Œä¸‹ä¸€ç¯‡å†ä»‹ç»åŠ æ³•å™¨å’Œä¹˜æ³•å™¨çš„å†™æ³•","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸‹","slug":"FPGA_/FPGA8","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGA8/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA8/","excerpt":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸‹","text":"FPGAå­¦ä¹ -7ï¼šè¾ƒä¸ºå¤æ‚çš„ç»„åˆç”µè·¯ ä¸‹ ä¹‹å‰æˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•å†™ä¸€ä¸ªå…¨åŠ å™¨ æœ‰äº†å…¨åŠ å™¨æˆ‘ä»¬å°±èƒ½åˆ¶é€ å‡º16ä½åŠ æ³•å™¨ç­‰ä¼—å¤šè¿ç®—å™¨ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å†™ä¸ªåŠ æ³•å™¨å’Œä¹˜æ³•å™¨ ç®€å•çš„8ä½åŠ æ³•å™¨å¦‚ä¸‹ï¼š 1234567891011121314151617181920module Adder8( input[7:0] Ai, input[7:0] Bi, input Ci, output Do, output[7:0] Yo);wire[6:0] ds;//8ä¸ªå…¨åŠ å™¨Adder A0(Ai[0],Bi[0],0,ds[0],Yo[0]);Adder A1(Ai[1],Bi[1],ds[0],ds[1],Yo[1]);Adder A2(Ai[2],Bi[2],ds[1],ds[2],Yo[2]);Adder A3(Ai[3],Bi[3],ds[2],ds[3],Yo[3]);Adder A4(Ai[4],Bi[4],ds[3],ds[4],Yo[4]);Adder A5(Ai[5],Bi[5],ds[4],ds[5],Yo[5]);Adder A6(Ai[6],Bi[6],ds[5],ds[6],Yo[6]);Adder A7(Ai[7],Bi[7],ds[6],Do,Yo[7]);endmodule å¦‚æœè§‰å¾—è¿™æ ·å†™å¤ªéº»çƒ¦ å¯ä»¥ä½¿ç”¨ â€œæ‰¹é‡ä¾‹åŒ–â€ 123456789101112131415161718192021module Adder8( input[7:0] Ai, input[7:0] Bi, input Ci, output Do, output[7:0] Yo);wire[6:0] ds;Adder A0(Ai[0],Bi[0],0,ds[0],Yo[0]);genvar i;generate for(i=1;i&lt;=6;i=i+1) begin Adder As(Ai[i],Bi[i],ds[i-1],ds[i],Yo[i]); endendgenerate Adder A7(Ai[7],Bi[7],ds[6],Do,Yo[7]);endmodule ä¹˜æ³•å™¨å‡†å¤‡!!!æœ‰äº†åŠ æ³•å™¨ï¼Œæˆ‘ä»¬å°±èƒ½å®ç°å„ç§çš„æ•°å­¦è¿ç®— åŒ…æ‹¬ä¹˜æ³• ä¹˜æ³•çš„æ€æƒ³å¾ˆç®€å•ï¼šç§»ä½ç›¸åŠ  å°±è·Ÿæˆ‘ä»¬æ‹¿ç¬”ç®—çš„æ€è·¯ä¸€æ · åˆ¶ä½œ8ä½ä¹˜æ³•å™¨çš„è¾“å‡ºç»“æœæœ€å¤§æœ‰åå…­ä½ æ‰€ä»¥æˆ‘ä»¬éœ€è¦16ä½åŠ æ³•å™¨,16ä½åŠ æ³•å™¨çš„ä»£ç è¿™é‡Œä¸åšä»‹ç»ï¼Œç…§è‘«èŠ¦ç”»ç“¢å³å¯ ç”±äºæˆ‘ä»¬è®²çš„æ˜¯ç»„åˆç”µè·¯ æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªå•å‘¨æœŸ16ä½ä¹˜æ³•å™¨ ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031module MUL16( input[7:0] Ai, input[7:0] Bi, output[15:0] Yo );wire[15:0] a[8:0] ; assign a[0] = Bi[0] ? &#123;8&#x27;d0,Ai&#125; : 16&#x27;d0;assign a[1] = Bi[1] ? &#123;7&#x27;d0,Ai,1&#x27;d0&#125; : 16&#x27;d0;assign a[2] = Bi[2] ? &#123;6&#x27;d0,Ai,2&#x27;d0&#125; : 16&#x27;d0;assign a[3] = Bi[3] ? &#123;5&#x27;d0,Ai,3&#x27;d0&#125; : 16&#x27;d0;assign a[4] = Bi[4] ? &#123;4&#x27;d0,Ai,4&#x27;d0&#125; : 16&#x27;d0;assign a[5] = Bi[5] ? &#123;3&#x27;d0,Ai,5&#x27;d0&#125; : 16&#x27;d0;assign a[6] = Bi[6] ? &#123;2&#x27;d0,Ai,6&#x27;d0&#125; : 16&#x27;d0;assign a[7] = Bi[7] ? &#123;1&#x27;d0,Ai,7&#x27;d0&#125; : 16&#x27;d0;wire d[7:0];wire[15:0] out[6:0];Adder16 A0(a[0],16&#x27;d0,0,d[0],out[0]);Adder16 A1(a[1],out[0],d[0],d[1],out[1]);Adder16 A2(a[2],out[1],d[1],d[2],out[2]);Adder16 A3(a[3],out[2],d[2],d[3],out[3]);Adder16 A4(a[4],out[3],d[3],d[4],out[4]);Adder16 A5(a[5],out[4],d[4],d[5],out[5]);Adder16 A6(a[6],out[5],d[5],d[6],out[6]);Adder16 A7(a[7],out[6],d[6],d[7],Yo);endmodule å½“ç„¶åˆ©ç”¨verilogè¯­è¨€çš„ç‰¹æ€§å®é™…ä¸Šæ²¡å¿…è¦è¿™æ ·å†™ ä½†æ˜¯è¿™æ ·å­¦ä¹ FPGAä¼šæ›´åŠ ç›´è§‚çš„çœ‹åˆ°ç”µè·¯çš„é€»è¾‘ç»“æ„","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAè¿›é˜¶ï¼šæ‰‹æ’¸ç¥ç»ç½‘ç»œ","slug":"FPGA_/FPGAè¿›é˜¶1","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGAè¿›é˜¶1/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA%E8%BF%9B%E9%98%B61/","excerpt":"æ‰‹æ’¸ç¥ç»ç½‘ç»œ","text":"æ‰‹æ’¸ç¥ç»ç½‘ç»œ è¿›è¿‡äº†ä¹‹å‰çš„åŸºç¡€å­¦ä¹ ï¼Œæƒ³å¿…å¤§å®¶åº”è¯¥å¯¹verilogæœ‰äº†ä¸ªæ¯”è¾ƒæ¸…æ™°çš„è®¤è¯† é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥æ’¸ä¸ªç¥ç»ç½‘ç»œå§ï¼ é¦–å…ˆæ¥ä»‹ç»ä¸€ä¸‹è¯¥ç¥ç»ç½‘ç»œçš„è§„æ ¼ï¼šä½¿ç”¨IEEEæ ‡å‡†çš„32ä½æµ®ç‚¹æ•°è¿ç®— ç½‘ç»œå¤§å°ä¸º3*3*3 æ¿€æ´»å‡½æ•°ä½¿ç”¨relu ç¥ç»ç½‘ç»œä¸ºå›ºå®šç»“æ„ ä½¿ç”¨ç»„åˆç”µè·¯ï¼Œè¿™æ„å‘³ç€åªè¦è¾“å…¥ä¸€ä¸ªæ•°æ®å°±èƒ½ç¬é—´å‡ºæ¥ç»“æœ æ‰€æœ‰çš„ç”µè·¯æ¨¡å—å‡ä¸ºç»„åˆé€»è¾‘ ä½¿ç”¨åˆ°çš„åŸºæœ¬èµ„æºï¼š æµ®ç‚¹è¿ç®—å™¨ï¼Œæµ®ç‚¹ä¹˜æ³•å™¨ï¼Œæµ®ç‚¹åŠ æ³•å™¨ï¼Œæ¿€æ´»å‡½æ•°è¿ç®—å™¨ ç‰¹åˆ«æ³¨æ„ï¼šæ‰€æœ‰çš„æ•°æ®ç±»å‹å‡ä¸ºå•ç²¾åº¦æµ®ç‚¹æ•° é¦–å…ˆæ˜¯æ¿€æ´»å‡½æ•°è¿ç®—æ¨¡å— 12345678module Act_Func( input[31:0] Xi, output[31:0] Yo);assign Yo = Xi[31] ? 32&#x27;d0 : Xi;endmodule æµ®ç‚¹è¿ç®—å•å…ƒï¼š æµ®ç‚¹è¿ç®—å•å…ƒæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œä¸è´´ä»£ç ï¼Œ 12FPU_ADD(a,b,y);FPU_MUL(a,b,y); äººå·¥ç¥ç»å…ƒæ¨¡å—ï¼š 12345678910111213141516171819202122module Neural( input[3*32-1:0] Xi, input[3*32-1:0] Ws,//æƒé‡ input[31:0] B,//åæ‰§ output[31:0] Yo);wire[31:0] o[2:0];FPU_MUL f1(Xi[0*32+32-1:0*32],Ws[0*32+32-1:0*32],o[0]);FPU_MUL f2(Xi[1*32+32-1:1*32],Ws[1*32+32-1:1*32],o[1]);FPU_MUL f3(Xi[2*32+32-1:2*32],Ws[2*32+32-1:2*32],o[2]);wire[31:0] t[1:0],f;FPU_ADD f4(o[0],o[1],t[0]);FPU_ADD f5(o[2],t[0],t[1]);FPU_ADD f6(B,t[1],f);Act_Func act(f,Yo);endmodule ç¥ç»ç½‘ç»œå±‚ï¼š 12345678910111213module Layer( input[3*32-1:0] Xi, input[3*3*32-1:0] Ws, input[3*32-1:0] Bs, output[3*32-1:0] Yo); Neural n1(Xi,Ws[0*3*32+3*32-1:0*3*32],Bs[0*32+32-1:0*32],Yo[0*32+32-1:0*32]);Neural n2(Xi,Ws[1*3*32+3*32-1:1*3*32],Bs[1*32+32-1:1*32],Yo[1*32+32-1:1*32]);Neural n3(Xi,Ws[2*3*32+3*32-1:2*3*32],Bs[2*32+32-1:2*32],Yo[2*32+32-1:2*32]);endmodule ç¥ç»ç½‘ç»œï¼š 1234567891011121314151617181920212223242526272829303132333435//3*3*3çš„ç¥ç»ç½‘ç»œmodule NetWork( input[3*32-1:0] Xi, output[3*32-1:0] Yo );reg[3*3*3*32-1:0] ws = &#123;32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC&#125;;reg[3*3*32-1:0] bs =&#123;32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC,32&#x27;h3DCCCCCC&#125;;wire[3*32-1:0] cen[1:0];Layer l1(Xi,ws[0*3*3*32+3*3*32-1:0*3*3*32],bs[0*3*32+3*32-1:0*3*32],cen[0]);Layer l2(cen[0],ws[1*3*3*32+3*3*32-1:1*3*3*32],bs[1*3*32+3*32-1:1*3*32],cen[1]);Layer l3(cen[1],ws[2*3*3*32+3*3*32-1:2*3*3*32],bs[2*3*32+3*32-1:2*3*32],Yo);endmodule ä¸‹é¢æ˜¯ä»¿çœŸç»“æœå’Œç”µè„‘è¿è¡Œç»“æœï¼š å—¯ï¼Œè¾“å‡ºç»“æœå®Œå…¨ä¸€æ · å—¯ï¼Œçœ‹ç€æ˜¯ä¸æ˜¯éå¸¸nbå‘¢ï¼Œç”±äºä½¿ç”¨äº†ç»„åˆç”µè·¯ å› æ­¤è¿™ä¸ªæ¨¡å—åªè¦è¾“å…¥æ•°æ®å°±èƒ½ç¬é—´è¾“å‡ºæ•°æ® ä½†ç”±äºæ˜¯å›ºå®šçš„ï¼Œå†™æ­»äº†çš„ç¥ç»ç½‘ç»œï¼Œæ‰€ä»¥å®ƒçš„æ­å»ºååˆ†éº»çƒ¦ å®Œæ•´ä»£ç click me","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAå­¦ä¹ -8ï¼šç®€å•çš„æ—¶åºç”µè·¯","slug":"FPGA_/FPGA9","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGA9/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA9/","excerpt":"ç®€å•çš„æ—¶åºç”µè·¯","text":"ç®€å•çš„æ—¶åºç”µè·¯ ç»è¿‡ä¸Šä¸€ç« çš„äº†è§£ ç»„åˆç”µè·¯çš„æœ€å¤§ä¼˜åŠ¿å°±æ˜¯èƒ½ç›´æ¥æ ¹æ®è¾“å…¥è¿›è¡Œè¾“å‡º ä½†å…¶ä¹Ÿæœ‰å¾ˆå¤šçš„ç¼ºç‚¹ï¼šå å¤§é‡çš„ç”µè·¯èµ„æºï¼ŒåŠŸè€—è¾ƒå¤§ï¼Œç”µè·¯å›ºå®šâ€¦ è¿™ä¸€æ¬¡æˆ‘ä»¬æ¥è®²åŸºæœ¬çš„æ—¶åºç”µè·¯ï¼Œå†™ä¸€ä¸ªç®€å•çš„æ—¶åºæ§åˆ¶ç”µè·¯ å†åœ¨æ­¤åŸºç¡€ä¸Šå°†ä¹‹å‰çš„ç»„åˆç”µè·¯ä¹˜æ³•å™¨æ”¹æˆæ—¶åºç”µè·¯ é¦–å…ˆæˆ‘ä»¬è¦æ¥äº†è§£ä¸‹å®‰è·¯FPGAçš„æ—¶é’Ÿä¿¡å· å®‰è·¯FPGAçš„å¤–éƒ¨24Mhzæ™¶æŒ¯ä¿¡å·ç”±k14å·å¼•è„šæä¾› ä½¿ç”¨ â€œIO Constraintâ€ å¼•è„šæ˜ å°„å·¥å…· å°†veilogæ¨¡å—çš„æŸä¸€è¾“å…¥ç«¯å£æ˜ å°„åˆ°k14å¼•è„šä¸Šå³å¯å¾—åˆ°24Mhzçš„æ—¶é’Ÿä¿¡å· å…ˆæ¥è®¾è®¡ä¸ªç®€å•çš„ â€œå¯å˜åˆ†é¢‘å™¨â€ ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455module Start( input clk, input button, output[2:0] led);reg[31:0] pll,cnt;reg[2:0] out;assign led = ~out;initial begin pll = 32&#x27;d24000000; cnt = 32&#x27;d0; out = 3&#x27;b001;endalways @(posedge clk )begin if(cnt &lt;= pll) begin cnt = cnt + 32&#x27;d1; end else begin cnt = 32&#x27;d0; out = out &lt;&lt; 1; if(out == 3&#x27;d0)begin out = 3&#x27;b001; end end endinteger i=1;always @(posedge button)begin case(i) 1:begin i=2; pll=32&#x27;d12000000; end 2:begin i=3; pll=32&#x27;d6000000; end 3:begin i=1; pll=32&#x27;d24000000; end endcaseend endmodule å¼•è„šæ˜ å°„å¦‚ä¸‹ï¼š æ­£å¸¸ç¼–è¯‘å†çƒ§å½•è¿›tang perimeré‡Œï¼Œledå°±ä¼šäº¤é”™é—ªçƒ æŒ‰ä¸‹useræŒ‰é”®ï¼Œé—ªçƒçš„é¢‘ç‡å°±ä¼šå‘ç”Ÿæ”¹å˜ è¿™æœ€ç®€å•çš„åˆ†é¢‘å™¨è®¾è®¡ æ¥ä¸‹æ¥æˆ‘ä»¬å†å°è¯•å°†ä¸Šä¸€èŠ‚ä¸­çš„ç»„åˆç”µè·¯å•å‘¨æœŸä¹˜æ³•å™¨æ”¹é€  å˜æˆæ—¶åºç”µè·¯å¤šå‘¨æœŸä¹˜æ³•å™¨ é¢ï¼Œå°±ä¸è¦è¯´ä»€ä¹ˆå¤šæ­¤ä¸€ä¸¾äº† æˆ‘ä»¬çš„ç›®çš„æ˜¯å­¦ä¹  ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738module Mul( input clk, //æ—¶é’Ÿä¿¡å· input rst, //å¤ä½ä¿¡å· output reg flag,//æ˜¯å¦å®Œæˆä¿¡å· input[7:0] Ai, input[7:0] Bi, output reg[15:0] result); reg[15:0] bi;initial begin bi = &#123;8&#x27;d0,Bi&#125;; flag = 0; result= 0;end integer i=0;always @(posedge clk or posedge rst) begin if(rst == 1)begin bi = Bi; flag = 0; result = 0; i=0; end else if(flag == 0)begin result = result + (Ai[i] ? bi:0); bi = bi &lt;&lt; 1; i = i + 1; if(i&gt;=8)begin flag = 1; end endend endmodule å¯ä»¥çœ‹åˆ°æ—¶åºé€»è¾‘ä¼šæ¯”ç»„åˆé€»è¾‘å¤æ‚å¾—å¤š ä½†æ˜¯ä¹Ÿæ­£æ˜¯å› ä¸ºæ—¶åºç”µè·¯çš„â€œè®°å¿†æ€§â€ è®©cpuè¿™ç±»å¤æ‚çš„è¿ç®—ç”µè·¯å¾—ä»¥å®ç°","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAè¿›é˜¶ï¼šçŠ¶æ€æœºç»“æ„","slug":"FPGA_/FPGAè¿›é˜¶2","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGAè¿›é˜¶2/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA%E8%BF%9B%E9%98%B62/","excerpt":"æ— ","text":"æ—  åœ¨FPGAç¼–ç¨‹ä¸­ ç”±äºFPGAæœ¬èº«ä¸èƒ½åƒcè¯­è¨€é‚£æ ·é¡ºåºæ‰§è¡Œ ä¹Ÿæ²¡æœ‰å„ç§æ–¹ä¾¿å‡½æ•°å¯ä»¥è°ƒç”¨ åœ¨è®¾è®¡FPGAé¡ºåºæ‰§è¡Œæ—¶å°±ä¼šæœ‰å¾ˆå¤§çš„å›°éš¾ å› æ­¤è¿™é‡Œä»‹ç»FPGAçš„çŠ¶æ€æœºæœºåˆ¶ çŠ¶æ€æœºç»“æ„å‡ ä¹å¯ä»¥ç”¨äºæ‰€æœ‰çš„æ•°å­—é€»è¾‘å½“ä¸­ å¤§å¤§å‡å°äº†å¼€å‘éš¾åº¦ ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é¡ºåºå¾ªç¯çŠ¶æ€æœº å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿcè¯­è¨€ç»“æ„ä¸­çš„ â€œwhile(1)â€ å¾ªç¯ verilogä»£ç æ¼”ç¤ºï¼š 12345678910111213141516171819202122232425262728module test ( input clk, output reg[3:0] line); integer tag = 0; always @(posedge clk) begin case(tag) 0:begin line=4&#x27;b0001; tag = 1; end 1:begin line=4&#x27;b0010; tag = 2; end 2:begin line=4&#x27;b0100; tag = 3; end 3:begin line=4&#x27;b1000; tag = 0; end endcase end endmodule å…¶ä¸­tagç”¨äºçŠ¶æ€æŒ‡ç¤ºå™¨ clkæ—¶é’Ÿä¿¡å·ä½œä¸ºè¿è¡ŒèŠ‚æ‹ åœ¨è¿™ç§åŸºæœ¬çŠ¶æ€æœºåŸºç¡€ä¸Šå¯ä»¥è¡ç”Ÿå‡ºå…¶å®ƒçŠ¶æ€æœº è¿™é‡Œåˆ©ç”¨çŠ¶æ€æœºæ¥è®¾è®¡ä¸€ä¸ªçŸ³å¤´å‰ªåˆ€å¸ƒå°æ¸¸æˆ çŠ¶æ€æœºç»“æ„å¦‚ä¸‹ verilogä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384module test ( input clk, input[2:0] a, input[2:0] b, output reg a_light, output reg b_light); integer tag = 0; integer G ; always @(posedge clk) begin case(tag) 0:begin G=10; tag = 1; a_light=0; b_light=0; end 1:begin//æ¯”è¾ƒ if(a&gt;b)begin tag = 2; end else if(a&lt;b) begin tag = 3; end else begin tag = 4; end end 2:begin//aèµ¢ G = G + 1; tag = 5; end 3:begin//bèµ¢ G = G - 1; tag = 6; end 4:begin//å¹³ if(G&gt;10)begin G = G - 1; end else if(G&lt;10) begin G = G + 1; end tag = 9; end 5:begin if(G &gt;= 20)begin tag = 7; end else begin tag = 1; end end 6:begin if(G &lt;= 0)begin tag = 8; end else begin tag = 1; end end 7:begin//äº®aç¯ a_light=1; b_light=0; tag = 0; end 8:begin//äº®bç¯ a_light=0; b_light=1; tag = 0; end 9:begin//äº®abç¯ a_light=1; b_light=1; tag = 1 ; end endcase end endmodule","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGAè¿›é˜¶ï¼šæµæ°´çº¿ç»“æ„","slug":"FPGA_/FPGAè¿›é˜¶3","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.121Z","comments":true,"path":"1970/01/01/FPGA_/FPGAè¿›é˜¶3/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/FPGA_/FPGA%E8%BF%9B%E9%98%B63/","excerpt":"æ— ","text":"æ—  äº†è§£äº†çŠ¶æ€æœºç»“æ„ï¼Œæ¥ä¸‹æ¥å°±æ¥å­¦ä¹ æ›´åŠ é«˜çº§çš„æµæ°´çº¿ç»“æ„ çŠ¶æ€æœºç»“æ„çš„å¥½å¤„æ˜¯ç®€å•æ–¹ä¾¿ï¼Œä½†æ˜¯ç»¼åˆå‡ºæ¥çš„ç”µè·¯æ—¶åºä¸é«˜ ä¹Ÿå°±æ˜¯å¾ˆéš¾é«˜é¢‘å·¥ä½œï¼Œå› ä¸ºåœ¨ä¸€ä¸ªæ—¶é’Ÿé‡Œè¦è¿›è¡Œå¤šæ¬¡åˆ¤æ–­åŒ¹é… è™½ç„¶ä»£ç çœ‹ä¸Šå»å¾ˆç®€å•ï¼Œä½†æ˜¯ç»¼åˆå‡ºæ¥çš„ç”µè·¯ååˆ†å†—æ‚ é€šå¸¸ç”¨äºæ—¶åºè¦æ±‚ä¸é«˜ç®€å•çš„ç”µè·¯ æµæ°´çº¿åˆ™ä¸ä¹‹ç›¸å æµæ°´çº¿å°†ä¸€ä¸ªå·¥ä½œæ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ æ¯ä¸ªå°ä»»åŠ¡æ‰§è¡Œèµ·æ¥ååˆ†ç®€å•å¿«é€Ÿ æ¯ä¸ªå°ä»»åŠ¡å°±æ˜¯ä¸€ä¸ªå°æ¨¡å— è¿™æ ·æœ‰åˆ©äºæ—¶åºï¼Œä½†æ˜¯ä¼šå¢åŠ ç”µè·¯é¢ç§¯å’Œå¤æ‚åº¦ æœ€å¸¸è§çš„å°±å±cpuç”µè·¯ï¼Œé¢‘ç‡åŠ¨è¾„ä¸ŠGhz ä¸‹é¢æ˜¯ä¸€ä¸ªç»å…¸çš„5çº§æµæ°´çº¿cpuè¿è¡Œæ—¶åº æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä½¿ç”¨æµæ°´çº¿ç»“æ„å®ç°ä¸€ä¸ªç®€å•çš„æ•´æ•°ä¹˜æ³•å™¨ ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142module mul_cell #(parameter N=4, parameter M=4 )( input clk, //æ—¶é’Ÿä¿¡å· input rstn, //å¤ä½ä¿¡å· input en, //ä½¿èƒ½ä¿¡å· input[M+N-1:0] mult1, //è¢«ä¹˜æ•° input[M-1:0] mult2, //ä¹˜æ•° input[M+N-1:0] mult1_acci, //ä¸Šæ¬¡ç´¯åŠ ç»“æœ output reg[M+N-1:0] mult1_o, //è¢«ä¹˜æ•°ç§»ä½åä¿å­˜å€¼ output reg[M-1:0] mult2_shift, //ä¹˜æ•°ç§»ä½åä¿å­˜å€¼ output reg[N+M-1:0] mult1_acco, //å½“å‰ç´¯åŠ ç»“æœ output reg rdy //é¢„å¤‡ä¿¡å· ); always @(posedge clk or negedge rstn) begin if (!rstn) begin rdy &lt;= &#x27;b0 ; mult1_o &lt;= &#x27;b0 ; mult1_acco &lt;= &#x27;b0 ; mult2_shift &lt;= &#x27;b0 ; end else if (en) begin rdy &lt;= 1&#x27;b1 ; mult2_shift &lt;= mult2 &gt;&gt; 1 ; mult1_o &lt;= mult1 &lt;&lt; 1 ; if (mult2[0]) begin //ä¹˜æ•°å¯¹åº”ä½ä¸º1åˆ™ç´¯åŠ  mult1_acco &lt;= mult1_acci + mult1 ; end else begin mult1_acco &lt;= mult1_acci ; //ä¹˜æ•°å¯¹åº”ä½ä¸º1åˆ™ä¿æŒ end end else begin rdy &lt;= &#x27;b0 ; mult1_o &lt;= &#x27;b0 ; mult1_acco &lt;= &#x27;b0 ; mult2_shift &lt;= &#x27;b0 ; end endendmodulemodule mul_main #(parameter N=4,//ä¹˜æ•°1ä½æ•° parameter M=4//ä¹˜æ•°2ä½æ•° )( input clk, input rstn, input data_rdy , input[N-1:0] mult1, input[M-1:0] mult2, output res_rdy, output[N+M-1:0] res //è¾“å‡º ); wire [N+M-1:0] mult1_t [M-1:0] ; wire [M-1:0] mult2_t [M-1:0] ; wire [N+M-1:0] mult1_acc_t [M-1:0] ; wire [M-1:0] rdy_t ; //ç¬¬ä¸€æ¬¡ä¾‹åŒ–ç›¸å½“äºåˆå§‹åŒ–ï¼Œä¸èƒ½ç”¨ generate è¯­å¥ mul_cell #( .N(N), .M(M) ) u_mult_step0( .clk (clk), .rstn (rstn), .en (data_rdy), .mult1 (&#123;&#123;(M)&#123;1&#x27;b0&#125;&#125;, mult1&#125;), .mult2 (mult2), .mult1_acci (&#123;(N+M)&#123;1&#x27;b0&#125;&#125;), //output .mult1_acco (mult1_acc_t[0]), .mult2_shift (mult2_t[0]), .mult1_o (mult1_t[0]), .rdy (rdy_t[0]) ); //å¤šæ¬¡æ¨¡å—ä¾‹åŒ–ï¼Œç”¨ generate è¯­å¥ genvar i; generate for(i=1; i&lt;=M-1; i=i+1) begin mul_cell #( .N(N), .M(M) ) u_mult_step( .clk(clk), .rstn(rstn), .en(rdy_t[i-1]), .mult1(mult1_t[i-1]), .mult2(mult2_t[i-1]), //ä¸Šä¸€æ¬¡ç´¯åŠ ç»“æœä½œä¸ºä¸‹ä¸€æ¬¡ç´¯åŠ è¾“å…¥ .mult1_acci(mult1_acc_t[i-1]), //output .mult1_acco(mult1_acc_t[i]), .mult1_o(mult1_t[i]), //è¢«ä¹˜æ•°ç§»ä½çŠ¶æ€ä¼ é€’ .mult2_shift(mult2_t[i]), //ä¹˜æ•°ç§»ä½çŠ¶æ€ä¼ é€’ .rdy(rdy_t[i]) ); end endgenerate assign res_rdy = rdy_t[M-1]; assign res = mult1_acc_t[M-1];endmodule`timescale 1ps/1psmodule test (); reg clk=0; reg[7:0] A=0; reg[7:0] B=0; always begin #1 clk = ~clk; end always @(posedge clk) begin A = A + 1; B = B + 2; end wire[15:0] C; wire rdy; mul_main #( .N(8), .M(8) ) mul( .clk(clk), .rstn(1&#x27;b1), .data_rdy(1&#x27;b1), .mult1(A), .mult2(B), .res_rdy(rdy), .res(C) );endmodule ä»¿çœŸå¦‚ä¸‹ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸€å¼€å§‹éš”äº†å‡ ä¸ªæ—¶é’Ÿå‘¨æœŸå ä¹˜æ³•ç»“æœå¼€å§‹ä»¥æµæ°´å½¢å¼è¾“å‡ºï¼Œæ•ˆç‡éå¸¸é«˜ æµæ°´çº¿çš„ä¼˜ç‚¹ä¸è¨€è€Œå–»","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨1","slug":"RISCV/RISCV-CORE1","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.122Z","comments":true,"path":"1970/01/01/RISCV/RISCV-CORE1/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RISCV-CORE1/","excerpt":"ä»é›¶å¼€å§‹è®¾è®¡ä¸€ä¸ªriscvå†…æ ¸","text":"ä»é›¶å¼€å§‹è®¾è®¡ä¸€ä¸ªriscvå†…æ ¸ æœ¬ç« èŠ‚å°†è‡´åŠ›äºä½¿ç”¨verilogè®¾è®¡å‡ºä¸€ä¸ªç®€å•çš„5çº§æµæ°´çº¿rv32iå†…æ ¸ å¯¹äºriscvä¸äº†è§£çš„å¯ä»¥å»riscvå®˜ç½‘ è‡ªè¡Œä¸‹è½½ç›¸å…³æ–‡æ¡£é˜…è¯» æ–°æ‰‹å¯ä»¥å»é˜…è¯»å›½å†…å¤§ç‰›èƒ¡æŒ¯æ³¢æ‰€ç¼–å†™çš„ã€Šæ‰‹æŠŠæ‰‹æ•™ä½ è®¾è®¡cpu-riscvå¤„ç†å™¨ã€‹ å…ˆå¯¹riscvæŒ‡ä»¤é›†æœ‰å‡ ä¸ªå¤§æ¦‚çš„äº†è§£ åŒ…æ‹¬åŸºæœ¬rv32iæŒ‡ä»¤ æŒ‡ä»¤ç¼–ç æ–¹å¼ã€è®¾è®¡æ€æƒ³ ç„¶åè¦æœ‰å¿…è¦çš„ç¼–ç¨‹çŸ¥è¯†å’Œæ•°ç”µåŸºç¡€ verilogè®¾è®¡çŸ¥è¯†å¯ä»¥å»çœ‹ä¹‹å‰çš„verilogæ•™ç¨‹ verilogä»¿çœŸè½¯ä»¶ä½¿ç”¨modelsim","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨2","slug":"RISCV/RISCV-CORE2","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.122Z","comments":true,"path":"1970/01/01/RISCV/RISCV-CORE2/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RISCV-CORE2/","excerpt":"FPGA-RISCVå†…æ ¸å…¥é—¨","text":"FPGA-RISCVå†…æ ¸å…¥é—¨ é¦–å…ˆæ¥äº†è§£ä¸‹åŸºæœ¬çš„rv32iæŒ‡ä»¤é›†åŠå…¶ç¼–ç  æ ¹æ®ç¼–ç æ–¹å¼çš„ä¸åŒå¤§è‡´å¯ä»¥å°†æŒ‡ä»¤åˆ†ä¸º6ç§ç¼–ç  æ ¹æ®æŒ‡ä»¤åŠŸèƒ½çš„ä¸åŒå¤§è‡´å¯ä»¥åˆ†ä¸º8ç§ æ¯ä¸ªæŒ‡ä»¤çš„æ„æ€éƒ½å¯ä»¥åœ¨riscvæ–‡æ¡£ä¸­æ‰¾åˆ° rv32iå†…æ ¸æ€»å…±æœ‰32ä¸ªé€šç”¨å¯„å­˜å™¨ å…¶ä¸­å¯„å­˜å™¨0çš„å€¼æ’ä¸º0 è¿™é‡Œä¹Ÿå¯¹RISCVæŒ‡ä»¤é›†ã€éç‰¹æƒã€ç‰¹æƒæ¶æ„ä¸åšè¯¦ç»†è§£é‡Š æˆ‘ä»¬åªä¸“æ³¨äºRISCVå†…æ ¸çš„verilogè®¾è®¡ å…·ä½“è¿˜éœ€å»é˜…è¯»RISCVå®˜æ–¹æ–‡æ¡£ æ¥ä¸‹æ¥å°±æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹è¯¥å†…æ ¸çš„è®¾è®¡ è¿™é‡Œä¹‹æ‰€ä»¥é‡‡ç”¨äº”çº§æµæ°´çº¿æ˜¯å› ä¸ºäº”çº§æµæ°´çº¿æœ€å…·ä»£è¡¨æ€§å’Œå­¦ä¹ æ€§ äº”çº§æµæ°´çº¿åˆ†åˆ«æ˜¯å–æŒ‡ã€è¯‘ç ã€æ‰§è¡Œã€è®¿å­˜ã€å†™å› å½“ç„¶ï¼Œå®é™…å¼€å‘ä¸­å¯èƒ½ä¼šåšå‡ºæ”¹è¿›","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨3","slug":"RISCV/RITTER-CORE3","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.122Z","comments":true,"path":"1970/01/01/RISCV/RITTER-CORE3/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RITTER-CORE3/","excerpt":"æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹æ­£å¼çš„è®¾è®¡RISCV cpuäº†","text":"æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹æ­£å¼çš„è®¾è®¡RISCV cpuäº† ä¹‹å‰è¯´äº† æˆ‘ä»¬æ‰€è®¾è®¡çš„rv32iå†…æ ¸ä½¿ç”¨äº”çº§æµæ°´çº¿ æ‰€ä»¥æˆ‘ä»¬æ¥äº†è§£ä¸‹cpuæµæ°´çº¿çš„è®¾è®¡æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„æµæ°´çº¿æ¨¡å‹ ä¸­é—´çš„å¯ä»¥æ˜¯ç»„åˆç”µè·¯æˆ–è€…æ—¶åºç”µè·¯ ç¬¬ä¸€ä¸ªæ—¶åºç”µè·¯åœ¨ä¸Šå‡æ²¿æ—¶è¯»å–ä¸Šä¸€å±‚ç”µè·¯çš„è¾“å‡º ç»è¿‡ä¸­é—´ç»„åˆ&#x2F;æ—¶åºç”µè·¯çš„è®¡ç®—åè¾“å‡ºåˆ°ç¬¬äºŒä¸ªæ—¶åºç”µè·¯ åœ¨ç¬¬äºŒä¸ªä¸Šå‡æ²¿æ¥æ—¶ï¼Œç¬¬äºŒä¸ªæ—¶åºç”µè·¯è¯»å–ä¸­é—´è¾“å‡ºï¼Œç¬¬ä¸€ä¸ªæ—¶åºç”µè·¯è¯»å–ä¸Šå±‚è¾“å‡º å¦‚æ­¤å¾€å¤ã€‚ å‡å¦‚ä¸­é—´çš„è¿ç®—è¦èŠ±è´¹å¤šä¸ªå‘¨æœŸï¼Œè¿˜éœ€è¦å°†æµæ°´çº¿æš‚åœ å¤šä¸ªè¿™æ ·çš„å•å…ƒç»„æˆå°±æ„æˆäº†åŸºæœ¬çš„æµæ°´çº¿ å¯¹äºcpuå†…æ ¸ä¹Ÿæ˜¯ä¸€æ · å³å°†ä¸€æ¡æŒ‡ä»¤æ‹†åˆ†æˆå¤šä¸ªæ­¥éª¤ï¼Œç„¶åäº¤ç»™æµæ°´çº¿æ‰§è¡Œ å¯ä»¥ç¡®ä¿æ¯æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ—¶é—´ä¸º1ä¸ªå‘¨æœŸï¼ŒåŒæ—¶å¤§å¤§æé«˜äº†æ—¶åº å¯¹äºäº”çº§æµæ°´çº¿å†…æ ¸ï¼šå–æŒ‡ï¼Œè¯‘ç ï¼Œæ‰§è¡Œï¼Œè®¿å­˜ï¼Œå†™å› å–æŒ‡æ®µæ˜¯æ—¶åºé€»è¾‘ è¯‘ç æ®µæ˜¯ç»„åˆé€»è¾‘ æ‰§è¡Œæ®µå¯ä»¥æ˜¯ç»„åˆæˆ–æ—¶åºé€»è¾‘ è®¿å­˜æ˜¯æ—¶åºé€»è¾‘ å†™å›æ˜¯ç»„åˆé€»è¾‘ è¦å°†æ¯ä¸€å±‚è¿æ¥èµ·æ¥å°±è¦é ä¸Šå›¾åŸºæœ¬æµæ°´çº¿çš„1çº§æ—¶åºå’Œ2çº§æ—¶åºç”µè·¯ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºè¿æ¥æ®µ ä¸‹é¢æ˜¯å–æŒ‡æ®µåˆ°è¯‘ç æ®µçš„è¿æ¥æ®µ 123456789101112131415161718192021222324252627282930313233343536373839404142434445//å–æŒ‡ä¸è¯‘ç æ¨¡å—ä¹‹é—´çš„éš”ç¦»æ¨¡å—module IF_ID ( input wire i_clk, input wire i_rst_n, //æµæ°´çº¿æš‚åœ input wire i_pipe_stop, //æµæ°´çº¿å†²åˆ· input wire i_pipe_flush, //ä¸Šçº§è¾“å…¥çš„æŒ‡ä»¤åœ°å€ input wire[31:0] i_iaddr, //ibusè¾“å‡ºçš„æŒ‡ä»¤æ•°æ®, input wire[31:0] i_idata, //ä¼ é€’ç»™ä¸‹çº§çš„æŒ‡ä»¤åœ°å€ output reg[31:0] o_iaddr, //è¾“å‡ºçš„æŒ‡ä»¤æ•°æ® output reg[31:0] o_idata); wire en = (~i_pipe_stop | i_pipe_flush); initial begin o_iaddr&lt;=0; o_idata&lt;=0; end always @(posedge i_clk or negedge i_rst_n) begin if(i_rst_n == `rst)begin o_iaddr &lt;= 32&#x27;b0; o_idata &lt;= `inst_nop; end else if(en == `en)begin o_iaddr &lt;= (i_pipe_flush == `en) ? 32&#x27;h0 : i_iaddr; o_idata &lt;= (i_pipe_flush == `en) ? `inst_nop : i_idata; end endendmodule ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†ä¼šæ¥äº†è§£ä¸‹ç®€å•çš„å–æŒ‡è¿‡ç¨‹","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨4","slug":"RISCV/RITTER-CORE4","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.122Z","comments":true,"path":"1970/01/01/RISCV/RITTER-CORE4/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RITTER-CORE4/","excerpt":"æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹è®¾è®¡ä¸€ä¸ªç®€å•çš„å–æŒ‡å•å…ƒ","text":"æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹è®¾è®¡ä¸€ä¸ªç®€å•çš„å–æŒ‡å•å…ƒ é¦–å…ˆï¼Œå–æŒ‡å°±æ˜¯ä»å‚¨å­˜å™¨ä¸­å–å‡ºæŒ‡ä»¤ æ ¹æ®RISCVçš„æŒ‡ä»¤é›†ç‰¹å¾ æˆ‘ä»¬å°†æŒ‡ä»¤æŒ‡é’ˆï¼ˆpcå¯„å­˜å™¨ï¼‰è®¾ç½®åœ¨å–æŒ‡æ®µ ä¸ºäº†ä¿è¯å–æŒ‡æ­£ç¡®ï¼Œæˆ‘ä»¬è¿˜è¦åŠ å…¥ä¸€ä¸ªç®€å•çš„æ¡æ‰‹åè®® ç¬¬ä¸€ä¸ªå‘¨æœŸå–æŒ‡æ®µå‘å‡ºå–æŒ‡ä¿¡æ¯ ç¬¬äºŒä¸ªå‘¨æœŸå‚¨å­˜å™¨è¯»å–ä¿¡æ¯å‘å‡ºæŒ‡ä»¤ï¼ŒåŒæ—¶å–æŒ‡æ®µå‘å‡ºç¬¬äºŒä¸ªå–æŒ‡ä¿¡æ¯ ç¬¬ä¸‰ä¸ªå‘¨æœŸå–æŒ‡æ®µè¯»å–æŒ‡ä»¤ï¼ŒåŒæ—¶å–æŒ‡æ®µå‘å‡ºç¬¬3ä¸ªå–æŒ‡ä¿¡æ¯ï¼Œå‚¨å­˜å™¨è¯»å–ç¬¬äºŒä¸ªä¿¡æ¯ å¤§è‡´æ—¶åºå¦‚ä¸‹ï¼Œè¿™é‡Œæ²¡æœ‰è€ƒè™‘å–æŒ‡å¼‚å¸¸ç­‰é—®é¢˜ é»˜è®¤ä¸ºä¸ä¼šå‡ºç°å¼‚å¸¸ å–æŒ‡æ®µå¦‚ä¸‹è®¾è®¡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150//å–æŒ‡æ¨¡å—module IF ( //æ—¶é’Ÿä¿¡å· input wire i_clk, //å¤ä½ä¿¡å· input wire i_rst_n,/*åˆ†å‰²çº¿*/ //pcå†™ input wire i_pc_we, input wire[31:0] i_pc_wdata, input wire i_pipe_stop,/*åˆ†å‰²çº¿*///ä¸‹é¢è¿æ¥ibusæ€»çº¿ //ibusè¯»å–åœ°å€ output wire[31:0] o_ibus_addr, //ibusè¯»å–æ•°æ® input wire[31:0] i_ibus_data, //ibusè¯·æ±‚ä¿¡å· output reg o_ibus_req, //ibuså“åº”ä¿¡å· input wire i_ibus_rsp,/*åˆ†å‰²çº¿*///ä¸‹é¢æ˜¯ä¼ é€’ä¸‹ä¸€çº§æµæ°´çº¿ //ä¼ é€’ç»™ä¸‹çº§æµæ°´çº¿çš„ibusåœ°å€ output wire[31:0] o_iaddr, //ä¼ é€’ç»™ä¸‹çº§æµæ°´çº¿çš„ibusæ•°æ® output wire[31:0] o_idata); reg[31:0] pc;//pcå¯„å­˜å™¨ initial begin pc = 32&#x27;h0; o_ibus_req = 0; end wire valid = i_ibus_rsp &amp; (~i_pipe_stop) ; always @(posedge i_clk or negedge i_rst_n) begin if(i_rst_n == `rst)begin//å¤ä½ pc &lt;= 32&#x27;h0; o_ibus_req &lt;= 0; end else if(valid)begin pc &lt;= (i_pc_we) ? i_pc_wdata : (pc+4); end else if(i_pipe_stop) begin end //å‘é€ibusè®¿é—®è¯·æ±‚ o_ibus_req &lt;= 1; end //å°†pcæ‰“ä¸€æ‹å‘é€ç»™ä¸‹çº§æµæ°´çº¿ //gen_dff#(32)pc_dff(i_clk,i_rst_n,valid,pc,o_iaddr); assign o_iaddr = pc; assign o_ibus_addr = pc; assign o_idata = (i_ibus_rsp &amp; (~i_pc_we)) ? i_ibus_data : `inst_nop; endmodule//å–æŒ‡ä¸è¯‘ç æ¨¡å—ä¹‹é—´çš„éš”ç¦»æ¨¡å—module IF_ID ( input wire i_clk, input wire i_rst_n, /*åˆ†å‰²çº¿*/ //æµæ°´çº¿æš‚åœ input wire i_pipe_stop, //æµæ°´çº¿å†²åˆ· input wire i_pipe_flush, /*åˆ†å‰²çº¿*/ //ä¸Šçº§è¾“å…¥çš„æŒ‡ä»¤åœ°å€ input wire[31:0] i_iaddr, //ibusè¾“å‡ºçš„æŒ‡ä»¤æ•°æ®, input wire[31:0] i_idata,/*åˆ†å‰²çº¿*/ //ä¼ é€’ç»™ä¸‹çº§çš„æŒ‡ä»¤åœ°å€ output wire[31:0] o_iaddr, //è¾“å‡ºçš„æŒ‡ä»¤æ•°æ® output wire[31:0] o_idata); wire en = (~i_pipe_stop | i_pipe_flush); reg[31:0] iaddr,idata; initial begin iaddr&lt;=0; idata&lt;=0; end assign o_iaddr = (i_pipe_flush == `en) ? 32&#x27;h0 : iaddr; assign o_idata = (i_pipe_flush == `en) ? `inst_nop : idata; always @(posedge i_clk or negedge i_rst_n) begin if(i_rst_n == `rst)begin iaddr &lt;= 32&#x27;b0; idata &lt;= `inst_nop; end else if(en == `en)begin iaddr &lt;= i_iaddr; idata &lt;= i_idata; end endendmodule è¿™é‡Œä¸ºäº†ç®€ä¾¿èµ·è§ï¼Œå¹¶æ²¡æœ‰è¿‡å¤šä¿®é¥°ï¼Œä½†ä¹Ÿèƒ½å¤Ÿä½¿ç”¨","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨5","slug":"RISCV/RITTER-CORE5","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.122Z","comments":true,"path":"1970/01/01/RISCV/RITTER-CORE5/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RITTER-CORE5/","excerpt":"è¯‘ç æ®µè®¾è®¡","text":"è¯‘ç æ®µè®¾è®¡ è¯‘ç æ®µæ˜¯çº¯ç»„åˆé€»è¾‘ è¿™éƒ¨åˆ†æ¯”è¾ƒç®€å• ä¹Ÿå°±æ˜¯å°†æŒ‡ä»¤è¯‘ç å‡ºè¯¦ç»†ä¿¡æ¯ è¿™é‡Œç›´æ¥è´´ä¸Šä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375`define decinfo_wigth (17)/*è¯‘ç å‡ºçš„å…·ä½“æŒ‡ä»¤å†…å®¹1&#x27;æ˜¯å¦è¦è¿›è¡Œè¿ç®—[0]1&#x27;alu bä½æ˜¯å¦é€‰æ‹©ç«‹å³æ•°[1]1&#x27;alu pcæ˜¯å¦å‚ä¸è®¡ç®—[2]1&#x27;æ˜¯å¦æ˜¯æ¡ä»¶åˆ†æ”¯æŒ‡ä»¤[3]1&#x27;æ˜¯å¦æ˜¯å¼ºåˆ¶è·³è½¬[4]1â€˜æ˜¯å¦è¦è¯»å†…å­˜[5]1â€™æ˜¯å¦è¦å†™å†…å­˜[6]1â€™æ˜¯å¦è¦è¯»å†™csrå¯„å­˜å™¨[8]3â€™func[11:9]7â€˜func7[18:12]*/`define decinfo_alu 0`define decinfo_b 1`define decinfo_pc 2`define decinfo_branch 3`define decinfo_jal 4`define decinfo_rdbus 5`define decinfo_wdbus 6`define decinfo_wcsr 7`define decinfo_func3 10:8`define decinfo_func7 17:11//è¯‘ç æ¨¡å—module ID ( input wire i_clk, input wire i_rst_n, //è§£ç å‡ºçš„å…·ä½“æŒ‡ä»¤ output wire[`decinfo_wigth:0] o_dec_data, //csråœ°å€ output wire[11:0] o_csr_addr, //rdå¯„å­˜å™¨å†™åœ°å€ output wire[4:0] o_rd_addr1, output wire[4:0] o_rd_addr2, //rs1è¯»åœ°å€ output wire[4:0] o_rs1_addr, //rs2è¯»åœ°å€ output wire[4:0] o_rs2_addr, //ç«‹å³æ•° output wire[31:0] o_imm_data, //å¦‚æœæ˜¯opc_loadæŒ‡ä»¤ï¼Œé‚£ä¹ˆåˆ™æš‚åœå–æŒ‡ç›´åˆ°opc_loadæ‰§è¡Œå®Œæ¯• output wire o_opc_load,/*åˆ†å‰²çº¿*/ //ä¸Šçº§ä¼ é€’ä¸‹æ¥çš„æŒ‡ä»¤åœ°å€ input wire[31:0] i_iaddr, input wire[31:0] i_idata); // å–å‡ºæŒ‡ä»¤ä¸­çš„æ¯ä¸€ä¸ªåŸŸ wire[6:0] opc = i_idata[6:0]; wire[2:0] func = i_idata[14:12]; wire[6:0] func7 = i_idata[31:25]; wire[4:0] rd = i_idata[11:7]; wire[4:0] rs1 = i_idata[19:15]; wire[4:0] rs2 = i_idata[24:20]; wire[11:0] type_i_imm_11_0 = i_idata[31:20]; wire[6:0] type_s_imm_11_5 = i_idata[31:25]; wire[4:0] type_s_imm_4_0 = i_idata[11:7]; wire[6:0] type_b_imm_12_10_5 = i_idata[31:25]; wire[4:0] type_b_imm_4_1_11 = i_idata[11:7]; wire[19:0] type_u_imm_31_12 = i_idata[31:12]; wire[19:0] type_j_imm_31_12 = i_idata[31:12];`define opc_lui 7&#x27;b0110111 // rd = imm`define opc_auipc 7&#x27;b0010111 // rd = pc + imm`define opc_jal 7&#x27;b1101111`define opc_jalr 7&#x27;b1100111`define opc_branch 7&#x27;b1100011`define opc_load 7&#x27;b0000011`define opc_store 7&#x27;b0100011`define opc_opimm 7&#x27;b0010011`define opc_op 7&#x27;b0110011`define opc_fence 7&#x27;b0001111`define opc_system 7&#x27;b1110011 // æŒ‡ä»¤opcåŸŸçš„å–å€¼ wire opc_lui = (opc == `opc_lui); wire opc_auipc = (opc == `opc_auipc); wire opc_jal = (opc == `opc_jal); wire opc_jalr = (opc == `opc_jalr); wire opc_branch = (opc == `opc_branch); wire opc_load = (opc == `opc_load); wire opc_store = (opc == `opc_store); wire opc_opimm = (opc == `opc_opimm); wire opc_op = (opc == `opc_op); wire opc_fence = (opc == `opc_fence); wire opc_system = (opc == `opc_system); // æŒ‡ä»¤funcåŸŸçš„å–å€¼ wire func_000 = (func == 3&#x27;b000); wire func_001 = (func == 3&#x27;b001); wire func_010 = (func == 3&#x27;b010); wire func_011 = (func == 3&#x27;b011); wire func_100 = (func == 3&#x27;b100); wire func_101 = (func == 3&#x27;b101); wire func_110 = (func == 3&#x27;b110); wire func_111 = (func == 3&#x27;b111); // æŒ‡ä»¤func7åŸŸçš„å–å€¼ wire func7_0000000 = (func7 == 7&#x27;b0000000); wire func7_0100000 = (func7 == 7&#x27;b0100000); wire func7_0000001 = (func7 == 7&#x27;b0000001); // Iç±»å‹æŒ‡ä»¤immåŸŸçš„å–å€¼ wire type_i_imm_000000000000 = (type_i_imm_11_0 == 12&#x27;b000000000000); wire type_i_imm_000000000001 = (type_i_imm_11_0 == 12&#x27;b000000000001);/*********************************************************/ // è¯‘ç å‡ºå…·ä½“æŒ‡ä»¤ /*j*/ wire inst_lui = opc_lui; wire inst_auipc = opc_auipc; wire inst_jal = opc_jal; wire inst_jalr = opc_jalr &amp; func_000; /*branch*/ wire inst_beq = opc_branch &amp; func_000; wire inst_bne = opc_branch &amp; func_001; wire inst_blt = opc_branch &amp; func_100; wire inst_bge = opc_branch &amp; func_101; wire inst_bltu = opc_branch &amp; func_110; wire inst_bgeu = opc_branch &amp; func_111; /*load*/ wire inst_lb = opc_load &amp; func_000; wire inst_lh = opc_load &amp; func_001; wire inst_lw = opc_load &amp; func_010; wire inst_lbu = opc_load &amp; func_100; wire inst_lhu = opc_load &amp; func_101; /*store*/ wire inst_sb = opc_store &amp; func_000; wire inst_sh = opc_store &amp; func_001; wire inst_sw = opc_store &amp; func_010; /*opimm*/ wire inst_addi = opc_opimm &amp; func_000; wire inst_slti = opc_opimm &amp; func_010; wire inst_sltiu = opc_opimm &amp; func_011; wire inst_xori = opc_opimm &amp; func_100; wire inst_ori = opc_opimm &amp; func_110; wire inst_andi = opc_opimm &amp; func_111; wire inst_slli = opc_opimm &amp; func_001 &amp; func7_0000000; wire inst_srli = opc_opimm &amp; func_101 &amp; func7_0000000; wire inst_srai = opc_opimm &amp; func_101 &amp; func7_0100000; /*op*/ wire inst_add = opc_op &amp; func_000 &amp; func7_0000000; wire inst_sub = opc_op &amp; func_000 &amp; func7_0100000; wire inst_sll = opc_op &amp; func_001 &amp; func7_0000000; wire inst_slt = opc_op &amp; func_010 &amp; func7_0000000; wire inst_sltu = opc_op &amp; func_011 &amp; func7_0000000; wire inst_xor = opc_op &amp; func_100 &amp; func7_0000000; wire inst_srl = opc_op &amp; func_101 &amp; func7_0000000; wire inst_sra = opc_op &amp; func_101 &amp; func7_0100000; wire inst_or = opc_op &amp; func_110 &amp; func7_0000000; wire inst_and = opc_op &amp; func_111 &amp; func7_0000000; /*fence*/ wire inst_fence = opc_fence &amp; func_000; wire inst_fencei = opc_fence &amp; func_001; /*system*/ wire inst_ecall = opc_system &amp; func_000 &amp; type_i_imm_000000000000; wire inst_ebreak = opc_system &amp; func_000 &amp; type_i_imm_000000000001; wire inst_csrrw = opc_system &amp; func_001; wire inst_csrrs = opc_system &amp; func_010; wire inst_csrrc = opc_system &amp; func_011; wire inst_csrrwi = opc_system &amp; func_101; wire inst_csrrsi = opc_system &amp; func_110; wire inst_csrrci = opc_system &amp; func_111; /*Mæ‹“å±•*/ wire inst_mul = opc_op &amp; func_000 &amp; func7_0000001; wire inst_mulh = opc_op &amp; func_001 &amp; func7_0000001; wire inst_mulhsu = opc_op &amp; func_010 &amp; func7_0000001; wire inst_mulhu = opc_op &amp; func_011 &amp; func7_0000001; wire inst_div = opc_op &amp; func_100 &amp; func7_0000001; wire inst_divu = opc_op &amp; func_101 &amp; func7_0000001; wire inst_rem = opc_op &amp; func_110 &amp; func7_0000001; wire inst_remu = opc_op &amp; func_111 &amp; func7_0000001;/*********************************************************/ // æŒ‡ä»¤ä¸­çš„ç«‹å³æ•° wire[31:0] inst_u_type_imm = &#123;i_idata[31:12], 12&#x27;b0&#125;; wire[31:0] inst_j_type_imm = &#123;&#123;12&#123;i_idata[31]&#125;&#125;, i_idata[19:12], i_idata[20], i_idata[30:21], 1&#x27;b0&#125;; wire[31:0] inst_b_type_imm = &#123;&#123;20&#123;i_idata[31]&#125;&#125;, i_idata[7], i_idata[30:25], i_idata[11:8], 1&#x27;b0&#125;; wire[31:0] inst_s_type_imm = &#123;&#123;20&#123;i_idata[31]&#125;&#125;, i_idata[31:25], i_idata[11:7]&#125;; wire[31:0] i_idata_type_imm = &#123;&#123;20&#123;i_idata[31]&#125;&#125;, i_idata[31:20]&#125;; //csr zimm wire[31:0] inst_csr_type_imm = &#123;27&#x27;h0, i_idata[19:15]&#125;; wire[31:0] inst_shift_type_imm = &#123;27&#x27;h0, i_idata[24:20]&#125;; //ç«‹å³æ•°é€‰æ‹© assign o_imm_data = (opc_lui | opc_auipc) ? inst_u_type_imm : (opc_jal) ? inst_j_type_imm : (opc_jalr | opc_load) ? i_idata_type_imm : (opc_branch) ? inst_b_type_imm : (opc_store) ? inst_s_type_imm : (opc_opimm) ? ((inst_slli | inst_srli | inst_srai) ? inst_shift_type_imm : i_idata_type_imm) : (inst_ecall | inst_ebreak) ? i_idata_type_imm ://è¿™é‡ŒæŠŠecallå’Œebreakçš„å12ä½å½“ä½œç«‹å³æ•°å¤„ç† 0; //csrå¯„å­˜å™¨åœ°å€ assign o_csr_addr = opc_system ? i_idata_type_imm : 0; // æ˜¯å¦éœ€è¦å†™rdå¯„å­˜å™¨ wire access_rd = opc_lui | opc_auipc | opc_jal | opc_jalr | opc_opimm | opc_op | opc_system; assign o_rd_addr1 = access_rd ? rd: 5&#x27;h0; assign o_rd_addr2 = opc_load ? rd:5&#x27;d0; // æ˜¯å¦éœ€è¦è®¿é—®rs1å¯„å­˜å™¨ wire access_rs1 = opc_jalr | opc_branch | opc_load | opc_store | opc_opimm | opc_op | inst_csrrw | inst_csrrs | inst_csrrc; assign o_rs1_addr = access_rs1 ? rs1: 5&#x27;h0; // æ˜¯å¦éœ€è¦è®¿é—®rs2å¯„å­˜å™¨ wire access_rs2 = opc_branch | opc_store | opc_op; assign o_rs2_addr = access_rs2? rs2: 5&#x27;h0; //æ˜¯å¦éœ€è¦è¿›è¡Œæ•°å­¦è®¡ç®— //è¿™ä¸ªæ ‡å¿—è²Œä¼¼å¯æœ‰å¯æ—  assign o_dec_data[`decinfo_alu] = opc_lui | opc_auipc | opc_jal | opc_jalr | opc_branch | opc_load | opc_store | opc_opimm | opc_op; //alu bä½æ˜¯å¦é€‰æ‹©ç«‹å³æ•° assign o_dec_data[`decinfo_b] = opc_lui | opc_auipc | opc_jal | opc_jalr | opc_load | opc_store | opc_opimm; //alu pcæ˜¯å¦å‚ä¸è®¡ç®—,æ˜¯å¦æ˜¯jalç­‰è·³è½¬æŒ‡ä»¤ assign o_dec_data[`decinfo_pc] = opc_auipc | opc_jal ; //æ˜¯å¦æ˜¯æ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ assign o_dec_data[`decinfo_branch] = opc_branch; //æ˜¯å¦éœ€è¦å¼ºåˆ¶è·³è½¬ assign o_dec_data[`decinfo_jal] = opc_jal | opc_jalr; //æ˜¯å¦éœ€è¦è¯»å†…å­˜ assign o_dec_data[`decinfo_rdbus] = opc_load; //æ˜¯å¦éœ€è¦å†™å†…å­˜ assign o_dec_data[`decinfo_wdbus] = opc_store; //æ˜¯å¦è¦è¯»å†™csrå¯„å­˜å™¨ assign o_dec_data[`decinfo_wcsr] = opc_system &amp; (~(inst_ecall | inst_ebreak)); assign o_dec_data[`decinfo_func3] = (opc_lui | opc_auipc | opc_jal) ? 0 : func; assign o_dec_data[`decinfo_func7] = (inst_slli | inst_srli | inst_srai | opc_op) ? func7 : 0; assign o_opc_load = opc_load; endmodulemodule ID_EX ( input wire i_clk, input wire i_rst_n, //æµæ°´çº¿æš‚åœ input wire i_pipe_stop, //æµæ°´çº¿å†²åˆ· input wire i_pipe_flush, /**/ input wire[`decinfo_wigth:0] i_dec_data, input wire[11:0] i_csr_addr, input wire[4:0] i_rd_addr1, input wire[4:0] i_rd_addr2, input wire[4:0] i_rs1_addr, input wire[4:0] i_rs2_addr, input wire[31:0] i_imm_data, input wire i_opc_load, input wire[31:0] i_iaddr, output reg[`decinfo_wigth:0] o_dec_data, output reg[11:0] o_csr_addr, output reg[4:0] o_rd_addr1, output reg[4:0] o_rd_addr2, output reg[4:0] o_rs1_addr, output reg[4:0] o_rs2_addr, output reg[31:0] o_imm_data, output reg o_opc_load, output reg[31:0] o_iaddr ); wire en = (~i_pipe_stop) | i_pipe_flush; wire[`decinfo_wigth:0] dec_data= i_pipe_flush ? 0 : i_dec_data; wire[11:0] csr_addr= i_pipe_flush ? 0 : i_csr_addr; wire[4:0] rd_addr1= i_pipe_flush ? 0 : i_rd_addr1; wire[4:0] rd_addr2= i_pipe_flush ? 0 : i_rd_addr2; wire[4:0] rs1_addr= i_pipe_flush ? 0 : i_rs1_addr; wire[4:0] rs2_addr= i_pipe_flush ? 0 : i_rs2_addr; wire[31:0] imm_data= i_pipe_flush ? 0 : i_imm_data; wire opc_load= i_pipe_flush ? 0 : i_opc_load; wire[31:0] iaddr = i_pipe_flush ? 0 : i_iaddr; initial begin o_dec_data &lt;= 0 ; o_csr_addr &lt;=0; o_rd_addr1&lt;= 0; o_rd_addr2&lt;= 0; o_rs1_addr &lt;= 0 ; o_rs2_addr &lt;= 0 ; o_imm_data &lt;= 0 ; o_opc_load &lt;= 0; o_iaddr &lt;= 0 ; end always @(posedge i_clk or negedge i_rst_n) begin if(i_rst_n == `rst)begin o_dec_data &lt;= 0 ; o_csr_addr &lt;=0; o_rd_addr1 &lt;= 0 ; o_rs1_addr &lt;= 0 ; o_rs2_addr &lt;= 0 ; o_imm_data &lt;= 0 ; o_opc_load &lt;= 0; o_iaddr &lt;= 0 ; end else if(en == `en)begin o_dec_data &lt;= dec_data; o_csr_addr &lt;= csr_addr; o_rd_addr1 &lt;= rd_addr1; o_rd_addr2 &lt;= rd_addr2; o_rs1_addr &lt;= rs1_addr; o_rs2_addr &lt;= rs2_addr; o_imm_data &lt;= imm_data; o_opc_load &lt;= opc_load; o_iaddr &lt;= iaddr; end end endmodule è¿™é‡Œé¢æ²¡æœ‰ä»€ä¹ˆç‰¹æ®ŠæŠ€æœ¯ ä½†ä¹‹å‰ä¹Ÿè¯´äº†ï¼Œåˆ¶ä½œè¿™ä¸ªriscvå†…æ ¸å•çº¯æ˜¯ä¸ºäº†å­¦ä¹  åªè¦æ±‚èƒ½è·‘ï¼Œä¸è¦æ±‚æ€§èƒ½ è¯‘ç æ®µä¸»è¦è¯‘ç å‡ºçš„å°±æ˜¯ 1ã€è¯»å†™å¯„å­˜å™¨åœ°å€ï¼ˆä¸è¯»ä¸å†™åˆ™è®¾ç½®ä¸º0ï¼‰2ã€æ‰§è¡Œæ®µæ‰€éœ€èµ„æº3ã€æ˜¯å¦è¯»å†™csrå¯„å­˜å™¨4ã€æ˜¯å¦è·³è½¬5ã€æŒ‡ä»¤ç±»å‹ ç„¶åç”±è¯‘ç æ®µåˆ°æ‰§è¡Œæ®µçš„è¿æ¥æ®µä¼ é€’","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"FPGA-RISCVå†…æ ¸å…¥é—¨6","slug":"RISCV/RITTER-CORE6","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.123Z","comments":true,"path":"1970/01/01/RISCV/RITTER-CORE6/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/RISCV/RITTER-CORE6/","excerpt":"å–æŒ‡æ®µåŠè¯‘ç æ®µç»†èŠ‚åˆ†æ","text":"å–æŒ‡æ®µåŠè¯‘ç æ®µç»†èŠ‚åˆ†æ é¦–å…ˆæ˜¯å‚¨å­˜å™¨è¯´æ˜ ä¸€èˆ¬ä¸ºäº†ä¿è¯æ—¶åºï¼Œæ‰€æœ‰åŸä»¶çš†ä¸ºä¸Šå‡æ²¿è§¦å‘ ä½†æ˜¯è¿™é‡Œä¸ºäº†ä¿è¯ç®€ä¾¿å’Œç¨³å®š åœ¨å–æŒ‡æ®µä¸­å°†å‚¨å­˜å™¨è¯»å†™æ”¹ä¸ºä¸‹é™æ²¿ è¿™æ ·åœ¨å–æŒ‡æ—¶ï¼Œä¸Šå‡æ²¿å‘å‡ºåœ°å€ï¼Œä¸‹é™æ²¿å‚¨å­˜å™¨è¯»å–åœ°å€å‘å‡ºæ•°æ® ç¬¬äºŒä¸ªä¸Šå‡æ²¿å–æŒ‡è¯»å–ï¼Œè™½ç„¶å¯èƒ½é™ä½æ—¶åºï¼Œä½†æ˜¯ä¿è¯äº†ç®€æ´äºç¨³å®š è¯‘ç æ®µä¸­å•ç‹¬çš„æŠŠè®¿å­˜ä¿¡æ¯ç•™äº†ä¸€ä¸ªè¾“å‡º è¿™æ˜¯ä¸ºäº†è§£å†³å› ä¸ºè®¿å­˜å¸¦æ¥çš„æ•°æ®å†²çª å¦‚æœè¯‘ç æ®µæ£€æµ‹åˆ°æ˜¯è®¿å­˜æŒ‡ä»¤ åˆ™æš‚åœæµæ°´çº¿3ä¸ªå‘¨æœŸ è¿™é‡Œæ²¡æœ‰è€ƒè™‘è¯»å†™å»¶è¿Ÿï¼Œå› æ­¤ç›´æ¥æš‚åœ3ä¸ªå‘¨æœŸ å¯¹äºè·³è½¬æ§åˆ¶ä¹Ÿæ˜¯å¾—ç›Šäºåœ¨ä¸‹é™æ²¿å‚¨å­˜å™¨è¾“å‡ºæŒ‡ä»¤ å› æ­¤åªéœ€åœ¨ä¸Šå‡æ²¿æ£€æµ‹åˆ°è·³è½¬ä¿¡å·åˆ™è·³è½¬ï¼Œä¸ç”¨æ‹…å¿ƒè·³è½¬é”™è¯¯ ä¹Ÿä¸ç”¨æš‚åœæµæ°´çº¿ åˆæ¬¡ä¹‹å¤–ï¼Œè¯‘ç æ®µå‘å‡ºå¯„å­˜å™¨è¯»å†™åœ°å€ä¿¡å· è¯‘ç æ®µåˆ°æ‰§è¡Œæ®µçš„è¿æ¥æ®µæ¥æ”¶ å¯„å­˜å™¨è¯»æ”¾åœ¨æ‰§è¡Œæ®µ è¿™é‡Œå®é™…ä¸Šå¯ä»¥å°†å¯„å­˜å™¨è¯»æ•°æ®ç›´æ¥æ”¾åœ¨è¯‘ç æ®µ å¯ä»¥èŠ‚çº¦æ—¶åºï¼Œä½†å½“æ—¶å¹¶æœªè€ƒè™‘ å› æ­¤å°±ä¿ç•™äº†ä¸‹æ¥ è¯‘ç æ®µå®é™…ä¸Šå¯ä»¥è¯‘ç å‡ºæ›´è¯¦ç»†çš„ä¿¡æ¯ é˜²æ­¢æ‰§è¡Œæ®µäºŒæ¬¡è¯‘ç  è¿™é‡Œä¹Ÿå¹¶æœªè€ƒè™‘ æ¯•ç«Ÿæ˜¯ç¬¬ä¸€ç‰ˆä½œå“ æ›´å¤šä¼˜åŒ–æŠ€å·§å¯ä»¥å¤šæ€è€ƒæ€è€ƒ","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"}]},{"title":"RITTER2 Cacheå®ç°","slug":"chisel/RITTER2Cacheå®ç°","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.124Z","comments":true,"path":"1970/01/01/chisel/RITTER2Cacheå®ç°/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/chisel/RITTER2Cache%E5%AE%9E%E7%8E%B0/","excerpt":"RITTER2.0å†…æ ¸çš„Cacheå®ç°ã€‚åŒ…æ‹¬ICacheå’ŒDCache","text":"RITTER2.0å†…æ ¸çš„Cacheå®ç°ã€‚åŒ…æ‹¬ICacheå’ŒDCache ICacheå’ŒDCacheå‡ä½¿ç”¨chisel3.5è®¾è®¡å‡å¯é…ç½®lineæ•°å’Œwayæ•°é‡‡ç”¨ä¼ªlruæ›¿æ¢ç­–ç•¥ ICacheä¸ºåªè¯»ï¼ŒDCacheä¸ºå¯è¯»å¯å†™ç›®å‰å‡ä»¥é€šè¿‡åŸºæœ¬çš„è¯»å†™æµ‹è¯• é¡¹ç›®åœ°å€:click meICache ä½äºIFUæ–‡ä»¶å¤¹ä¸‹DCacheä½äºCacheæ–‡ä»¶å¤¹ä¸‹","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"chisel","slug":"chisel","permalink":"https://tastynoob.github.io/tags/chisel/"}]},{"title":"chisel3ä¹¦å†™ç»†èŠ‚","slug":"chisel/chisel3ä¹¦å†™ç»†èŠ‚","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.124Z","comments":true,"path":"1970/01/01/chisel/chisel3ä¹¦å†™ç»†èŠ‚/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/chisel/chisel3%E4%B9%A6%E5%86%99%E7%BB%86%E8%8A%82/","excerpt":"æœ‰å…³chisel3çš„ä¸€äº›ä¹¦å†™ç»†èŠ‚ä»¥åŠchiselç”Ÿæˆverilogä»£ç çš„ä¸€äº›æ³¨æ„äº‹é¡¹","text":"æœ‰å…³chisel3çš„ä¸€äº›ä¹¦å†™ç»†èŠ‚ä»¥åŠchiselç”Ÿæˆverilogä»£ç çš„ä¸€äº›æ³¨æ„äº‹é¡¹ é¦–å…ˆæœ‰å¿…è¦è¯´çš„æ˜¯æ¨¡å—å‚æ•°åŒ–å¯ä»¥è¿™æ ·å†™ 12345678910111213141516171819202122class dataT extends Bundle &#123; val data = UInt(32.W) val valid = Bool()&#125;class Test[T&lt;:Data](eleT:T) extends Module &#123; val io = IO(new Bundle &#123; val in = Input(Vec(2, eleT)) val out = Output(Vec(2, eleT)) &#125;) val reg0 = Reg(eleT) val reg1 = Reg(eleT) reg0 := io.in(0) reg1 := io.in(1) io.out(0) := reg0 io.out(1) := reg1&#125;object Main extends App &#123; (new chisel3.stage.ChiselStage).emitVerilog(new Test(new dataT))&#125; æœ‰åŠ©äºå¯¹æ¨¡å—å†…ç¡¬ä»¶ç±»å‹çš„å‚æ•°åŒ–,æ¯”å¦‚åœ¨fifoä¸­ ç„¶åæ˜¯chisel3çš„èµ‹å€¼è¯­å¥æ¯”å¦‚ä¸‹é¢çš„è¯­å¥ 12345678910class Test extends Module&#123; val io = IO(new Bundle&#123; val in = Input(UInt(32.W)) val out = Output(UInt(32.W)) &#125;) val reg = Reg(UInt(32.W)) reg:= io.in io.out := reg io.out := io.in&#125; å½“å¯¹çº¿ç½‘ç±»å‹è¿›è¡Œå¤šæ¬¡èµ‹å€¼æ—¶,ç”±äºscalaæœ¬è´¨ä¸Šæ˜¯é¡ºåºæ‰§è¡Œçš„ç¼–ç¨‹è¯­è¨€æ‰€ä»¥åé¢çš„è¯­å¥å¯¹çº¿ç½‘ç±»å‹çš„è¿æ¥ä¼šå°†å‰é¢çš„èµ‹å€¼çš„è¿æ¥è¦†ç›–æ‰æœ€åç”Ÿæˆçš„verilogä»£ç å¦‚ä¸‹ 12345678module Test( input clock, input reset, input [31:0] io_in, output [31:0] io_out); assign io_out = io_in; // @[Main.scala 14:12]endmodule ä½†æ˜¯å½“å¯¹å¯„å­˜å™¨ç±»å‹åšå¤šæ¬¡èµ‹å€¼æ—¶1234567891011class Test extends Module&#123; val io = IO(new Bundle&#123; val in0 = Input(UInt(32.W)) val in1 = Input(UInt(32.W)) val out = Output(UInt(32.W)) &#125;) val reg = Reg(UInt(32.W)) reg := io.in0 reg := io.in1 io.out := reg&#125; ç”Ÿæˆçš„verilogä»£ç  12345678910111213module Test( input clock, input reset, input [31:0] io_in0, input [31:0] io_in1, output [31:0] io_out); reg [31:0] reg_; // @[Main.scala 12:18] assign io_out = reg_; // @[Main.scala 15:12] always @(posedge clock) begin reg_ &lt;= io_in1; // @[Main.scala 14:9] endendmodule åˆæ­¥ç”Ÿæˆçš„ç»“æœå’Œå¯¹çº¿ç½‘ç±»å‹çš„å¤šæ¬¡èµ‹å€¼çš„ç»“æœæ˜¯ä¸€æ ·çš„ ä½†æ˜¯å½“æˆ‘ä»¬åŠ ä¸Šæ¡ä»¶åˆ¤æ–­12345678910111213141516class Test extends Module&#123; val io = IO(new Bundle&#123; val in0 = Input(UInt(32.W)) val in1 = Input(UInt(32.W)) val en0 = Input(Bool()) val en1 = Input(Bool()) val out = Output(UInt(32.W)) &#125;) val reg = Reg(UInt(32.W)) when(io.en0)&#123; reg := io.in0 &#125; reg := io.in1 io.out := reg&#125; ç”Ÿæˆçš„verilogä»£ç  123456789101112131415module Test( input clock, input reset, input [31:0] io_in0, input [31:0] io_in1, input io_en0, input io_en1, output [31:0] io_out); reg [31:0] reg_; // @[Main.scala 14:18] assign io_out = reg_; // @[Main.scala 20:12] always @(posedge clock) begin reg_ &lt;= io_in1; // @[Main.scala 19:9] endendmodule å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„verilogé€»è¾‘å‡å¦‚æˆ‘ä»¬è°ƒæ¢ä¸€ä¸‹èµ‹å€¼é¡ºåºå‘¢ 1234567891011121314151617class Test extends Module&#123; val io = IO(new Bundle&#123; val in0 = Input(UInt(32.W)) val in1 = Input(UInt(32.W)) val en0 = Input(Bool()) val en1 = Input(Bool()) val out = Output(UInt(32.W)) &#125;) val reg = Reg(UInt(32.W)) reg := io.in1 when(io.en0)&#123; reg := io.in0 &#125; io.out := reg&#125; 12345678910111213141516171819module Test( input clock, input reset, input [31:0] io_in0, input [31:0] io_in1, input io_en0, input io_en1, output [31:0] io_out); reg [31:0] reg_; // @[Main.scala 14:18] assign io_out = reg_; // @[Main.scala 21:12] always @(posedge clock) begin if (io_en0) begin // @[Main.scala 17:17] reg_ &lt;= io_in0; // @[Main.scala 18:13] end else begin reg_ &lt;= io_in1; // @[Main.scala 16:9] end endendmodule å‘ç°é€»è¾‘åˆå¯¹äº† è¿™æ˜¯å› ä¸ºchiselå¯¹å¯„å­˜å™¨è¿›è¡Œè¿æ¥æ—¶,ä¼šæŒ‰ç…§ä»ä¸Šå¾€ä¸‹çš„é¡ºåºè¿›è¡Œè¿æ¥åè¿æ¥çš„æ‹¥æœ‰æœ€å¤§çš„ä¼˜å…ˆçº§å‡å¦‚chiselä¸­å‡ºç°äº†å¯¹å¯„å­˜å™¨çš„å¤šæ¬¡è¿æ¥ç”Ÿæˆçš„verilogä»£ç ä¸­ä¼šæŒ‰ç…§chiselä»åå¾€å‰çš„ä¼˜å…ˆçº§è¿›è¡Œè¿æ¥å› æ­¤åœ¨å†™chiselä»£ç æ—¶éœ€è¦å¯¹åŒä¸€å¯„å­˜å™¨è¿›è¡Œå¤šæ¬¡èµ‹å€¼è¿æ¥åˆä¸æƒ³å†™å¤ªå¤šwhenè¯­å¥å°±å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ æœ€åå°±æ˜¯chiselä»£ç ä»¿çœŸé—®é¢˜è¿™é‡Œä½¿ç”¨æœ€æ–°çš„chiseltest å…¸å‹çš„æµ‹è¯•ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021class Test extends Module&#123; val io = IO(new Bundle&#123; val in = Input(UInt(32.W)) val out = Output(UInt(32.W)) &#125;) val reg = Wire(UInt(32.W)) reg := io.in io.out := reg&#125;class Test_Test extends AnyFlatSpec with ChiselScalatestTester &#123; behavior of &quot;Module&quot; it should &quot;work&quot; in &#123; //æ·»åŠ å¦‚ä¸‹è¯­å¥å¯ä»¥ç”Ÿæˆä»¿çœŸæ³¢å½¢å›¾åˆ°æœ¬åœ°,å¯ä»¥ç”¨gtkwaveæ‰“å¼€ test(new Test).withAnnotations(Seq(WriteVcdAnnotation)) &#123; dut =&gt; dut.io.in.poke(12.U) dut.clock.step(1) dut.io.out.expect(12.U) &#125; &#125;&#125; æ³¨æ„ä¸€ä¸‹,ä½¿ç”¨chiseltestæ— æ³•è¯»å–å†…éƒ¨å¯„å­˜å™¨æˆ–çº¿ç½‘çš„å€¼,åªèƒ½è¯»å–ioæ¥å£çš„å€¼å› æ­¤æ¨èæ·»åŠ å¦‚ä¸Šä»£ç ç”Ÿæˆæ³¢å½¢å›¾æ–¹ä¾¿æµ‹è¯•","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"chisel","slug":"chisel","permalink":"https://tastynoob.github.io/tags/chisel/"}]},{"title":"chisel3å…¥é—¨-ç¯å¢ƒé…ç½®","slug":"chisel/chisel3å…¥é—¨","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.124Z","comments":true,"path":"1970/01/01/chisel/chisel3å…¥é—¨/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/chisel/chisel3%E5%85%A5%E9%97%A8/","excerpt":"chisel3ç¯å¢ƒé…ç½®","text":"chisel3ç¯å¢ƒé…ç½® ä»‹ç»chisel3æ˜¯ä¸€ç§åŸºäºscalaç¼–ç¨‹è¯­è¨€çš„åº“,å®ƒæä¾›äº†ä¸€ä¸ªç®€å•çš„ç¼–ç¨‹æ¥å£,å¯ä»¥ç”¨æ¥ç”Ÿæˆverilogä»£ç ,ä»¥åŠä»¿çœŸå’Œè°ƒè¯•åœ¨å­¦ä¹ chisel3ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¼šå®‰è£…ç¯å¢ƒ ç¯å¢ƒé…ç½®chisel3æ˜¯åŸºäºscalaç¼–ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥ä½ éœ€è¦å®‰è£…scala sdk åŒæ—¶scalaåˆæ˜¯åŸºäºjavaè™šæ‹Ÿæœºï¼Œå› æ­¤ä½ ä¹Ÿéœ€è¦å®‰è£…jdkä¸jre jdkæˆ–jreçš„å®‰è£…ä¸åšä»‹ç» scalaå®˜ç½‘ä¸‹è½½åœ°å€:https://www.scala-lang.org/download/all.html æˆ‘ä»¬é€‰æ‹©ç¨³å®šç‰ˆä¸‹è½½:scala-2.12.15 linuxå’Œwindowså®‰è£…è½¯ä»¶æ–¹æ³•ä¹Ÿä¸åšä»‹ç» windowsä¸Šéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼Œå°†scala&#x2F;binæ–‡ä»¶ç›®å½•æ·»åŠ åˆ°PATHä¸­ linuxæˆ–windowsä¸‹åœ¨ç»ˆç«¯è¾“å…¥ 1scala -version å¦‚æœèƒ½æ­£ç¡®è¾“å‡ºscalaç‰ˆæœ¬å·å°±è¯´æ˜ä½ å®‰è£…æˆåŠŸäº† æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…scalaé¡¹ç›®æ„å»ºå·¥å…·sbt å‰å¾€sbtå®˜ç½‘ä¸‹è½½åœ°å€:https://www.scala-sbt.org/download.html æŒ‰ç…§å®˜æ–¹æ•™ç¨‹å³å¯å®‰è£…å®Œæ¯• ç»ˆç«¯è¾“å…¥ 1sbt -version (ç¬¬ä¸€æ¬¡è¿è¡Œsbtå¯èƒ½éœ€è¦ä¸‹è½½ä¸€äº›èµ„æºï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è€å¿ƒç­‰å¾…)å¦‚æœèƒ½æ­£ç¡®æ˜¾ç¤ºsbtç‰ˆæœ¬å·åˆ™è¯´æ˜å®‰è£…æ— è¯¯ æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…scalaå¼€å‘è½¯ä»¶ è™½ç„¶å¯ä»¥ä½¿ç”¨vscodeå¼€å‘ï¼Œä½†æ˜¯vscodeçš„scalaæ’ä»¶æ”¯æŒå¹¶ä¸å‹å¥½å› æ­¤è¿˜æ˜¯æ¨èideaå¼€å‘ideaéœ€è¦å®‰è£…scalaæ’ä»¶æ‰èƒ½æ”¯æŒscala æ–°å»ºé¡¹ç›®å¦‚æœå‰é¢é…ç½®éƒ½æ²¡é—®é¢˜å°±å¯ä»¥åœ¨æ–°å»ºé¡¹ç›®é‡Œçœ‹åˆ°scalaé¡¹ç›®æ¨¡æ¿æ„å»ºç³»ç»Ÿé€‰æ‹©sbté€‰æ‹©å¥½sbtå’Œscalaå§åˆ›å»ºé¡¹ç›® å¼€å§‹chisel3å¼€å‘åˆ›å»ºå®Œæˆé¡¹ç›®åä¸»ç›®å½•åº”è¯¥ä¼šæœ‰ä¸€ä¸ªâ€build.sbtâ€æ–‡ä»¶æ–‡ä»¶å†…å®¹å¦‚ä¸‹ 12345678ThisBuild / version := &quot;0.1.0-SNAPSHOT&quot;//ä¸ç”¨ç®¡ThisBuild / scalaVersion := &quot;2.13.8&quot;//scalaç‰ˆæœ¬lazy val root = (project in file(&quot;.&quot;)) .settings( name := &quot;untitled2&quot; ) å°±è·Ÿjavaçš„mavenç±»ä¼¼æˆ‘ä»¬ä¹Ÿéœ€è¦æ‰‹åŠ¨æ·»åŠ ä¾èµ–åŒ… æ·»åŠ chisel3ä¾èµ–å¦‚ä¸‹ 123456789101112ThisBuild / version := &quot;0.1.0-SNAPSHOT&quot;ThisBuild / scalaVersion := &quot;2.13.8&quot;val chiselVersion = &quot;3.5.2&quot;lazy val root = (project in file(&quot;.&quot;)) .settings( name := &quot;untitled2&quot;, libraryDependencies += &quot;edu.berkeley.cs&quot; %% &quot;chisel3&quot; % chiselVersion, libraryDependencies += &quot;edu.berkeley.cs&quot; %% &quot;chiseltest&quot; % &quot;0.5.2&quot;, addCompilerPlugin(&quot;edu.berkeley.cs&quot; % &quot;chisel3-plugin&quot; % chiselVersion cross CrossVersion.full) ) æ­¤æ—¶å³ä¸Šè§’ä¼šå‡ºç°ä¸€ä¸ªåˆ·æ–°æŒ‰é’® ç‚¹å‡»å³ä¸Šè§’ï¼Œé‡æ–°å¯¼å…¥ä¾èµ–åŒ…,ç­‰å¾…chisel3ä¸‹è½½å®Œæ¯• å¼€å§‹ç¼–å†™chiselä»£ç å¦‚æœchisel3åŒ…å¯¼å…¥æ— è¯¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç¼–å†™chiselä»£ç äº† æ‰“å¼€src&#x2F;main&#x2F;scala&#x2F;Main.scalaæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç  1234567891011121314151617import chisel3._import chisel3.stage.ChiselStageimport chisel3.util._class Test extends Module &#123; val io = IO(new Bundle &#123; val in = Input(UInt(8.W)) val out = Output(UInt(8.W)) &#125;) io.out := io.in&#125;object Main extends App &#123; (new ChiselStage).emitVerilog(new Test,Array[String](&quot;--target-dir&quot;,&quot;Generated&quot;))&#125; ç‚¹å‡»object Main å·¦è¾¹çš„è¿è¡ŒæŒ‰é’®å³å¯è¿è¡Œchisel3ä»£ç  è¿è¡Œå®Œæˆå°±å¯ä»¥åœ¨Generatedæ–‡ä»¶å¤¹ä¸‹çœ‹åˆ°ç”Ÿæˆçš„Test.væ–‡ä»¶äº† é‚£ä¹ˆç¯å¢ƒé…ç½®å°±åˆ°æ­¤ç»“æŸ","categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"}],"tags":[{"name":"chisel","slug":"chisel","permalink":"https://tastynoob.github.io/tags/chisel/"}]},{"title":"NNQæ¡†æ¶","slug":"æ¡†æ¶/NNQ","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.166Z","comments":true,"path":"1970/01/01/æ¡†æ¶/NNQ/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E6%A1%86%E6%9E%B6/NNQ/","excerpt":"NNQæ˜¯ä¸€ä¸ªç”¨C++è®¾è®¡çš„ç®—æ³•æ¡†æ¶åŒ…å«çŸ©é˜µ,å‘é‡,ç”šè‡³åŒ…æ‹¬ç¥ç»ç½‘ç»œæ­å»ºåªéœ€è¾ƒå°‘çš„èµ„æºå³å¯å®Œæˆå¤§éƒ¨åˆ†ç®—æ³•æ¨èç”¨äºåµŒå…¥å¼é¢†åŸŸ","text":"NNQæ˜¯ä¸€ä¸ªç”¨C++è®¾è®¡çš„ç®—æ³•æ¡†æ¶åŒ…å«çŸ©é˜µ,å‘é‡,ç”šè‡³åŒ…æ‹¬ç¥ç»ç½‘ç»œæ­å»ºåªéœ€è¾ƒå°‘çš„èµ„æºå³å¯å®Œæˆå¤§éƒ¨åˆ†ç®—æ³•æ¨èç”¨äºåµŒå…¥å¼é¢†åŸŸ NNQæ¡†æ¶ä½¿ç”¨ç±»ä¼¼äºç¥ç»ç½‘ç»œå±‚çº§å»ºæ¨¡çš„æ–¹å¼æ¥æ„é€ ç¥ç»ç½‘ç»œæ¨¡å‹ç›®å‰åªæ”¯æŒDNNç½‘ç»œçš„æ„å»ºéƒ¨åˆ†åœ°æ–¹ä»éœ€ä¼˜åŒ– githubä»“åº“:nnq NNQæ¡†æ¶æ­å»ºç®€å•çš„DNNç½‘ç»œ: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#include &lt;iostream&gt;#include &lt;time.h&gt;#include &lt;math.h&gt;#include &lt;queue&gt;#include &lt;math.h&gt;#include &lt;string&gt;#include &lt;vector&gt;using namespace std;#include &quot;NNQ/nnq.hpp&quot;using namespace nnq;nnl::Model m = &#123; Func::Linear(1,20,0.001), Func::Sigmoid(20), Func::Linear(20,20,0.001), Func::Sigmoid(20), Func::Linear(20,1,0.0001),&#125;;int main() &#123; qVec in(1); qVec out(1); qVec ideal(1); qVec loss(1); qVec grad(1); srand((unsigned)time(NULL)); mode = 1; for(int i = 0; i &lt; 20000; i++) &#123; for (int j = 0; j &lt; 100; j++) &#123; float a = sin(j / 10); in[0] = j/10; ideal[0] = a; out &lt;= m(in); Func::square_loss(loss,out, ideal, grad); m[grad]; &#125; qtype ls = loss[0]; cout &lt;&lt; ls &lt;&lt; endl; &#125; mode = 0; for (int j = 0; j &lt; 100; j++) &#123; int k = abs(rand()) % 100; float a = sin(k / 10); in[0] = k / 10; out &lt;= m(in); cout &lt;&lt; &quot;real:&quot; &lt;&lt; out[0] &lt;&lt; &quot; ideal:&quot; &lt;&lt; a &lt;&lt; endl; &#125;&#125;","categories":[{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://tastynoob.github.io/categories/%E6%A1%86%E6%9E%B6/"},{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"mallocå®ç°","slug":"ç®—æ³•/mallocå®ç°","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.171Z","comments":true,"path":"1970/01/01/ç®—æ³•/mallocå®ç°/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/malloc%E5%AE%9E%E7%8E%B0/","excerpt":"mallocå®ç°","text":"mallocå®ç° ä¸‹é¢ä¸»è¦ä»‹ç»2ç§mallocå®ç° ç¬¬ä¸€ç§æ˜¯å†…å­˜çš„å—å¼ç®¡ç†ï¼Œç¬¬äºŒç§æ˜¯å†…å­˜çš„é“¾å¼ç®¡ç† é¦–å…ˆæ˜¯è´´ä»£ç  å—å¼ç®¡ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475#include &lt;stdio.h&gt;typedef unsigned int u32;//å—å¼ç®¡ç†ï¼Œå†…å­˜å—çš„æ•°é‡#define block_num 128typedef struct &#123; int mem[32];//ä¸€ä¸ªå—128å­—èŠ‚&#125;block;#define block_size sizeof(block)typedef struct &#123; block blocks[block_num]; char table[block_num];&#125; alloc_mem;alloc_mem alloc_ptr;void myalloc_init() &#123; sizeof(alloc_mem); //åˆå§‹åŒ–è¡¨é¡¹ for (int i = 0; i &lt; block_num ; i++) &#123; alloc_ptr.table[i] = 0; &#125;&#125;//åˆ†é…å†…å­˜ç©ºé—´void* myalloc(u32 size) &#123; //å®é™…éœ€è¦åˆ†é…çš„è¿ç»­å†…å­˜å— int block_len = (size+8) / block_size + (((size+8) % block_size) ? 1 : 0); //ä»è¡¨å•ä¸­æœç´¢ for (int thp = 0; thp &lt; block_num - block_len + 1; thp++) &#123; int tep = thp + block_len; int bvld = 0;//å†…å­˜å—å¯ç”¨ for (int i = thp; i &lt; tep; i++) &#123; bvld |= alloc_ptr.table[i]; &#125; if (!bvld) &#123;//å¦‚æœbvld==0ï¼Œä»£è¡¨å†…å­˜å—å¯ç”¨ //è®¾ç½®å ç”¨ for (int i = thp; i &lt; tep; i++) &#123; alloc_ptr.table[i] = 1; &#125; //å°†å†…å­˜å—çš„å‰4ä¸ªå­—èŠ‚è®¾ç½®ä¸ºå—é•¿åº¦ *((int*)&amp;alloc_ptr.blocks[thp]) = block_len; *(((int*)&amp;alloc_ptr.blocks[thp]) + 1) = thp;//ç´¢å¼•æŒ‡é’ˆ return (void*)(((int*)&amp;alloc_ptr.blocks[thp])+2); &#125;//å¦åˆ™ç»§ç»­æœç´¢ &#125; return NULL;//æ²¡æœ‰æœç´¢åˆ°&#125;void myfree(void* ptr) &#123; int block_len = *((int*)ptr - 2); int thp = *((int*)ptr - 1); for (int i = thp; i &lt; thp + block_len; i++) &#123; alloc_ptr.table[i] = 0; &#125;&#125;int main() &#123; myalloc_init(); int* p = myalloc(10 * sizeof(int)); for (int i = 0; i &lt; 10; i++) &#123; p[i] = i + 1; &#125; for (int i = 0; i &lt; 10; i++) &#123; printf(&quot;%d\\n&quot;, p[i]); &#125;&#125; é“¾å¼ç®¡ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;math.h&gt;typedef unsigned int u32;u32* buff;#define alloc_addr ((int)buff)#define alloc_size 1024*4typedef struct &#123; int size;//å†…å­˜å—å¤§å° int avaliable;//æ˜¯å¦æ¿€æ´» void* next;//ä¸‹ä¸€ä¸ªå—&#125; mem_block;mem_block* alloc_head;void myalloc_init() &#123; buff = malloc(alloc_size); alloc_head = (mem_block*)buff; alloc_head-&gt;size = 0; alloc_head-&gt;avaliable = 0; alloc_head-&gt;next = 0;&#125;void* myalloc(u32 sizeofbyte) &#123; mem_block* temp = alloc_head;//æŒ‡å‘å½“å‰å— if (sizeofbyte == 0) &#123; return NULL; &#125; //å®é™…åˆ†é…çš„å¤§å° int real_size = 4 * (sizeofbyte / 4 + ((sizeofbyte % 4) ? 1 : 0)); while (1) &#123; if (temp-&gt;avaliable == 0) &#123; //å½“å‰å—æ²¡æœ‰è¢«ä½¿ç”¨ alloc_new: if (temp-&gt;next == 0) &#123; //å‡å¦‚ä¸‹ä¸€ä¸ªå—ä¸ºç©ºï¼Œåˆ™åˆ†é…å½“å‰å— //å¦‚æœå‰©ä½™ç©ºé—´ä¸è¶³ä»¥åˆ†é… if (((int)temp) + real_size &gt; alloc_addr + alloc_size) &#123; return NULL; &#125; temp-&gt;size = real_size; temp-&gt;avaliable = 1; temp-&gt;next = ((char*)temp + sizeof(mem_block)) + real_size; //æ²¡æœ‰è¶…ç•Œ if ((temp-&gt;next &gt; buff) &amp;&amp; (((int)temp-&gt;next) + sizeof(mem_block) &lt; (alloc_addr + alloc_size))) &#123; ((mem_block*)temp-&gt;next)-&gt;size = 0; ((mem_block*)temp-&gt;next)-&gt;avaliable = 0; ((mem_block*)temp-&gt;next)-&gt;next = 0; &#125; break; &#125; else &#123; //ä¸‹ä¸€ä¸ªå—ä¸ä¸ºç©º if (temp-&gt;size &gt;= real_size) &#123; //å¦‚æœå½“å‰å—çš„å¤§å°æ»¡è¶³è¦æ±‚ //å¦‚æœå½“å‰å—å‡å»åˆ†é…çš„å†…å­˜ï¼Œå‰©ä½™çš„å¤§å°è¿˜èƒ½å¤Ÿå†åˆ†é…ä¸€ä¸ªå°å— if (temp-&gt;size - real_size &gt; sizeof(mem_block) + 4) &#123; //æ–°å— mem_block* temp1 = (mem_block*)(((char*)(temp + 1)) + real_size); temp1-&gt;size = temp-&gt;size - real_size - sizeof(mem_block); temp1-&gt;avaliable = 0; temp1-&gt;next = temp-&gt;next; temp-&gt;next = temp1; temp-&gt;size = real_size; &#125; else&#123; real_size=temp-&gt;size; &#125; temp-&gt;avaliable = 1; break; &#125; else &#123; //ä¸æ»¡è¶³è¦æ±‚ (ä¸‹ä¸€ä¸ªå—ä¸ä¸ºç©ºå¹¶ä¸”å½“å‰å—ä¸æ»¡è¶³è¦æ±‚) if (((mem_block*)temp-&gt;next)-&gt;avaliable == 0) &#123; // å¦‚æœä¸‹ä¸€ä¸ªå—æ²¡æœ‰æ¿€æ´»ï¼Œåˆ™å¯ä»¥åˆ†é…åˆ°å½“å‰å— temp-&gt;size = temp-&gt;size + ((mem_block*)temp-&gt;next)-&gt;size + sizeof(mem_block);//é‡æ–°åˆ†é…å½“å‰å—çš„å¤§å° temp-&gt;next = ((mem_block*)temp-&gt;next)-&gt;next;//é‡æ–°æ”¹å˜æŒ‡å‘ä¸‹ä¸€å—çš„æŒ‡é’ˆ goto alloc_new; //é‡æ–°è¿›è¡Œå†…å­˜åˆ†é…åˆ¤æ–­ &#125; else &#123;//ä¸‹ä¸€ä¸ªå—å·²è¢«æ¿€æ´»ï¼Œè·³è¿‡ &#125; &#125; &#125; &#125; //å¦‚æœæŒ‡é’ˆæŒ‡å‘æ­£ç¡® if ((temp-&gt;next &gt; buff) &amp;&amp; (temp-&gt;next &lt; (alloc_addr + alloc_size))) &#123; temp = temp-&gt;next; &#125; else &#123; return NULL; &#125; &#125; if (temp-&gt;size == real_size) &#123; return ((char*)temp + sizeof(mem_block)); &#125; return NULL;&#125;void myfree(void* ptr) &#123; if ((int)ptr &gt;= alloc_addr) &#123; mem_block* temp = ((mem_block*)ptr - 1); temp-&gt;avaliable = 0; &#125;&#125;int main() &#123; myalloc_init(); //[30,70] 00 000 00 int* p1 = myalloc(100); int* p2 = myalloc(200); int* p3 = myalloc(300); myfree(p1); p1 = myalloc(200); int* p4 = myalloc(30);&#125; ä»ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå—å¼å’Œé“¾å¼æœ€æ ¹æœ¬çš„åŒºåˆ«å°±åœ¨å»å†…å­˜åˆ†å—æœºåˆ¶çš„ä¸åŒ å—å¼ç®¡ç†ç®€å•æ–¹ä¾¿ï¼Œä½†æ˜¯å†…å­˜åˆ©ç”¨ç‡ä¸é«˜å—å¼ç®¡ç†å³ç®€å•çš„å°†å†…å­˜åˆ†ä¸ºå›ºå®šçš„å‡ å—ï¼Œç„¶åå»ºç«‹ä¸€ä¸ªæŸ¥æ‰¾è¡¨æ ¹æ®æŸ¥æ‰¾è¡¨åˆ†é…å†…å­˜ é“¾å¼ç®¡ç†å¯ä»¥åŠ¨æ€åˆ†é…ä¸€å®šå¤§å°çš„å†…å­˜å—ï¼Œå†…å­˜åˆ©ç”¨ç‡é«˜ï¼Œä½†æ˜¯ç®¡ç†éº»çƒ¦é“¾å¼ç®¡ç†å³ä½¿ç”¨é“¾è¡¨åŠ¨æ€åˆ†é…å†…å­˜å’Œå›æ”¶ï¼Œæ¯æ¬¡åˆ†é…å†…å­˜éœ€ä»å¤´å¼€å§‹æŸ¥æ‰¾ï¼Œå¦‚æœæœ‰æœªåˆ©ç”¨å†…å­˜è¿˜éœ€é‡æ–°åˆ†é…è¾ƒä¸ºå¤æ‚ ä»¥ä¸Šä»£ç ä»…ä¾›å‚è€ƒ","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç³»ç»Ÿ","slug":"ç³»ç»Ÿ","permalink":"https://tastynoob.github.io/tags/%E7%B3%BB%E7%BB%9F/"}]},{"title":"PIDç®—æ³•","slug":"ç®—æ³•/pidç®—æ³•","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.171Z","comments":true,"path":"1970/01/01/ç®—æ³•/pidç®—æ³•/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/pid%E7%AE%97%E6%B3%95/","excerpt":"PIDç®—æ³•","text":"PIDç®—æ³• åœ¨ç³»ç»Ÿæ§åˆ¶é¢†åŸŸï¼Œpidç®—æ³•ç®—æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ§åˆ¶ç®—æ³• ç”±äºPIDç®—æ³•æ¯”è¾ƒç®€å• è¿™é‡Œç›´æ¥è´´pythonä»£ç  1234567891011121314151617181920212223#æ¨¡æ‹Ÿpidæ§åˆ¶å™¨kp = 0.05ki = 0.01kd = 0.01#ä¸€æ¬¡pidè¿­ä»£last_error = 0integral = 0def pid_iteration(pv, set_point): global last_error global integral error = set_point - pv integral = integral + error derivative = error - last_error output = kp * error + ki * integral + kd * derivative last_error = error return outputstart = 0point = 100for i in range(0,100): start = start + pid_iteration(start, point) print(start)","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"}]},{"title":"pyaudioå®ç°2ç‚¹å£°æºå®šä½","slug":"ç®—æ³•/pyaudioå®ç°2ç‚¹å£°æºå®šä½","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.172Z","comments":true,"path":"1970/01/01/ç®—æ³•/pyaudioå®ç°2ç‚¹å£°æºå®šä½/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/pyaudio%E5%AE%9E%E7%8E%B02%E7%82%B9%E5%A3%B0%E6%BA%90%E5%AE%9A%E4%BD%8D/","excerpt":"ä½¿ç”¨pyaudioå’Œnumpyè®¾è®¡çš„2ç‚¹å£°æºå®šä½ç®—æ³•","text":"ä½¿ç”¨pyaudioå’Œnumpyè®¾è®¡çš„2ç‚¹å£°æºå®šä½ç®—æ³• ä¸å¢¨è¿¹ç›´æ¥ä¸Šä»£ç ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980import pyaudioimport numpy as npimport matplotlib.pyplot as pltfrom mpl_toolkits.mplot3d import Axes3D#2ä¸ªéº¦å…‹é£nmicro=2#2ä¸ªéº¦å…‹é£é˜µå…ƒçš„åæ ‡,ä»¥éº¦å…‹é£aä¸ºåŸç‚¹,bä¸ºxè½´è´Ÿè½´,å•ä½:ç±³#è¿™é‡Œä½¿ç”¨çš„æ˜¯ç”µè„‘éº¦å…‹é£,2ä¸ªéº¦å…‹é£é—´è·çº¦ä¸º2åˆ†ç±³pos = np.array([0,-0.2])print(pos)#PyAudioçš„ä¿¡å·é‡‡é›†å‚æ•°CHUNK = 4800FORMAT = pyaudio.paInt16CHANNELS = 2RATE = 48000p = pyaudio.PyAudio()stream = p.open(format=FORMAT, channels=CHANNELS, rate=RATE, input=True, frames_per_buffer=CHUNK)#éå†çš„xï¼Œå‡è®¾zä¸ºå›ºå®šæ·±åº¦1mX_STEP=100x = np.linspace(-0.8, 0.8, X_STEP)A_STEP=100p = np.zeros(x.shape[0]) # å£°å¼ºè°±çŸ©é˜µwhile True: data = stream.read(CHUNK,exception_on_overflow=False)#1600*2*2 data = np.frombuffer(data, dtype=np.short) data = data.reshape(CHUNK, 2)[:, :2].T#åˆ’åˆ†å·¦å³å£°é“,shape:(2,1600) #å‚…é‡Œå¶å˜æ¢ï¼Œåœ¨é¢‘åŸŸè¿›è¡Œæ£€æµ‹ data_n = np.fft.fft(data)/data.shape[1] # [2,1600] data_n = data_n[:, :data.shape[1]//2] #å–å‰ä¸€åŠé¢‘ç‡ data_n[:, 1:] *= 2 #å°†é¢‘ç‡èŒƒå›´å†…çš„é¢‘ç‡å¹…å€¼ç¿»å€ #å®½å¸¦å¤„ç†ï¼Œå¯¹äº50ä¸ªä¸åŒçš„é¢‘ç‡éƒ½è¿›è¡Œè®¡ç®— #rå­˜å‚¨æ¯ä¸ªé¢‘ç‡ä¸‹å¯¹åº”ä¿¡å·çš„RçŸ©é˜µ r = np.zeros((A_STEP, nmicro,nmicro), dtype=complex) for fi in range(1, A_STEP+1): #è®¡ç®—æ¯ä¸ªé¢‘ç‡ä¸‹çš„RçŸ©é˜µ #è‡ªç›¸å…³å‡½æ•° rr = np.dot(data_n[:, fi*10-10:fi*10+10], data_n[:, fi*10-10:fi*10+10].T.conjugate())/nmicro r[fi-1, ...] = np.linalg.inv(rr) #MVDRæœç´¢è¿‡ç¨‹ for i in range(x.shape[0]): dm = np.sqrt(x[i]**2 + 1) delta_dn = pos*x[i]/dm #éå†è§’åº¦ for fi in range(1, A_STEP+1): #è®¡ç®—å¯¼å‘å‘é‡ a = np.exp(-1j*2*np.pi*fi*100*delta_dn/340) p[i] = p[i] + 1 / np.abs(np.dot(np.dot(a.conjugate(), r[fi-1]), a))#è®¡ç®—æ¯ä¸ªé¢‘ç‡ä¸‹çš„å£°å¼ºè°± p /= np.max(p) #è·å–å‰5ä¸ªæœ€å¤§å€¼ p_max = np.argsort(p)[-5:] #è¾“å‡ºå£°æºæ‰€åœ¨çš„æ–¹å‘ print(np.average(p_max)) #ä»¥æ³¢å½¢å›¾æ˜¾ç¤ºå£°å¼ºè°± plt.clf() plt.plot(x, np.abs(p)) plt.xlabel(&#x27;x&#x27;) plt.ylabel(&#x27;p&#x27;) plt.pause(0.01) æœ‰æ—¶é—´å†ä»”ç»†è®²è®²ç®—æ³•æ¨å¯¼","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"},{"name":"å£°å­¦","slug":"å£°å­¦","permalink":"https://tastynoob.github.io/tags/%E5%A3%B0%E5%AD%A6/"}]},{"title":"ä¸€ä¸ªç®€å•çš„3dæ¸²æŸ“å™¨","slug":"ç®—æ³•/ä¸€ä¸ªååˆ†ç®€å•çš„3dæ¸²æŸ“å™¨","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.172Z","comments":true,"path":"1970/01/01/ç®—æ³•/ä¸€ä¸ªååˆ†ç®€å•çš„3dæ¸²æŸ“å™¨/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E4%B8%80%E4%B8%AA%E5%8D%81%E5%88%86%E7%AE%80%E5%8D%95%E7%9A%843d%E6%B8%B2%E6%9F%93%E5%99%A8/","excerpt":"ä¸€ä¸ªç®€å•çš„3Dæ¸²æŸ“å™¨ä»…æ”¯æŒä¸‰ç»´ç‰©ä½“çš„æ¸²æŸ“ä¸åŒ…æ‹¬ç€è‰²ç³»ç»Ÿ","text":"ä¸€ä¸ªç®€å•çš„3Dæ¸²æŸ“å™¨ä»…æ”¯æŒä¸‰ç»´ç‰©ä½“çš„æ¸²æŸ“ä¸åŒ…æ‹¬ç€è‰²ç³»ç»Ÿ é—²æ¥æ— äº‹å†™çš„ç©çš„é¡¹ç›® ä¸»è¦ç®—æ³•æ˜¯åˆ©ç”¨çŸ©é˜µä¹˜æ³•æ¥å®ç°å¯¹ç‰©ä½“é¡¶ç‚¹çš„å˜æ¢ å†åˆ©ç”¨ä¸­å¿ƒæŠ•å½±ç®—æ³•å°†ç‰©ä½“æŠ•å½±åˆ°å±å¹•ç¼“å†²åŒºä¸Š å®é™…ä¸Šæœ€ä¸»è¦çš„æ˜¯å¦‚ä½•æŠ•å½±,å¦‚ä½•æ¸²æŸ“ å¯¹äºç®€å•çš„3dæ¸²æŸ“åªéœ€è¦ä½¿ç”¨å¾ˆç®€å•çš„ç®—æ³•å³å¯å®ç° æ¯”å¦‚ç‰©ä½“çš„æ—‹è½¬,å¹³ç§»,ç¼©æ”¾å‡å¯ä½¿ç”¨åˆä¸­çŸ¥è¯† æ›´è¿›ä¸€æ­¥å¯ä»¥ä½¿ç”¨çŸ©é˜µå˜æ¢æ¥å®ç°æ›´å¤æ‚çš„ç‰©ä½“å˜æ¢ è¿™é‡Œä½¿ç”¨çŸ©é˜µå˜æ¢è¿›è¡Œæ“ä½œ ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101//ä¸­å¿ƒæŠ•å½±//è®¤ä¸ºæ‘„åƒæœºä½äº(0,0,d)çš„ä½ç½®Vec3 Project(Vec3&amp; a, qval d) &#123; Vec3 n; n[0] /= (1 - a[2] / d); n[1] /= (1 - a[2] / d); n[2] /= (1 - a[2] / d); return n;&#125;//çŸ©é˜µä¹˜æ³•void Mat4Mul(TMat&amp; a, TMat&amp; b, TMat&amp; c) &#123; TMat temp; for (quint i = 0; i &lt; 4; i++) &#123; for (quint j = 0; j &lt; 4; j++) &#123; temp[i][j] = a[i][0] * b[0][j] + a[i][1] * b[1][j] + a[i][2] * b[2][j] + a[i][3] * b[3][j]; &#125; &#125; c = temp;&#125;//ç»•x,y,zè½´æ—‹è½¬void TMat::Rotate(qval x, qval y, qval z) &#123; //ç»•xè½´æ—‹è½¬ float ax[4][4]&#123; &#123; 1, 0, 0, 0 &#125;, &#123; 0, cos(x), -sin(x), 0 &#125;, &#123; 0, sin(x), cos(x), 0 &#125;, &#123; 0, 0, 0, 1 &#125; &#125;; //ç»•yè½´æ—‹è½¬ float ay[4][4]&#123; &#123; cos(y), 0, sin(y), 0 &#125;, &#123; 0, 1, 0, 0 &#125;, &#123; -sin(y), 0, cos(y), 0 &#125;, &#123; 0, 0, 0, 1 &#125; &#125;; //ç»•zè½´æ—‹è½¬ float az[4][4]&#123; &#123; cos(z), -sin(z), 0, 0 &#125;, &#123; sin(z), cos(z), 0, 0 &#125;, &#123; 0, 0, 1, 0 &#125;, &#123; 0, 0, 0, 1 &#125; &#125;; TMat tempx(ax); TMat tempy(ay); TMat tempz(az); TMat temp; Mat4Mul(tempx, tempy, temp); Mat4Mul(temp, tempz, temp); Mat4Mul(temp, *this, *this);&#125;//å¹³ç§»void TMat::Translate(qval x, qval y, qval z) &#123; float a[4][4]&#123; &#123; 1, 0, 0, x &#125;, &#123; 0, 1, 0, y &#125;, &#123; 0, 0, 1, z &#125;, &#123; 0, 0, 0, 1 &#125; &#125;; TMat temp(a); Mat4Mul(temp, *this, *this);&#125;//ç¼©æ”¾void TMat::Scale(qval x, qval y, qval z) &#123; float a[4][4]&#123; &#123; x, 0, 0, 0 &#125;, &#123; 0, y, 0, 0 &#125;, &#123; 0, 0, z, 0 &#125;, &#123; 0, 0, 0, 1 &#125; &#125;; TMat temp(a); Mat4Mul(temp, *this, *this);&#125;//ä¸­å¿ƒæŠ•å½±//è®¤ä¸ºæ‘„åƒæœºä½äº(0,0,d)çš„ä½ç½®void TMat::Projection(qval d) &#123; float a[4][4]&#123; &#123; 1, 0, 0, 0 &#125;, &#123; 0, 1, 0, 0 &#125;, &#123; 0, 0, 1, 0 &#125;, &#123; 0, 0, -1/d, 1&#125; &#125;; TMat temp(a); Mat4Mul(temp, *this, *this);&#125;//å¯¹é¡¶ç‚¹åº”ç”¨å˜æ¢çŸ©é˜µvoid Vec3::Multiply(TMat&amp; tm) &#123; qval x = vec[0] * tm[0][0] + vec[1] * tm[0][1] + vec[2] * tm[0][2] + tm[0][3]; qval y = vec[0] * tm[1][0] + vec[1] * tm[1][1] + vec[2] * tm[1][2] + tm[1][3]; qval z = vec[0] * tm[2][0] + vec[1] * tm[2][1] + vec[2] * tm[2][2] + tm[2][3]; qval w = vec[0] * tm[3][0] + vec[1] * tm[3][1] + vec[2] * tm[3][2] + tm[3][3]; vec[0] = x / w; vec[1] = y / w; vec[2] = z / w;&#125; å¯¹äºç‰©ä½“æ¸²æŸ“ æœ€åŸºæœ¬çš„æ˜¯ä½¿ç”¨ä¸‰è§’å½¢è¿›è¡Œç‰©ä½“æ¸²æŸ“ å°†ç‰©ä½“è¡¨é¢åˆ†å‰²ä¸ºä¸‰è§’å½¢,å¹¶ä¸”æŠŠä¸‰è§’å½¢æ¸²æŸ“åˆ°å±å¹•ä¸Š ç„¶åè¦ä¸»è¦æ¸²æŸ“çš„å±‚æ¬¡å…³ç³» æ¯”å¦‚ä¸€ä¸ªä¸‰è§’å½¢è¢«å¦ä¸€ä¸ªä¸‰è§’å½¢é®æŒ¡,åˆ™éœ€è¦æŠŠæ²¡æœ‰è¢«é®æŒ¡çš„éƒ¨åˆ†æ¸²æŸ“å‡ºæ¥ è¿™é‡Œä½¿ç”¨çš„æ˜¯Z-bufferç®—æ³• ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283//åˆ©ç”¨å‰ä¹˜åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…éƒ¨//vec3,vec3,vec3,vec2#define crossProduct(a, b, c, p) \\ Vec2 pa(a[0] - p[0], a[1] - p[1]);\\ Vec2 pb(b[0] - p[0], b[1] - p[1]);\\ Vec2 pc(c[0] - p[0], c[1] - p[1]);\\ bool k1 = (pa ^ pb) &gt;= 0;\\ bool k2 = (pb ^ pc) &gt;= 0;\\ bool k3 = (pc ^ pa) &gt;= 0;\\ avalid = (k1 &amp;&amp; k2 &amp;&amp; k3) || (!(k1||k2||k3));//åœ¨zbuffä¸­ç»˜åˆ¶ä¸‰è§’å½¢//poscol:ä¸‰ä¸ªé¡¶ç‚¹çš„é¢œè‰²(å¦‚æœä¸ä½¿ç”¨é¢œè‰²æ··åˆåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„é¢œè‰²)//use_colmix:æ˜¯å¦ä½¿ç”¨é¢œè‰²æ··åˆvoid DrawTriangle(Vec3 pos[3], qcol* poscol = nullptr , bool use_colmix = false) &#123; qval x1, y1, z1, x2, y2, z2, x3, y3, z3; x1 = pos[0][0] + screen_width / 2; y1 = screen_height / 2 - pos[0][1]; z1 = pos[0][2]; x2 = pos[1][0] + screen_width / 2; y2 = screen_height / 2 - pos[1][1]; z2 = pos[1][2]; x3 = pos[2][0] + screen_width / 2; y3 = screen_height / 2 - pos[2][1]; z3 = pos[2][2]; Vec3 npos[3]; npos[0][0] = x1; npos[0][1] = y1; npos[0][2] = z1; npos[1][0] = x2; npos[1][1] = y2; npos[1][2] = z2; npos[2][0] = x3; npos[2][1] = y3; npos[2][2] = z3; qval minX = min(x1, min(x2, x3)); minX = minX &lt; 0 ? 0 : minX; qval maxX = max(x1, max(x2, x3)); maxX = maxX &gt; screen_width ? screen_width : maxX; qval minY = min(y1, min(y2, y3)); minY = minY &lt; 0 ? 0 : minY; qval maxY = max(y1, max(y2, y3)); maxY = maxY &gt; screen_height ? screen_height : maxY; //æ±‚å¹³é¢æ–¹ç¨‹ qval ak, bk, ck, dk; // A = (y2 - y1)(z3 - z1) - (z2 - z1)(y3 - y1); ak = (npos[1][1] - npos[0][1]) * (npos[2][2] - npos[0][2]) - (npos[1][2] - npos[0][2]) * (npos[2][1] - npos[0][1]); // B = (x3 - x1)(z2 - z1) - (z3 - z1)(x2 - x1); bk = (npos[2][0] - npos[0][0]) * (npos[1][2] - npos[0][2]) - (npos[2][2] - npos[0][2]) * (npos[1][0] - npos[0][0]); // C = (x2 - x1)(y3 - y1) - (y2 - y1)(x3 - x1); ck = (npos[1][0] - npos[0][0]) * (npos[2][1] - npos[0][1]) - (npos[1][1] - npos[0][1]) * (npos[2][0] - npos[0][0]); // D = -(A * x1 + B * y1 + C * z1); dk = -(ak * npos[0][0] + bk * npos[0][1] + ck * npos[0][2]); for (quint px = minX;px &lt; maxX;px++) &#123; for (quint py = minY;py &lt; maxY;py++) &#123; Vec2 p_(px, py); //åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…éƒ¨ bool avalid; crossProduct(npos[0], npos[1], npos[2], p_); if (avalid) &#123; //è®¡ç®—pç‚¹çš„æ·±åº¦ qval pz = -(ak * px + bk * py + dk) / ck; //åˆ¤æ–­æ·±åº¦æ˜¯å¦åœ¨æ‘„åƒå¤´è§†é”¥ä½“å†… if (pz &gt; Zbuf[py][px]) &#123; //è®¡ç®—æ·±åº¦ Zbuf[py][px] = pz; //è®¡ç®—é¢œè‰² Zcol[py][px] = poscol[0]; &#125; &#125; &#125; &#125;&#125; è¿™é‡Œä»…å±•ç¤ºéƒ¨åˆ†ä»£ç ,ä½†ä¹Ÿå¤Ÿç”¨ å¯¹äºç®€å•çš„3dæ¸²æŸ“ä¹Ÿç”¨ä¸æ‰“ç ´å¤ªå¤æ‚çš„æŠ€æœ¯ æ¸²æŸ“æ•ˆæœå¦‚ä¸‹","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"å›¾å½¢å­¦","slug":"å›¾å½¢å­¦","permalink":"https://tastynoob.github.io/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"}]},{"title":"å‰å‘æ±‚å¯¼ç®—æ³•","slug":"ç®—æ³•/å‰å‘æ±‚å¯¼ç®—æ³•","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.172Z","comments":true,"path":"1970/01/01/ç®—æ³•/å‰å‘æ±‚å¯¼ç®—æ³•/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E5%89%8D%E5%90%91%E6%B1%82%E5%AF%BC%E7%AE%97%E6%B3%95/","excerpt":"å‰å‘æ±‚å¯¼ç®—æ³•","text":"å‰å‘æ±‚å¯¼ç®—æ³• åœ¨ç¥ç»ç½‘ç»œå½“ä¸­éœ€è¦åˆ©ç”¨åå‘ä¼ æ’­ç®—æ³•å¯¹ç¥ç»ç½‘ç»œè¿›è¡Œè®­ç»ƒ åˆæˆ–è€…åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚å±€éƒ¨æœ€ä¼˜è§£ ä½†æ˜¯æˆ‘ä»¬åˆä¸æƒ³å»æ‰‹åŠ¨æ±‚å¯¼ å¯¹äºå¤æ‚çš„å‡½æ•°æ±‚å¯¼æ˜¯ä»¶å¾ˆç—›è‹¦çš„äº‹ æ‰€ä»¥åƒæ˜¯pytorchè¿™ç±»ç¥ç»ç½‘ç»œæ¡†æ¶éƒ½æä¾›äº†è‡ªåŠ¨æ±‚å¯¼ï¼Œæˆ–è€…è‡ªåŠ¨å¾®åˆ†æœºåˆ¶ è¿™é‡Œå°±æ¥ä»‹ç»ä¸‹ä¸€ç§æœ€ç®€å•çš„è‡ªåŠ¨æ±‚å¯¼ç®—æ³•:å‰å‘æ±‚å¯¼ é¦–å…ˆæˆ‘ä»¬å®šä¹‰$\\epsilon$è¶‹è¿‘äº0ï¼Œä½†æ˜¯ä¸ç­‰äº0 å› æ­¤$\\frac{f(x+\\epsilon)-f(x)}{\\epsilon}&#x3D;f^{â€˜}(x)$æ¨å¯¼å¾—$f(x+\\epsilon) &#x3D; f(x) + f^{â€˜}(x)\\epsilon$ æ›´ä¸€èˆ¬çš„æˆ‘ä»¬è®¾äºŒå…ƒæ•°$a+b\\epsilon$,åˆ™æœ‰$f(a+b\\epsilon) &#x3D; f(a) + f^{â€˜}(a)b\\epsilon$ è‡³æ­¤æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæ±‚å¯¼çš„æ™®éå…¬å¼å³$f(a+b\\epsilon) &#x3D; f(a) + f^{â€˜}(a)b\\epsilon$å…¶ä¸­$a\\in R,b\\in R,\\epsilon\\to0$ ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ä»¬è®¾äºŒå…ƒæ•°$a+b\\epsilon$å…¶æœ‰å¦‚ä¸‹ç‰¹å¾$(a+b\\epsilon)+(c+d\\epsilon)&#x3D;(a+c)+(b+d)\\epsilon$ç”±äº$\\epsilon\\to0$,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸º$\\epsilon^2&#x3D;0$ç±»ä¼¼äºè™šæ•°å•ä½$i^2&#x3D;-1$æ‰€ä»¥æœ‰ä¹˜æ³•å…¬å¼$(a+b\\epsilon)(c+d\\epsilon)&#x3D;ac+(ad+bc)\\epsilon$ æ›´è¿›ä¸€æ­¥ï¼Œæ ¹æ®$f(a+b\\epsilon) &#x3D; f(a) + f^{â€˜}(a)b\\epsilon$å¯ä»¥æ¨å¯¼å¾—$n^{(a+b\\epsilon)} &#x3D; n^a+(bn^a\\ln{n})\\epsilon,n\\in R$$(a+b\\epsilon)^n &#x3D; a^n + (nba^{n-1})\\epsilon,n\\in R$ è¿™å°±æ„å‘³ç€äºŒå…ƒæ•°$a+b\\epsilon$æ»¡è¶³æ‰€æœ‰çš„æ•°å­¦è¿ç®— åªè¦æˆ‘ä»¬å·²çŸ¥å‡½æ•°$f(x)$æˆ‘ä»¬é€šè¿‡ä»£å…¥äºŒå…ƒæ•°$f(a+\\epsilon)&#x3D;f(a)+f^{â€˜}(a)\\epsilon$å°±èƒ½æ±‚å¾—è¯¥ç‚¹çš„å‡½æ•°å€¼å’Œå¯¼æ•° è¿™å°±æ˜¯å‰å‘æ±‚å¯¼ç®—æ³• å…·ä½“ä»£ç å¯æœ‰pythonå®ç° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364import numpy as npimport math#å®šä¹‰äºŒå…ƒæ•°,å‰å‘æ¨¡å¼ç®—æ³•class Dual: a=0 e=0#æ— ç©·å°é‡çš„ç³»æ•° def __init__(self,a,e): self.a = a self.e = e def __add__(self,other): if type(other)!=Dual: return Dual(self.a+other,self.e) return Dual(self.a+other.a,self.e+other.e) def __radd__(self,other): return self.__add__(other) def __sub__(self,other): if type(other)!=Dual: return Dual(self.a-other,self.e) return Dual(self.a-other.a,self.e-other.e) def __rsub__(self,other): return self.__sub__(other) def __mul__(self,other): if type(other)!=Dual: return Dual(self.a*other,self.e*other) return Dual(self.a*other.a,self.a*other.e+self.e*other.a) def __rmul__(self,other): return self.__mul__(other) def __truediv__(self,other): if type(other)!=Dual: return Dual(self.a/other,self.e/other) return Dual(self.a/other.a,(self.e*other.a-self.a*other.e)/(other.a**2)) def __rtruediv__(self,other): return Dual(other/self.a, -other*self.e/self.a**2) #dual**x def __pow__(self,other): return Dual(self.a**other,other*self.a**(other-1)*self.e) #x**dual def __rpow__(self,other): return Dual(other**self.a,other**self.a*self.e*math.log(other)) #å®šä¹‰æ¯”è¾ƒè¿ç®—ç¬¦ def __eq__(self,other): return self.a==other.a and self.e==other.e def __ne__(self,other): return not self.__eq__(other) def __gt__(self,other): return self.a&gt;other.a def __ge__(self,other): return self.a&gt;=other.a def __lt__(self,other): return self.a&lt;other.a def __le__(self,other): return self.a&lt;=other.a def __str__(self): return str(self.a) + (&#x27;+&#x27; if self.e &gt;= 0 else &#x27;&#x27;) +str(self.e)+&#x27;E&#x27; def __repr__(self): return str(self.a) + (&#x27;+&#x27; if self.e &gt;= 0 else &#x27;&#x27;) + str(self.e)+&#x27;E&#x27;def F(X): return 0.05*4*X**4 + 5.2*3*X**3 - 0.005*2*X**2 + 2.3*1*X + 12.3a = Dual(10,1)print(a)print(F(a))","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"åå‘æ±‚å¯¼ç®—æ³•","slug":"ç®—æ³•/åå‘æ±‚å¯¼ç®—æ³•","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.173Z","comments":true,"path":"1970/01/01/ç®—æ³•/åå‘æ±‚å¯¼ç®—æ³•/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E5%8F%8D%E5%90%91%E6%B1%82%E5%AF%BC%E7%AE%97%E6%B3%95/","excerpt":"ä¹‹å‰å°†äº†å‰å‘æ±‚å¯¼å®ç°ï¼Œç°åœ¨å°±æ¥è®²ä¸€ä¸‹åå‘æ±‚å¯¼å®ç°","text":"ä¹‹å‰å°†äº†å‰å‘æ±‚å¯¼å®ç°ï¼Œç°åœ¨å°±æ¥è®²ä¸€ä¸‹åå‘æ±‚å¯¼å®ç° åå‘æ±‚å¯¼çš„æ•°å­¦åŸºç¡€æ˜¯é“¾å¼æ³•åˆ™ å³æ±‚å¯¼çš„è¿‡ç¨‹æ˜¯ä»å‡½æ•°è¾“å‡ºå±‚å¼€å§‹ï¼Œé€å±‚å‘å‰æ±‚å¯¼ï¼Œç›´åˆ°è¾“å…¥å±‚ï¼Œè¿™æ ·å°±å¯ä»¥æ±‚å‡ºæ¯ä¸€å±‚çš„æ¢¯åº¦ å¯¹äºæ ‡é‡æ±‚å¯¼ï¼Œå³å¯ä»¥è‡ªåŠ¨æ±‚å‡ºæ‰€æœ‰å˜é‡çš„æ¢¯åº¦ æ¯”å¦‚å¯¹äºå‡½æ•°ï¼Œåˆ©ç”¨é“¾å¼æ³•åˆ™æ±‚å¯¼ $Y&#x3D;FÂ·G,F&#x3D;a+b,G&#x3D;b+1$$\\frac{\\partial Y}{\\partial a}$$&#x3D;\\frac{\\partial Y}{\\partial F}Â·\\frac{\\partial F}{\\partial a}+\\frac{\\partial Y}{\\partial G}Â·\\frac{\\partial G}{\\partial a}$$&#x3D;G + 0$$&#x3D;b + 1$ å…¶è¯­æ³•æ ‘å¦‚ä¸‹ï¼šæ ¹æ®è¯­æ³•æ ‘æ±‚å¯¼,åŒè·¯å¾„ä¸‹æ¢¯åº¦ç›¸ä¹˜ï¼Œä¸åŒè·¯å¾„æ¢¯åº¦ç›¸åŠ  $\\mathrm{d}a &#x3D; (b+1) \\times 1,\\mathrm{d}b&#x3D;(b+1) \\times 1 + (a+b) \\times 1$ è€Œä¸åŒçš„èŠ‚ç‚¹,æ¯”å¦‚åŠ å‡ä¹˜é™¤ï¼Œå…¶æ¢¯åº¦çš„è®¡ç®—ååˆ†ç®€å• é€šè¿‡æŠŠä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼è½¬æ¢ä¸ºä¸€é¢—åªåŒ…å«åŸºæœ¬è¿ç®—çš„è¯­æ³•äºŒå‰æ ‘ ä»ä¸Šå¾€ä¸‹è¿›è¡Œæ¢¯åº¦è¿­ä»£å³å¯è®¡ç®—å‡ºæ¯ä¸ªå˜é‡çš„æ¢¯åº¦ è¿™ä¸å‰å‘æ±‚å¯¼åªèƒ½è®¡ç®—$\\mathrm{d}Y$ä¸åŒ,åå‘æ±‚å¯¼å¯ä»¥ç®—å‡º$\\frac{\\partial Y}{\\partial a},\\frac{\\partial Y}{\\partial a}$ ç›¸åŠ å³å¯ç®—å‡º $\\mathrm{d}Y$ å› æ­¤åœ¨å·¥ç¨‹åº”ç”¨æ—¶ä¹Ÿæ˜¯åå‘æ±‚å¯¼å±…å¤š ä»¥ä¸Šå°±æ˜¯åå‘æ±‚å¯¼çš„åŸºæœ¬åŸç† ç°åœ¨æˆ‘ä»¬æ¥ç¼–å†™ä»£ç å¦‚ä½•æ ¹æ®å‡½æ•°è¡¨è¾¾å¼æ„é€ è¯­æ³•äºŒå‰æ ‘ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211#include &lt;iostream&gt;#include &lt;math.h&gt;using namespace std;typedef enum &#123; CONST, VAR, ADD, SUB, MUL, DIV, POW,&#125;Operator;class Qtype &#123;public: Operator oper=CONST; float val; float grad = 0; Qtype* left = nullptr; Qtype* right = nullptr; Qtype() &#123; oper = CONST; val = 0; &#125; Qtype(Operator oper) &#123; this-&gt;oper = oper; &#125; Qtype(float a) &#123; val = a; oper = CONST; &#125; Qtype(float a, Operator oper) &#123; val = a; this-&gt;oper = oper; &#125; Qtype(float a, float grad, Operator oper) &#123; val = a; this-&gt;grad = grad; this-&gt;oper = oper; &#125; Qtype&amp; operator+(Qtype&amp; other) &#123; Qtype* res = new Qtype(ADD); res-&gt;left = this; res-&gt;right = &amp;other; return *res; &#125; Qtype&amp; operator-(Qtype&amp; other) &#123; Qtype* res = new Qtype(SUB); res-&gt;left = this; res-&gt;right = &amp;other; return *res; &#125; Qtype&amp; operator*(Qtype&amp; other) &#123; Qtype* res = new Qtype(MUL); res-&gt;left = this; res-&gt;right = &amp;other; return *res; &#125; Qtype&amp; operator/(Qtype&amp; other) &#123; Qtype* res = new Qtype(DIV); res-&gt;left = this; res-&gt;right = &amp;other; return *res; &#125; Qtype&amp; operator=(Qtype&amp; other) &#123; val = other.val; grad = other.grad; oper = other.oper; left = other.left; right = other.right; return *this; &#125; Qtype&amp; operator^(Qtype&amp; other) &#123; Qtype* res = new Qtype(POW); res-&gt;left = this; res-&gt;right = &amp;other; return *res; &#125; Qtype&amp; operator+=(Qtype&amp; other) &#123; Qtype* copy = new Qtype(*this);//å°†è‡ªèº«æ‹·è´ä¸€ä»½ this-&gt;oper = ADD; this-&gt;left = copy; this-&gt;right = &amp;other; return *this; &#125; //åå‘æ±‚å¯¼ void Process(float grad) &#123; switch (oper) &#123; case CONST: grad = 0; break;//ä¸åšä»»ä½•äº‹æƒ… case VAR: this-&gt;grad += grad;//æ¢¯åº¦å¢åŠ  break; case ADD: left-&gt;Process(grad); right-&gt;Process(grad); break; case SUB: left-&gt;Process(grad); right-&gt;Process(-grad); break; case MUL: left-&gt;Process(right-&gt;val * grad); right-&gt;Process(left-&gt;val * grad); break; case DIV: left-&gt;Process(1 / right-&gt;val * grad); right-&gt;Process(-left-&gt;val / (right-&gt;val * right-&gt;val) * grad); break; case POW: left-&gt;Process(right-&gt;val * pow(left-&gt;val, right-&gt;val - 1) * grad); right-&gt;Process(val * log(left-&gt;val) * grad); break; default: break; &#125; &#125; //å‰å‘ä¼ æ’­ void Forward() &#123; switch (oper) &#123; case CONST: break; case VAR: grad = 0; break; case ADD: left-&gt;Forward(); right-&gt;Forward(); val = left-&gt;val + right-&gt;val; break; case SUB: left-&gt;Forward(); right-&gt;Forward(); val = left-&gt;val - right-&gt;val; break; case MUL: left-&gt;Forward(); right-&gt;Forward(); val = left-&gt;val * right-&gt;val; break; case DIV: left-&gt;Forward(); right-&gt;Forward(); val = left-&gt;val / right-&gt;val; break; case POW: left-&gt;Forward(); right-&gt;Forward(); val = pow(left-&gt;val, right-&gt;val); break; default: break; &#125; &#125; void Backward() &#123; Process(1); &#125; //æ‰“å°è¯­æ³•æ ‘ void PrintTree() &#123; switch (oper) &#123; case CONST: cout &lt;&lt; val; break; case VAR: cout &lt;&lt; &quot;x&quot;; break; case ADD: cout &lt;&lt; &quot;(&quot;; left-&gt;PrintTree(); cout &lt;&lt; &quot;+&quot;; right-&gt;PrintTree(); cout &lt;&lt; &quot;)&quot;; break; case SUB: cout &lt;&lt; &quot;(&quot;; left-&gt;PrintTree(); cout &lt;&lt; &quot;-&quot;; right-&gt;PrintTree(); cout &lt;&lt; &quot;)&quot;; break; case MUL: cout &lt;&lt; &quot;(&quot;; left-&gt;PrintTree(); cout &lt;&lt; &quot;*&quot;; right-&gt;PrintTree(); cout &lt;&lt; &quot;)&quot;; break; case DIV: cout &lt;&lt; &quot;(&quot;; left-&gt;PrintTree(); cout &lt;&lt; &quot;/&quot;; right-&gt;PrintTree(); cout &lt;&lt; &quot;)&quot;; break; case POW: cout &lt;&lt; &quot;(&quot;; left-&gt;PrintTree(); cout &lt;&lt; &quot;^&quot;; right-&gt;PrintTree(); cout &lt;&lt; &quot;)&quot;; break; default: break; &#125; &#125;&#125;; ä»£ç çš„å¤æ‚åº¦ä¸å‰å‘æ±‚å¯¼å®é™…ä¸Šå·®ä¸å¤šåŒæ ·æ˜¯é€šè¿‡é‡è½½è¿ç®—ç¬¦æ¥å®ç°è‡ªåŠ¨æ„é€ è¯­æ³•äºŒå‰æ ‘ æµ‹è¯•ä»£ç å¦‚ä¸‹ 12345678910int main() &#123; Qtype a(0, VAR), b(0, VAR),k(1); Qtype Y = (a + b) * (b + k); Y.Forward();//å…ˆå‰å‘ä¼ æ’­ä¸€æ¬¡è®¡ç®—å„ä¸ªèŠ‚ç‚¹çš„å€¼ï¼Œå†åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ Y.Backward(); Y.PrintTree();//æ‰“å°è¯­æ³•æ ‘ cout &lt;&lt; endl; cout &lt;&lt; a.grad &lt;&lt; endl;//æ‰“å°açš„æ¢¯åº¦ cout &lt;&lt; b.grad &lt;&lt; endl;//æ‰“å°bçš„æ¢¯åº¦&#125; è¾“å‡ºå¦‚ä¸‹ 123((x+x)*(x+1))11","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"}]},{"title":"å¡å°”æ›¼æ»¤æ³¢çš„å…¬å¼è¯¦è§£","slug":"ç®—æ³•/å¡å°”æ›¼æ»¤æ³¢","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.173Z","comments":true,"path":"1970/01/01/ç®—æ³•/å¡å°”æ›¼æ»¤æ³¢/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/","excerpt":"å¡å°”æ›¼æ»¤æ³¢çš„å…¬å¼è¯¦è§£","text":"å¡å°”æ›¼æ»¤æ³¢çš„å…¬å¼è¯¦è§£ å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œå¡å°”æ›¼æ»¤æ³¢ä¸€å †çš„æ•°ç†å…¬å¼è®©äººååˆ†å¤´å¤§è¿™é‡Œæˆ‘ä»¬æ¥å¯¹å¡å°”æ›¼å…¬å¼åšå‡ºä¸€ä¸ªå…·ä½“çš„è§£é‡Š é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹åŸºæœ¬å¡å°”æ›¼çš„äº”ä¸ªå…¬å¼ $x_{t|t-1} &#x3D; Ax_{t-1|t-1} + B $$P_{t|t-1} &#x3D; AP_{t-1|t-1}A^T + Q_t $$K_t &#x3D; P_{t|t-1}H^T(HP_{t|t-1}H^T + R_t)^{-1} $$x_{t|t} &#x3D; K_tz_t + (E - K_tH)x_{t|t-1}$$P_{t|t} &#x3D; (E-K_tH)P_{t|t-1}$ æ¥ä¸‹æ¥æˆ‘æ¥ä»”ç»†è®²è§£å„ä¸ªå…¬å¼çš„æ„ä¹‰ å¡å°”æ›¼æ»¤æ³¢ä½ å¯ä»¥ç†è§£ä¸ºå¸¦æœ‰é¢„æµ‹åŠŸèƒ½çš„å¹³æ»‘æ»¤æ³¢å™¨ åœ¨è¿›è¡Œæ»¤æ³¢æ—¶,è€ƒè™‘ä¼°è®¡å€¼ä¸æµ‹é‡å€¼å¾—åˆ°è®¡ç®—å€¼ æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®¡ç®—ä¼°è®¡å€¼ä¸æµ‹é‡å€¼ä¹‹é—´çš„å æ¯”å…³ç³» é¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªå…¬å¼ å¡å°”æ›¼æ»¤æ³¢è¦æ±‚ æˆ‘ä»¬è¦æ ¹æ®æŸä¸€è§„åˆ™å¾—åˆ°å½“å‰æ—¶åˆ»çš„é¢„æµ‹å€¼$\\hat{x}^-$ æ ¹æ®æ™®éè§„å¾‹æˆ‘ä»¬ä¸€èˆ¬æ ¹æ®ä¸Šä¸€æ—¶åˆ»çš„æ•°æ®å»é¢„æµ‹å½“å‰æ—¶åˆ»çš„æ•°æ®$\\hat{x}^- &#x3D; x_{t|t-1}$ åˆ™å½“å‰æ ¹æ®ä¸Šä¸€æ—¶åˆ»çš„é¢„æµ‹å€¼æˆ‘ä»¬å¯ä»¥æè¿°ä¸º$x_{t|t-1} &#x3D; Ax_{t-1|t-1} + B$ å…¶ä¸­$x_{t-1|t-1}$è¡¨ç¤ºä¸Šä¸€æ—¶åˆ»æ»¤æ³¢å¾—åˆ°çš„è®¡ç®—å€¼$B$ä»£è¡¨å½“å‰æ—¶åˆ»çš„å¤–åŠ å› ç´  æ¯”å¦‚æŸä¸€æ±½è½¦ä»¥åŠ é€Ÿåº¦$a$åšåŒ€åŠ é€Ÿè¿åŠ¨,$t-1$æ—¶åˆ»æ±½è½¦çš„é€Ÿåº¦ä¸º$v_{t-1}$ åˆ™æˆ‘ä»¬å¯ä»¥é¢„æµ‹tæ—¶åˆ»æ±½è½¦çš„é€Ÿåº¦ä¸º$v_{t} &#x3D; v_{t-1} + a,A&#x3D;1,B&#x3D;a$ å¯¹äºæœ‰å¤šä¸ªé¢„æµ‹å€¼ï¼Œåˆ™æ˜¯é‡‡ç”¨çŸ©é˜µè¿ç®—çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°å¡å°”æ›¼æ»¤æ³¢ç¬¬ä¸€ä¸ªå…¬å¼$x_{t|t-1} &#x3D; Ax_{t-1|t-1} + B $å…¶ä¸­$A$è¢«ç§°ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè¡¨ç¤ºä»$t-1$æ—¶åˆ»çš„çŠ¶æ€è½¬åˆ°$t$æ—¶åˆ»çš„çŠ¶æ€$B$åˆ™ç§°ä¸ºæ§åˆ¶çŸ©é˜µï¼Œè¡¨ç¤ºtæ—¶åˆ»å¤–ç•Œçš„æ§åˆ¶é‡ ç¬¬äºŒä¸ªå…¬å¼ æˆ‘ä»¬çŸ¥é“ï¼Œé¢„æµ‹å€¼ä¸èƒ½è¡¨ç¤ºçœŸå®å€¼ï¼Œå› ä¸ºçœŸå®è¿‡ç¨‹å½“ä¸­æ€»ä¼šæœ‰ä¸åŒçš„å¹²æ‰°é‡ $t$æ—¶åˆ»çš„çœŸå®å€¼æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼æè¿°$x_t &#x3D; Ax_{t-1} + B + w_t$å…¶ä¸­$x_t$è¡¨ç¤ºtæ—¶åˆ»çš„çœŸå®å€¼,$w_t$è¡¨ç¤ºå¤–éƒ¨å™ªå£°è¿™é‡Œæˆ‘ä»¬å…ˆå‡è®¾å™ªå£°æœä»å‡å€¼ä¸º0çš„æ­£æ€åˆ†å¸ƒ$w_t \\sim N(0,\\sigma^2)$å…¶åæ–¹å·®$cov(w_t)&#x3D;Q_t$ åˆ™æˆ‘ä»¬è¦æè¿°ç†è®ºä¼°è®¡å€¼ä¸çœŸå®å€¼çš„è¯¯å·®æœ‰å¤šå°‘æˆ‘ä»¬ä½¿ç”¨åæ–¹å·®çŸ©é˜µ$P_{t|t-1}$æ¥è¡¨ç¤º$P_{t|t-1} &#x3D; cov(x_t-x_{t|t-1})$æ¨å¯¼å¾—$P_{t|t-1} &#x3D; cov(x_t-x_{t|t-1})$$&#x3D;cov(Ax_{t-1} + B + w_t - (Ax_{t-1|t-1}) + B )$$&#x3D;cov(A(x_{t-1}-x_{t-1|t-1})+w_t)$$&#x3D;Acov(x_{t-1}-x_{t-1|t-1})A^T + cov(w_t)$$&#x3D;AP_{t-1|t-1}A^T + Q_t$ è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†å½“å‰$t$æ—¶åˆ»çš„ç†è®ºä¼°è®¡å€¼è¯¯å·®å¯¹äºä¸Šé¢æ±½è½¦çš„ä¾‹å­ï¼Œå‡å¦‚æ±½è½¦çš„é€Ÿåº¦è¯¯å·®æœä»$w_t \\sim N(0,0.05)$å…¶ä¸­A&#x3D;1åˆ™æ±½è½¦é€Ÿåº¦çš„ä¼°è®¡è¯¯å·®å¯ä»¥è¡¨ç¤ºä¸º$P_{t|t-1}&#x3D;1 \\times P_{t-1|t-1} \\times 1 + 0.05$ å¯¹äºå¤šä¸ªä¼°è®¡è¯¯å·®åˆ™æ˜¯å¡å°”æ›¼ç¬¬äºŒä¸ªå…¬å¼çš„çŸ©é˜µå½¢å¼ ç¬¬ä¸‰ä¸ªå…¬å¼ æ—¢ç„¶æˆ‘ä»¬å¾—åˆ°äº†é¢„æµ‹å€¼ä¸é¢„æµ‹è¯¯å·® é‚£æˆ‘ä»¬å°±è¦æ ¹æ®é¢„æµ‹å€¼ä¸ä¼ æ„Ÿå™¨çš„æµ‹é‡å€¼ç»¼åˆè¯„ä»·ï¼Œå¾—åˆ°æ»¤æ³¢åçš„è®¡ç®—å€¼ é¦–å…ˆä¼ æ„Ÿå™¨çš„æµ‹é‡å€¼è‚¯å®šä¸æ˜¯ç›´æ¥å¯ä»¥åˆ©ç”¨çš„æ•°æ® æ¯”å¦‚æ±½è½¦çš„é€Ÿåº¦ï¼Œä¼ æ„Ÿå™¨å¯èƒ½é€šè¿‡åŠ é€Ÿåº¦çš„ç§¯åˆ†æ¥é—´æ¥å¾—åˆ°é€Ÿåº¦ å› æ­¤æµ‹é‡å€¼å¯ä»¥æè¿°ä¸º $z_t &#x3D; Hx_t + v_t$ å…¶ä¸­$H$ä¸ºå˜æ¢çŸ©é˜µ,ç”¨äºå°†çœŸå®å€¼æ˜ å°„åˆ°æµ‹é‡å€¼å¯¹åº”çš„ç©ºé—´æ¥æ¯”å¦‚$x_t$ä¸ºçœŸå®é€Ÿåº¦,$z_t$ä¸ºæµ‹é‡çš„åŠ é€Ÿåº¦,åˆ™éœ€è¦å°†é€Ÿåº¦æ˜ å°„åˆ°åŠ é€Ÿåº¦å¯¹åº”çš„ç©ºé—´æ¥$v_t$ç”¨æ¥è¡¨ç¤ºæµ‹é‡è¯¯å·®ï¼Œå‡è®¾$v_t$æœä»å‡å€¼ä¸º0çš„æ­£æ€åˆ†å¸ƒ$v_t\\sim N(0,\\sigma^2)$å…¶åæ–¹å·®ä¸º$cov(v_t) &#x3D; R_t$ å‡å¦‚$z_t$æµ‹é‡å€¼è¿‘ä¼¼ç­‰äºçœŸå®å€¼ï¼Œåˆ™$H$å¯ä»¥è®¾ä¸º1(çŸ©é˜µå½¢å¼åˆ™ä¸ºE) ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æµ‹é‡å€¼ä¸çœŸå®å€¼çš„å…³ç³» é‚£ä¹ˆå’Œç¬¬äºŒä¸ªå…¬å¼ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“æµ‹é‡å€¼ä¸ä¸ä¼°è®¡å€¼ä¹‹é—´çš„è¯¯å·®æˆ‘ä»¬ä½¿ç”¨åæ–¹å·®çŸ©é˜µ$S_t$æ¥è¡¨ç¤ºï¼Œåˆ™$S_t &#x3D; cov(z_t - Hx_{t|t-1})$ æ¨å¯¼å¾—$S_t &#x3D; cov(z_t - Hx_{t|t-1})$$&#x3D; cov(Hx_t + v_t - Hx_{t|t-1})$$&#x3D; cov(H(x_t-x_{t|t-1}H^T)) + cov(v_t)$$&#x3D;HP_{t|t-1}H^T + R_t$ æœ‰äº†ä¼°è®¡å€¼çš„ä¼°è®¡è¯¯å·®$P_{t|t-1}$ä¸æµ‹é‡å€¼çš„æµ‹é‡è¯¯å·®$S_t$å¯¹äºä¸Šé¢æ±½è½¦çš„ä¾‹å­ï¼Œå‡å¦‚æµ‹é‡è¯¯å·®$v_t \\sim N(0,0.05)$,åˆ™$R_t&#x3D;0.05$ æˆ‘ä»¬å°±å¯ä»¥æè¿°ä¼°è®¡å€¼ä¸æµ‹é‡å€¼ä¹‹é—´çš„å…³ç³»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å¯¹ä¼°è®¡å€¼ä¸æµ‹é‡å€¼è¿›è¡Œèåˆ æˆ‘ä»¬è‚¯å®šæ˜¯å¸Œæœ›è¯¯å·®è¶Šå°çš„ä¸€è¾¹å æ¯”è¶Šå¤§ï¼Œè¯¯å·®è¶Šå¤§çš„ä¸€è¾¹å æ¯”è¶Šå° é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰$K_t &#x3D; P_{t|t-1}H^TS^{-1}_t$ æ¥æè¿°ä¼°è®¡å€¼ä¸æµ‹é‡å€¼ä¹‹é—´çš„å æ¯”å…³ç³»ï¼Œè¿™é‡Œ$K_t$è¢«ç§°ä¸ºå¡å°”æ›¼å¢ç›ŠåŒ–ç®€å¾—$K_t &#x3D; P_{t|t-1}H^T(HP_{t|t-1}H^T + R_t)^{-1}$ å³å¡å°”æ›¼ç¬¬ä¸‰ä¸ªå…¬å¼ ç¬¬å››ä¸ªå…¬å¼ æˆ‘ä»¬ç°åœ¨çŸ¥é“äº†ä¼°è®¡å€¼ä¸æµ‹é‡å€¼ä¹‹é—´çš„å æ¯”å…³ç³» é‚£ä¹ˆæˆ‘ä»¬å°±èƒ½æ ¹æ®è¿™ä¸ªå…³ç³»è¿›è¡Œèåˆå¾—åˆ°æ»¤æ³¢åçš„è®¡ç®—å€¼,åˆ™ $x_{t|t} &#x3D; K_tz_t + (E-K_tH)x_{t|t-1}$å…¶ä¸­$E$æ˜¯å•ä½çŸ©é˜µï¼Œå½“ä¼°è®¡å€¼ä¸æµ‹é‡å€¼åªæœ‰ä¸€ä¸ªæ—¶ï¼Œç”¨1è¡¨ç¤º$K_t$å³è¡¨ç¤ºæµ‹é‡å€¼çš„å æ¯”ï¼Œç›¸å¯¹çš„$1-K_tH$è¡¨ç¤ºä¼°è®¡å€¼çš„å æ¯” å³å¡å°”æ›¼ç¬¬å››ä¸ªå…¬å¼ ç¬¬äº”ä¸ªå…¬å¼ å¾—åˆ°æ»¤æ³¢åçš„è®¡ç®—å€¼åï¼Œæˆ‘ä»¬è¿˜è¦ç»§ç»­æ›´æ–°ä¼°è®¡å€¼çš„è¯¯å·®æˆ‘ä»¬çŸ¥é“ä¼°è®¡å€¼å æ¯”$1-K_tH$é‚£ä¹ˆæ–°çš„ä¼°è®¡å€¼è¯¯å·®ä¹Ÿåº”æ›´æ–°ï¼Œå³ $P_{t|t} &#x3D; (1-K_TH)P_{t|t-1}$ è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ä¸€æ¬¡å¡å°”æ›¼æ»¤æ³¢å¾ªç¯ å¯¹äºå•ä¼ æ„Ÿå™¨æ»¤æ³¢ï¼Œä¸Šå¼å¯è½¬æ¢ä¸ºä»£æ•°å¼ pythonæµ‹è¯•ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829import mathimport numpy as npimport matplotlib.pyplot as plt#å¡å°”æ›¼æ»¤æ³¢#å‡è®¾æŸä¸€æ¸©åº¦ä¼ æ„Ÿå™¨çš„æ³¢å½¢æœä»å¯¹æ•°åˆ†å¸ƒX= np.linspace(0,100,100)wave_orig = np.log(X+1)wave = wave_orig + np.random.normal(0,0.05,100)#æ·»åŠ å™ªç‚¹#æ»¤æ³¢åçš„æ³¢å½¢wave_filtered = np.zeros(100)wave_filtered[0] = wave[0]P_11 = 0.5#åˆå§‹é¢„æµ‹è¯¯å·®for i in range(1,100): #ç†è®ºé¢„æµ‹ x_21 = wave_filtered[i-1] + math.log(i+1) - math.log(i) #ç†è®ºä¼°è®¡è¯¯å·® P_21 = P_11 + 0.05 #å®é™…æµ‹é‡å€¼ z_2 = wave[i] #ç†è®ºä¼°è®¡å€¼ä¸æµ‹é‡å€¼çš„è¯¯å·® S_2 = P_21 + 0.05 #è®¡ç®—å¡å°”æ›¼å¢ç›Š K_2 = P_21 / S_2 wave_filtered[i] = K_2 * z_2 + (1-K_2) * x_21 P_11 = (1-K_2) * P_21","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"}]},{"title":"å¿«é€Ÿå‚…é‡Œå¶å˜æ¢","slug":"ç®—æ³•/å¿«é€Ÿå‚…é‡Œå¶å˜æ¢","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.173Z","comments":true,"path":"1970/01/01/ç®—æ³•/å¿«é€Ÿå‚…é‡Œå¶å˜æ¢/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/","excerpt":"å¿«é€Ÿå‚…é‡Œå¶å˜æ¢åŠé€†å˜æ¢","text":"å¿«é€Ÿå‚…é‡Œå¶å˜æ¢åŠé€†å˜æ¢ å¿«é€Ÿå‚…é‡Œå¶å˜æ¢æ˜¯åœ¨ç¦»æ•£å‚…é‡Œå¶çš„åŸºç¡€ä¸Šçš„ä¼˜åŒ–å‹ æœ¬è´¨æ˜¯ä¸€æ ·çš„ é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ç¦»æ•£å‚…é‡Œå¶å˜æ¢çš„å…¬å¼ï¼š$D(k) &#x3D; \\sum_{n&#x3D;0}^{N-1}E(n)(\\cos\\frac{2\\pi kn}{N} - j\\sin\\frac{2\\pi kn}{N})$ æ–¹ä¾¿æœŸé—´æˆ‘ä»¬è®¾$W^{n}_{N} &#x3D; \\cos\\frac{2\\pi n}{N} + j\\sin\\frac{2\\pi n}{N}&#x3D;e^{j\\frac{2\\pi n}{N}}$å³æ¬§æ‹‰å…¬å¼çš„å˜ä½“ $W^{n}{N}$æœ‰å¦‚ä¸‹ç‰¹æ€§$W^{a}{N} * W^{b}{N} &#x3D; W^{a+b}{N}$$W^{a + \\frac{N}{2}}{N} &#x3D; \\cos{(\\frac{2\\pi n}{N} + \\pi)} + j\\sin{(\\frac{2\\pi n}{N} + \\pi)} &#x3D; -W^{a}{N}$$W^{a + N}{N} &#x3D; \\cos{(\\frac{2\\pi n}{N} + 2\\pi)} + j\\sin{(\\frac{2\\pi n}{N} + 2\\pi)} &#x3D; W^{a}{N}$è¯¥ç‰¹æ€§ä¹Ÿæ˜¯å¿«é€Ÿå‚…é‡Œå¶çš„å…³é”® åˆ™$D(k) &#x3D; \\sum_{n&#x3D;0}^{N-1}E(n)W^{-kn}{N}$$D(k) &#x3D; E(0)W^{0}{N} + E(1)W^{-k}{N} + E(2)W^{-2k}{N} + E(3)W^{-3k}{N} + â€¦ + E(N-1)W^{-(N-1)k}{N}$ å¯ä»¥å¾—åˆ°ï¼š(Nå¿…é¡»ä¸º2çš„æ¬¡æ–¹,åˆ™næœ€å¤§ä¸ºN-1)$D(k) &#x3D; (E(0) + E(2)W^{-2k}{N} + â€¦ + E(N-2)W^{-(N-2)k}{N}) + (E(1)W^{-1k}{N} + E(3)W^{-3k}{N} + â€¦ + E(N-1)W^{-(N-1)k}{N})$$D(k) &#x3D; (E(0) + E(2)W^{-2k}{N} + â€¦ + E(N-2)W^{-(N-2)k}{N}) + W^{-1k}{N}(E(1) + E(3)W^{-2k}{N} + â€¦ + E(N-1)W^{-(N-2)k}{N})$ è®¾$D1(k) &#x3D; E(0) + E(2)W^{-2k}{N} + â€¦ + E(N-2)W^{-(N-2)k}{N}$$D2(k) &#x3D; E(1) + E(3)W^{-2k}{N} + â€¦ + E(N-1)W^{-(N-2)k}{N}$ åˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ°D(k)çš„é€’æ¨å¼$D(k) &#x3D; D1(k) + W^{-1k}{N}D2(k)$$D(k+\\frac{N}{2}) &#x3D; D1(k) - W^{-1k}{N}D2(k)$$0&lt;&#x3D;k&lt;&#x3D;\\frac{N}{2}-1$ å½“N&#x3D;1æ—¶$D(k) &#x3D; E(0)$ ç”±å…¶é€’å½’å¼æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºå¿«é€Ÿå‚…é‡Œå¶é€’å½’ä»£ç  12345678910def FFT(x): N = len(x) if N &lt;= 1: return x even = FFT(x[0::2])#å–å‡ºå¶æ•°é¡¹ odd = FFT(x[1::2])#å–å‡ºå¥‡æ•°é¡¹ #è®¡ç®—W*D2 T = [np.exp(-2j * math.pi * k / N) * odd[k] for k in range(N//2)] #åˆå¹¶å‰é¢ä¸€åŠå’Œåé¢ä¸€åŠ return [even[k] + T[k] for k in range(N//2)] + [even[k] - T[k] for k in range(N//2)] ç”±ç¦»æ•£å‚…é‡Œå¶é€†å˜æ¢å…¬å¼$ID(k) &#x3D; \\frac{1}{N}\\sum_{n&#x3D;0}^{N-1}D(n)(cos\\frac{2\\pi kn}{N} + jsin\\frac{2\\pi kn}{N})$ åŒç†å¯å¾—å¿«é€Ÿå‚…é‡Œå¶çš„é€†å˜æ¢æ¨å¯¼è¿‡ç¨‹ä¸ä¸Šé¢ç›¸ä¼¼ä¸æ­£å˜æ¢çš„å”¯ä¸€åŒºåˆ«åœ¨äº$W^{-nk}_{N}$ä¸­è´Ÿå·å»æ‰äº† 123456789101112def IFFT(x, n=0): N = len(x) if N &lt;= 1: return x even = IFFT(x[0::2], n+1) odd = IFFT(x[1::2], n+1) #è¿™é‡Œä¸å‚…é‡Œå¶å˜æ¢çš„å”¯ä¸€åŒºåˆ«å°±åœ¨äºç¬¦å·å˜äº† T = [np.exp(2j * math.pi * k / N) * odd[k] for k in range(N//2)] if n == 0: return [(even[k] + T[k])/N for k in range(N//2)] + [(even[k] - T[k])/N for k in range(N//2)] return [(even[k] + T[k]) for k in range(N//2)] + [even[k] - T[k] for k in range(N//2)]","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"}]},{"title":"ç®€å•çš„æ»¤æ³¢ç®—æ³•","slug":"ç®—æ³•/æ»¤æ³¢","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.174Z","comments":true,"path":"1970/01/01/ç®—æ³•/æ»¤æ³¢/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E6%BB%A4%E6%B3%A2/","excerpt":"ç®€å•çš„æ»¤æ³¢ç®—æ³•","text":"ç®€å•çš„æ»¤æ³¢ç®—æ³• å·ç§¯ä¸€ç»´æ»¤æ³¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091import numpy as npimport mathimport matplotlib.pyplot as plt################################ä¸€ç»´æ»¤æ³¢###############################start_X = -np.piend_x = np.pislice_num = 200 #åˆ‡åˆ†X = np.linspace(start_X,end_x,slice_num,endpoint=True) #Xè½´å‘wave1 = 10*np.sin(X) + 5*np.append(np.random.rand(len(X)-100),np.zeros(100))#ä½¿ç”¨å¤æ•°ä»£è¡¨æ³¢å½¢ï¼Œå®éƒ¨ä»£è¡¨æ—¶é—´è½´ï¼Œè™šéƒ¨ä»£è¡¨å¹…åº¦wave1 = X + wave1 * 1jwave1_real=np.real(wave1)wave1_imag=np.imag(wave1)#å°†æ³¢å½¢æ—‹è½¬90åº¦#wave1 = wave1 * 1jplt.title(&#x27;original data&#x27;)plt.plot(np.real(wave1), np.imag(wave1))plt.show()# å·ç§¯æ»¤æ³¢ ä½¿ç”¨å¤æ•°wave2 = []filter1 = [0.2,0.3,0.5]for i in range(len(wave1) - len(filter1) + 1): point = 0 for j in range(len(filter1)): point += wave1[i+j] * filter1[j] wave2.append(point)wave2 = np.array(wave2)fig=plt.figure()plt.title(&#x27;Convolution filtering consider the time axis&#x27;)plt.plot(np.real(wave2), np.imag(wave2))plt.show()# å·ç§¯æ»¤æ³¢ ä¸ä½¿ç”¨å¤æ•°wave2 = []for i in range(len(wave1_imag) - len(filter1) + 1): point = 0 for j in range(len(filter1)): point += wave1_imag[i+j] * filter1[j] wave2.append(point)for j in range(len(filter1) - 1): wave2.append(0)wave2 = np.array(wave2)fig=plt.figure()plt.title(&#x27;Convolution filtering does not consider the time axis&#x27;)plt.plot(np.real(wave1),wave2)plt.show()# æ™®é€šå¹³æ»‘æ»¤æ³¢ #è€æ•°æ®åŠ æƒå’Œwave2 = []#æ³¨æ„æ­¤å¤„çš„æ»¤æ³¢å™¨æ˜¯è€æ•°æ®çš„å„ä¸ªåŠ æƒå’Œfilter2 = [0.4,0.4,0.5]last = [0,0]#ä¿å­˜è€æ•°æ®for i in range(len(wave1_imag)): k=0 for j in range(len(filter2)-1):#å…ˆåŠ æƒè€æ•°æ® k += last[j] * filter2[j] #å†åŠ æƒæ–°æ•°æ® k += wave1_imag[i] * filter2[-1] #åˆ é™¤æœ€è€çš„ä¸€ä¸ªæ•°æ® del last[0] #æ·»åŠ æ–°æ•°æ® last.append(k) wave2.append(last[-1])wave2 = np.array(wave2)fig=plt.figure()plt.title(&#x27;Ordinary smoothing filter&#x27;)plt.plot(X,wave2)plt.show() æ»¤æ³¢æ•ˆæœ: å¤šç»´æ»¤æ³¢ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import numpy as npimport mathimport matplotlib.pyplot as pltimport cv2################################ äºŒç»´æ»¤æ³¢###############################start_X = -np.piend_x = np.pislice_num = 200 # åˆ‡åˆ†X = np.linspace(start_X, end_x, slice_num, endpoint=True) # Xè½´å‘wave1 = 10*np.sin(X) + np.append(np.random.rand(len(X)-100), np.zeros(100))wave1 = X + wave1 * 1jwave1_real = np.real(wave1)wave1_imag = np.imag(wave1)wave2 = 10*np.sin(X) + np.append(np.random.rand(len(X)-100), np.zeros(100))wave2 = X + wave2 * 1jwave2_real = np.real(wave1)wave2_imag = np.imag(wave1)plt.title(&#x27;original data1&#x27;)plt.plot(np.real(wave1), np.imag(wave1))fig = plt.figure()plt.title(&#x27;original data2&#x27;)plt.plot(np.real(wave2), np.imag(wave2))plt.show()# äºŒç»´å·ç§¯æ»¤æ³¢,å¸¸ç”¨äº2ä¸ªæˆ–å¤šä¸ªä¼ æ„Ÿå™¨æ»¤æ³¢å‡å°‘è¯¯å·®wave = [wave1, wave2]wave3 = []filter1 = [[0.5,0.5], [0.5,0.5]]for i in range(len(wave1) - len(filter1) + 1): point = 0 for j in range(len(filter1)): # 2è¡Œ for k in range(len(filter1[0])): # 2åˆ— point += filter1[j][k] * wave[j][i+k] wave3.append(point)wave3 = np.array(wave3)fig = plt.figure()plt.title(&#x27;filter data&#x27;)plt.plot(np.real(wave3), np.imag(wave3))plt.show()# äºŒç»´å›¾åƒæ»¤æ³¢ï¼Œè¿™é‡Œæ˜¯ç›´æ¥è°ƒopencvåº“fig = plt.figure()plt.title(&#x27;original image&#x27;)img = plt.imread(&quot;0.jpg&quot;)plt.imshow(img)# å·ç§¯æ ¸kernel = np.array([ [1, -2, 1], [1, -2, 1], [1, -2, 1]])res = cv2.filter2D(img, -1, kernel)fig = plt.figure()plt.title(&#x27;filter image&#x27;)plt.imshow(res) æ»¤æ³¢æ•ˆæœ: å‚…é‡Œå¶æ»¤æ³¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import numpy as npimport mathimport matplotlib.pyplot as plt################################ç¦»æ•£å‚…é‡Œå¶å˜æ¢ æ—¶åŸŸè½¬é¢‘åŸŸ###############################start_X = -2*np.piend_x = 2*np.pislice_num = 200 #åˆ‡åˆ†X = np.linspace(start_X,end_x,slice_num,endpoint=True) #Xè½´å‘#åœ¨åŸå§‹æ³¢å½¢çš„åŸºç¡€ä¸Šæ·»åŠ å™ªç‚¹wave1 = 10*np.sin(X) + 5*np.append(np.random.rand(len(X)-100),np.zeros(100))wave1 = X + wave1 * 1jwave1_real=np.real(wave1)wave1_imag=np.imag(wave1)# wave1 = wave1plt.title(&#x27;original data&#x27;)plt.plot(np.real(wave1), np.imag(wave1))plt.show()pi = 3.1415926def DFT(origin): # è®¡ç®—ç»™å®šåºåˆ—çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœ N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) - math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp) return outputdef IDFT(origin): #é€†å˜æ¢ N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) + math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp / N) return output#dftè¾“å‡º , å¯¹æ³¢å½¢1åšå‚…é‡Œå¶å˜æ¢dft_wave = DFT(wave1_imag)#idftè¾“å‡º é€†å˜æ¢idft_wave = IDFT(dft_wave)fig = plt.figure()plt.title(&#x27;DFT abs data&#x27;)plt.plot(np.real(wave1), np.abs(dft_wave))plt.show()fig = plt.figure()plt.title(&#x27;IDFT data&#x27;)plt.plot(np.real(wave1), np.real(idft_wave))plt.show()#å‚…é‡Œå¶æ»¤æ³¢dft_new_wave = dft_wave.copy()#è¿‡æ»¤æ‚æ³¢ï¼Œå°†é¢‘è°±å›¾ä¸Šçš„æ‚æ³¢è¿‡æ»¤for i in range(len(dft_new_wave)): if(dft_new_wave[i].__abs__() &lt;= 200): dft_new_wave[i]=0#é€†å˜æ¢å¾—åˆ°æ— æ‚æ³¢çš„æ³¢å½¢idft_wave = IDFT(dft_new_wave)fig = plt.figure()plt.title(&#x27;DFT filter data&#x27;)plt.plot(np.real(wave1), np.real(idft_wave))plt.show() å‚…é‡Œå¶æ»¤æ³¢æ•ˆæœ:","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"}]},{"title":"ç¦»æ•£å‚…é‡Œå¶å˜æ¢","slug":"ç®—æ³•/ç¦»æ•£å‚…é‡Œå¶å˜æ¢","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.174Z","comments":true,"path":"1970/01/01/ç®—æ³•/ç¦»æ•£å‚…é‡Œå¶å˜æ¢/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E7%A6%BB%E6%95%A3%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/","excerpt":"ç¦»æ•£å‚…é‡Œå¶å˜æ¢åŠé€†å˜æ¢","text":"ç¦»æ•£å‚…é‡Œå¶å˜æ¢åŠé€†å˜æ¢ è¿™é‡Œç›´æ¥ä¸Šç¦»æ•£å‚…é‡Œå¶å˜æ¢çš„æ•°å­¦å…¬å¼: ç”¨D(x)ä»£è¡¨å‚…é‡Œå¶å˜æ¢è¾“å‡ºï¼ŒE(x)ä»£è¡¨åŸå§‹æ³¢å½¢æ•°æ®ç”¨ID(x)ä»£è¡¨å‚…é‡Œå¶é€†å˜æ¢è¾“å‡º(x&#x3D;0,1,2,3â€¦)ç”¨Nä»£è¡¨æ•°æ®é‡ï¼Œä¹Ÿå°±æ˜¯é‡‡æ ·ç‚¹æ•°é‡ $D(k) &#x3D; \\sum_{n&#x3D;0}^{N-1}E(n)(cos\\frac{2\\pi kn}{N} - jsin\\frac{2\\pi kn}{N})$$ID(k) &#x3D; \\frac{1}{N}\\sum_{n&#x3D;0}^{N-1}D(n)(cos\\frac{2\\pi kn}{N} + jsin\\frac{2\\pi kn}{N})$ å…¶ä¸­çš„â€jâ€ä»£è¡¨è™šæ•°å•ä½ pythonä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728import mathpi = 3.1415926def DFT(origin): # è®¡ç®—ç»™å®šåºåˆ—çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœ N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) - math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp) return outputdef IDFT(origin): N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) + math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp / N) return output æ ·ä¾‹ï¼šæ»¤æ³¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364import numpy as npimport mathimport matplotlib.pyplot as pltstart_X = -2*np.piend_x = 2*np.pislice_num = 200 #åˆ‡åˆ†X = np.linspace(start_X,end_x,slice_num,endpoint=True) #Xè½´å‘wave1 = 10*np.sin(X) + 5*np.append(np.random.rand(len(X)-100),np.zeros(100))wave1 = X + wave1 * 1jwave1_real=np.real(wave1)wave1_imag=np.imag(wave1)plt.title(&#x27;original data&#x27;)plt.plot(np.real(wave1), np.imag(wave1))plt.show()pi = 3.1415926def DFT(origin): # è®¡ç®—ç»™å®šåºåˆ—çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœ N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) - math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp) return outputdef IDFT(origin): N= len(origin) output = [] for i in range(N): temp = 0 for j in range(N): temp += origin[j] * ( (math.cos(2 * math.pi * i * j / N) + math.sin(2 * math.pi * i * j / N) * 1j) ) output.append(temp / N) return output#dftè¾“å‡º , å¯¹æ³¢å½¢1åšå‚…é‡Œå¶å˜æ¢dft_wave = DFT(wave1_imag)#idftè¾“å‡º é€†å˜æ¢idft_wave = IDFT(dft_wave)#å‚…é‡Œå¶æ»¤æ³¢dft_new_wave = dft_wave.copy()#è¿‡æ»¤æ‚æ³¢for i in range(len(dft_new_wave)): if(dft_new_wave[i].__abs__() &lt;= 200): dft_new_wave[i]=0idft_wave = IDFT(dft_new_wave)fig = plt.figure()plt.title(&#x27;DFT filter data&#x27;)plt.plot(np.real(wave1), np.real(idft_wave))plt.show() ç»“æœ:","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"}]},{"title":"ä¸€ä¸ªè®¡ç®—å™¨çš„è¯­æ³•åˆ†æå™¨","slug":"ç®—æ³•/è®¡ç®—å™¨è¯­æ³•åˆ†æ","date":"1970-01-01T00:00:00.000Z","updated":"2023-04-28T16:56:51.175Z","comments":true,"path":"1970/01/01/ç®—æ³•/è®¡ç®—å™¨è¯­æ³•åˆ†æ/","link":"","permalink":"https://tastynoob.github.io/1970/01/01/%E7%AE%97%E6%B3%95/%E8%AE%A1%E7%AE%97%E5%99%A8%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/","excerpt":"ä¹‹å‰åšäº†ä¸ªè®¡ç®—å™¨é¡¹ç›®ï¼Œç”¨åˆ°äº†è¯­æ³•åˆ†æï¼Œæˆ‘ä¹Ÿæ˜¯å¯¹è¯­æ³•åˆ†ææ–¹é¢å¾ˆæ„Ÿå…´è¶£ï¼Œå°±æ¥å†™ä¸€ç¯‡åšå®¢","text":"ä¹‹å‰åšäº†ä¸ªè®¡ç®—å™¨é¡¹ç›®ï¼Œç”¨åˆ°äº†è¯­æ³•åˆ†æï¼Œæˆ‘ä¹Ÿæ˜¯å¯¹è¯­æ³•åˆ†ææ–¹é¢å¾ˆæ„Ÿå…´è¶£ï¼Œå°±æ¥å†™ä¸€ç¯‡åšå®¢ å…ˆæŠŠæ‰€æœ‰ä»£ç ç²˜è´´ä¸Šè¿™ä¸ªè®¡ç®—å™¨çš„è¯­æ³•åˆ†æé‡‡ç”¨æŠ½è±¡è¯­æ³•åˆ†æï¼Œå…¶è¯­æ³•è¡¨è¾¾å¼ä¸º: 12345678expr : term + term | term - term | termterm : pri * pri | pri / pri | pripri : num | &#x27;(&#x27; expr &#x27;)&#x27; ä»£ç æŒºç®€å•çš„ï¼Œæ‹“å±•æ€§ä¹ŸæŒºå¼º,å¯ç›´æ¥å¤åˆ¶ç²˜è´´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168#include &lt;math.h&gt;#include &lt;string.h&gt;typedef struct &#123; char tag; float val;&#125; Token;typedef struct &#123; char* str; int p; Token buffer; char null;&#125; Parser;//ç”¨æ¥ç¼“å­˜æ•°æ® //åˆ›å»ºä¸€ä¸ªtokenToken CreateToken(char ch);Token CreateToken_(char ch,float v);Parser parser = &#123; 0,0,&#123;0&#125;,1 &#125;;int error_flag =0;float Term();Token Get();float Expression();float Primary();void Error()&#123;//é”™è¯¯å¤„ç†å‡½æ•°ï¼Œè¿™é‡Œå¯ä»¥éšä¾¿æ”¹ error_flag = 1;&#125;//åˆ›å»ºä¸€ä¸ªtokenToken CreateToken(char ch)&#123; Token t = &#123;ch,0&#125;; return t;&#125;Token CreateToken_(char ch,float v)&#123; Token t = &#123;ch,v&#125;; return t;&#125;void Push(Token* t)&#123; if(!parser.null)&#123; Error(); &#125; parser.buffer = *t; parser.null=0;&#125;Token Get()&#123; if(!parser.null)&#123; parser.null=1; return parser.buffer; &#125; char ch = parser.str[parser.p++]; float val; switch (ch) &#123; case &#x27;=&#x27;: return CreateToken(ch); case &#x27;+&#x27;:case &#x27;-&#x27;:case &#x27;*&#x27;:case &#x27;/&#x27;:case &#x27;(&#x27;:case &#x27;)&#x27;: return CreateToken(ch); case &#x27;0&#x27;:case &#x27;1&#x27;:case &#x27;2&#x27;:case &#x27;3&#x27;:case &#x27;4&#x27;: case &#x27;5&#x27;:case &#x27;6&#x27;:case &#x27;7&#x27;:case &#x27;8&#x27;:case &#x27;9&#x27;: parser.p--; sscanf(&amp;parser.str[parser.p],&quot;%f&quot;,&amp;val); while((parser.str[parser.p]&lt;=&#x27;9&#x27; &amp;&amp; parser.str[parser.p]&gt;=&#x27;0&#x27;) || parser.str[parser.p]==&#x27;.&#x27;)parser.p++; return CreateToken_(&#x27;0&#x27;,val); case &#x27;s&#x27;:case &#x27;c&#x27;:case &#x27;t&#x27;: return CreateToken(ch); default: return CreateToken(ch); &#125;&#125;float Expression()&#123;//exprè¡¨è¾¾å¼ float val = Term(); Token t = Get(); while (t.tag == &#x27;+&#x27; || t.tag == &#x27;-&#x27;) &#123; if (t.tag == &#x27;+&#x27;) &#123; val += Term(); t = Get(); &#125; if (t.tag == &#x27;-&#x27;) &#123; val -= Term(); t = Get(); &#125; &#125; Push(&amp;t); return val;&#125;float Term()&#123;//termè¡¨è¾¾å¼ float val = Primary(); while (1) &#123; Token token = Get(); switch (token.tag) &#123; case &#x27;*&#x27;: val *= Primary(); break; case &#x27;/&#x27;: val /= Primary(); break; default: Push(&amp;token); return val; &#125; &#125;&#125;float Primary() &#123;//priè¡¨è¾¾å¼ float val=0; Token token = Get(); switch (token.tag) &#123; case &#x27;0&#x27;: val = token.val; break; case &#x27;(&#x27;: val = Expression(); token = Get(); if (token.tag != &#x27;)&#x27;) &#123; Error(); &#125; break; default: Error(); &#125; return val;&#125;float ParseGet(char* str)&#123; parser.str = str; float val=0; while (1) &#123; Token token = Get(); if (token.tag == &#x27;=&#x27;) &#123; parser.null=1; parser.p=0; parser.str=0; return val; &#125; else &#123; Push(&amp;token); val = Expression(); &#125; if (error_flag)&#123; error_flag = 0; parser.null=1; parser.p=0; parser.str=0; return FLT_MAX; &#125; &#125;&#125;","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"è¯­æ³•åˆ†æ","slug":"è¯­æ³•åˆ†æ","permalink":"https://tastynoob.github.io/tags/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/"},{"name":"lex&yacc","slug":"lex-yacc","permalink":"https://tastynoob.github.io/tags/lex-yacc/"}]}],"categories":[{"name":"fpga","slug":"fpga","permalink":"https://tastynoob.github.io/categories/fpga/"},{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"https://tastynoob.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://tastynoob.github.io/categories/%E7%AE%97%E6%B3%95/"},{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://tastynoob.github.io/categories/%E5%85%B6%E5%AE%83/"},{"name":"linux","slug":"linux","permalink":"https://tastynoob.github.io/categories/linux/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://tastynoob.github.io/categories/%E6%A1%86%E6%9E%B6/"}],"tags":[{"name":"riscv","slug":"riscv","permalink":"https://tastynoob.github.io/tags/riscv/"},{"name":"ç¥ç»ç½‘ç»œ","slug":"ç¥ç»ç½‘ç»œ","permalink":"https://tastynoob.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"},{"name":"arm","slug":"arm","permalink":"https://tastynoob.github.io/tags/arm/"},{"name":"k210","slug":"k210","permalink":"https://tastynoob.github.io/tags/k210/"},{"name":"linux","slug":"linux","permalink":"https://tastynoob.github.io/tags/linux/"},{"name":"ç³»ç»Ÿ","slug":"ç³»ç»Ÿ","permalink":"https://tastynoob.github.io/tags/%E7%B3%BB%E7%BB%9F/"},{"name":"vscode","slug":"vscode","permalink":"https://tastynoob.github.io/tags/vscode/"},{"name":"test","slug":"test","permalink":"https://tastynoob.github.io/tags/test/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://tastynoob.github.io/tags/%E6%8A%80%E6%9C%AF/"},{"name":"nodejs","slug":"nodejs","permalink":"https://tastynoob.github.io/tags/nodejs/"},{"name":"LVGL","slug":"LVGL","permalink":"https://tastynoob.github.io/tags/LVGL/"},{"name":"verilog","slug":"verilog","permalink":"https://tastynoob.github.io/tags/verilog/"},{"name":"chisel","slug":"chisel","permalink":"https://tastynoob.github.io/tags/chisel/"},{"name":"ä¿¡å·å¤„ç†","slug":"ä¿¡å·å¤„ç†","permalink":"https://tastynoob.github.io/tags/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/"},{"name":"å£°å­¦","slug":"å£°å­¦","permalink":"https://tastynoob.github.io/tags/%E5%A3%B0%E5%AD%A6/"},{"name":"å›¾å½¢å­¦","slug":"å›¾å½¢å­¦","permalink":"https://tastynoob.github.io/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"},{"name":"è¯­æ³•åˆ†æ","slug":"è¯­æ³•åˆ†æ","permalink":"https://tastynoob.github.io/tags/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/"},{"name":"lex&yacc","slug":"lex-yacc","permalink":"https://tastynoob.github.io/tags/lex-yacc/"}]}